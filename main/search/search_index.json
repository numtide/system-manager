{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"faq/","title":"FAQ","text":""},{"location":"faq/#general-tips-and-best-practices","title":"General Tips and Best Practices","text":""},{"location":"faq/#1-always-test-in-a-vm-first","title":"1. Always Test in a VM First","text":"<p>Before applying changes to your production system, test in a safe environment:</p> <pre><code># Build the configuration first to check for errors\nnix build .#systemConfigs.default\n\n# For actual VM testing, use a tool like NixOS's VM builder\n# or test in a container/virtualized environment\n</code></pre>"},{"location":"faq/#2-use-flake-inputs-follows","title":"2. Use Flake Inputs Follows","text":"<p>This ensures consistent nixpkgs versions:</p> <pre><code>inputs = {\n  nixpkgs.url = \"github:NixOS/nixpkgs/nixos-unstable\";\n  system-manager = {\n    url = \"github:numtide/system-manager\";\n    inputs.nixpkgs.follows = \"nixpkgs\";  # Use the same nixpkgs\n  };\n};\n</code></pre> <p>By default, each flake input pins its own version of its dependencies, which means you could end up with multiple versions of <code>nixpkgs</code>. The <code>follows</code> directive tells Nix to use your <code>nixpkgs</code> instead of the one bundled with System Manager, ensuring consistent package versions across your entire configuration while reducing disk usage and evaluation time.</p>"},{"location":"faq/#3-modular-configuration","title":"3. Modular Configuration","text":"<p>Split your configuration into multiple files:</p> <pre><code>.\n\u251c\u2500\u2500 flake.nix\n\u2514\u2500\u2500 modules\n    \u251c\u2500\u2500 default.nix\n    \u251c\u2500\u2500 services.nix\n    \u251c\u2500\u2500 packages.nix\n    \u2514\u2500\u2500 users.nix\n</code></pre>"},{"location":"faq/#4-check-logs","title":"4. Check Logs","text":"<p>Always check systemd logs after activation:</p> <pre><code>sudo journalctl -u system-manager.target\nsudo journalctl -xe\n</code></pre>"},{"location":"faq/#5-garbage-collection","title":"5. Garbage Collection","text":"<p>Regularly clean up old generations:</p> <pre><code># Remove old system-manager profiles\nsudo nix-env --profile /nix/var/nix/profiles/system-manager-profiles --delete-generations old\n\n# Run garbage collection\nsudo nix-collect-garbage -d\n</code></pre>"},{"location":"faq/#6-rollback","title":"6. Rollback","text":"<p>If something goes wrong, you can rollback:</p> <pre><code># List generations\nsudo nix-env --profile /nix/var/nix/profiles/system-manager-profiles --list-generations\n\n# Rollback to previous generation\nsudo nix-env --profile /nix/var/nix/profiles/system-manager-profiles --rollback\n\n# Activate the previous generation\nnix run 'github:numtide/system-manager' -- activate --sudo\n</code></pre>"},{"location":"faq/#troubleshooting","title":"Troubleshooting","text":""},{"location":"faq/#service-wont-start","title":"Service Won't Start","text":"<pre><code># Check service status\nsudo systemctl status &lt;service-name&gt;\n\n# View detailed logs\nsudo journalctl -u &lt;service-name&gt; -n 50\n\n# Check if service file exists\nls -la /etc/systemd/system/&lt;service-name&gt;.service\n</code></pre>"},{"location":"faq/#package-not-found-in-path","title":"Package Not Found in PATH","text":"<p>If you just installed System Manager, and installed a package through it, try logging out and logging back in to pick up the <code>PATH</code>.</p> <pre><code># Check if package is in the profile\nls -la /nix/var/nix/profiles/system-manager-profiles/*/bin/\n\n# Verify the package is in your config\ncat /etc/installed-packages.txt\n\n# Check $PATH\necho $PATH\n</code></pre>"},{"location":"faq/#permission-denied","title":"Permission Denied","text":"<p>Ensure you're running System Manager with sudo:</p> <pre><code>nix run 'github:numtide/system-manager' -- switch --flake . --sudo\n</code></pre>"},{"location":"faq/#configuration-wont-build","title":"Configuration Won't Build","text":"<pre><code># Check for syntax errors\nnix flake check\n\n# Build without activation\nnix build .#systemConfigs.default\n\n# View build logs\nnix log /nix/store/&lt;hash&gt;\n</code></pre>"},{"location":"faq/#selinux-issues","title":"SELinux Issues","text":"<p>System Manager currently does not fully support SELinux. If you're on a system with SELinux enabled (like Fedora or RHEL), you may encounter permission issues.</p> <p>Temporary workaround: Set SELinux to permissive mode:</p> <pre><code>sudo setenforce 0\n</code></pre> <p>For a permanent solution, see GitHub issue #115 for ongoing work on SELinux support.</p>"},{"location":"faq/#additional-resources","title":"Additional Resources","text":"<ul> <li>System Manager GitHub Repository</li> <li>System Manager Documentation</li> <li>NixOS Module Options</li> <li>Nix Package Search</li> <li>PR #266: User Management with Userborn</li> </ul>"},{"location":"examples/","title":"Examples","text":"<p>Complete, working examples demonstrating System Manager configurations for common use cases.</p>"},{"location":"examples/#available-examples","title":"Available Examples","text":""},{"location":"examples/#timer","title":"Timer","text":"<p>Create a simple systemd timer that runs every minute, demonstrating how to set up scheduled tasks.</p>"},{"location":"examples/#docker","title":"Docker","text":"<p>Install Docker and configure it as a systemd service with proper socket activation and daemon configuration.</p>"},{"location":"examples/#postgresql","title":"PostgreSQL","text":"<p>Set up a PostgreSQL database server with automatic initialization, user creation, and proper systemd integration.</p>"},{"location":"examples/#nginx","title":"Nginx","text":"<p>Configure Nginx as a web server with HTTP support, including systemd service management and <code>/etc</code> configuration.</p>"},{"location":"examples/#nginx-https","title":"Nginx HTTPS","text":"<p>Extend the Nginx configuration with SSL/TLS certificates for HTTPS support, including certificate management and security best practices.</p>"},{"location":"examples/#custom-app","title":"Custom App","text":"<p>Deploy a custom TypeScript/Bun application behind Nginx, demonstrating how to fetch code from GitHub and run it as a systemd service. Includes a live example you can try.</p>"},{"location":"examples/custom-app/","title":"Custom App","text":"<p>This example shows how to deploy custom web software from a repository and run it behind Nginx.</p>"},{"location":"examples/custom-app/#live-example","title":"Live example","text":"<p>We have a complete example live that you can try out. All you need is a fresh server (such as on Amazon EC2) with at least 16GB memory. (We recommend the latest Ubuntu, with a t3Large instance, with 16GB RAM. Then allow SSH, HTTP traffic, and HTTPS traffic if you plan to build on these examples.) We have two repos:</p> <ol> <li> <p>The sample application</p> </li> <li> <p>The configuration files</p> </li> </ol> <p>The configuration files install both nginx and the sample app.</p> <p>After you spin up an instance, install nix for all users:</p> <pre><code>sh &lt;(curl --proto '=https' --tlsv1.2 -L https://nixos.org/nix/install) --daemon\n</code></pre> <p>Next, log out and log back in so that nix is available in the system path.</p> <p>And then you can run System Manager and deploy the app with one command:</p> <pre><code>nix run 'github:numtide/system-manager' --extra-experimental-features 'nix-command flakes' -- switch --flake github:frecklefacelabs/system-manager-custom-app-deploy/v1.0.0#default --sudo\n</code></pre> <p>(Remember, the first time System Manager runs, it takes up to five minutes or so to compile everything.)</p> <p>Tip</p> <p>We're specifying a tag in our URL. This is good practice to make sure you get the right version of your flakes. Also, modern Nix supports the use of a protocol called \"github\", and when you use that protocol, you can specify the tag behind a slash symbol, as we did here for tag v1.0.0.</p> <p>Tip</p> <p>If you make changes to your flakes, be sure to create a new tag. Without it, Nix sometimes refuses to load the \"latest version\" of the repo, and will insist on using whatever version of your repo it used first.</p> <p>Then, the app should be installed, with nginx sitting in front of it, and you should be able to run:</p> <p><pre><code>curl localhost\n</code></pre> And it will print out a friendly JSON message such as:</p> <pre><code>{\"message\":\"Welcome to the Bun API!\",\"status\":\"running\",\"endpoints\":[\"/\",\"/health\",\"/random\",\"/cowsay\"]}\n</code></pre> <p>We even included cowsay in this sample, which you can try at <code>curl localhost/cowsay</code>. Now even though cowsay is meant for fun, the primary reason is this is a TypeScript app that uses <code>bun</code>, and we wanted to demonstrate how easy it is to include <code>npm</code> libraries. <code>bun</code> includes a feature whereby it will install dependency packages from <code>package.json</code> automatically the first time it runs, greatly simplifying the setup.</p> <p>One thing about the <code>.nix</code> files in this repo is that they in turn pull code (our TypeScript app) from another remote repo. Using this approach, you can separate concerns, placing the deployment <code>.nix</code> files in one repo, and the source app in a separate repo.</p>"},{"location":"examples/custom-app/#configuration-files","title":"Configuration files","text":"<p>Here are further details on the individual <code>.nix</code> files.</p>"},{"location":"examples/custom-app/#flakenix","title":"flake.nix","text":"<p>First we have a flake much like the usual starting point:</p> <pre><code># flake.nix\n{\n  description = \"Standalone System Manager configuration\";\n\n  inputs = {\n    # Specify the source of System Manager and Nixpkgs.\n    nixpkgs.url = \"github:nixos/nixpkgs/nixos-unstable\";\n    system-manager = {\n      url = \"github:numtide/system-manager\";\n      inputs.nixpkgs.follows = \"nixpkgs\";\n    };\n  };\n\n  outputs =\n    {\n      self,\n      nixpkgs,\n      system-manager,\n      ...\n    }:\n    let\n      system = \"x86_64-linux\";\n    in\n    {\n      systemConfigs.default = system-manager.lib.makeSystemConfig {\n\n        # Specify your system configuration modules here, for example,\n        # the path to your system.nix.\n        modules = [\n\n          {\n            nix.settings.experimental-features = \"nix-command flakes\";\n            services.myapp.enable = true;\n          }\n            ./system.nix\n            ./nginx.nix\n            ./bun-app.nix\n        ];\n\n        # Optionally specify extraSpecialArgs and overlays\n      };\n    };\n}\n</code></pre>"},{"location":"examples/custom-app/#nginxnix","title":"nginx.nix","text":"<p>Next is the <code>.nix</code> configuration that installs and configures nginx. This is a simple nginx configuration, as it simply routes incoming HTTP traffic directly to the app:</p> <pre><code># nginx.nix\n{ config, lib, pkgs, ... }:\n{\n  config = {\n    services.nginx = {\n      enable = true;\n\n      recommendedGzipSettings = true;\n      recommendedOptimisation = true;\n      recommendedProxySettings = true;\n      recommendedTlsSettings = true;\n\n      virtualHosts.\"_\" = {\n        default = true;\n\n        locations.\"/\" = {\n          proxyPass = \"http://127.0.0.1:3000\";\n          extraConfig = ''\n            proxy_set_header Host $host;\n            proxy_set_header X-Real-IP $remote_addr;\n            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n            proxy_set_header X-Forwarded-Proto $scheme;\n          '';\n        };\n\n        locations.\"/health\" = {\n          proxyPass = \"http://127.0.0.1:3000/health\";\n          extraConfig = ''\n            access_log off;\n          '';\n        };\n      };\n    };\n  };\n}\n</code></pre>"},{"location":"examples/custom-app/#bun-appnix","title":"bun-app.nix","text":"<p>Next, here's the <code>.nix</code> configuration that creates a service that runs the app.</p> <pre><code># bun-app.nix\n{ config, lib, pkgs, ... }:\nlet\n  # Fetch the app from GitHub\n  appSource = pkgs.fetchFromGitHub {\n    owner = \"frecklefacelabs\";\n    repo = \"typescript_app_for_system_manager\";\n    rev = \"v1.0.0\";  # Use a tag\n    sha256 = \"sha256-TWt/Y2B7cGxjB9pxMOApt83P29uiCBv5nVT3KyycYEA=\";\n  };\nin\n{\n  config = {\n    nixpkgs.hostPlatform = \"x86_64-linux\";\n\n    # Install Bun\n    environment.systemPackages = with pkgs; [\n      bun\n    ];\n\n    # Simple systemd service - runs Bun directly from Nix store!\n    systemd.services.bunapp = {\n      description = \"Bun TypeScript Application\";\n      after = [ \"network.target\" ];\n      wantedBy = [ \"multi-user.target\" ];\n\n      serviceConfig = {\n        Type = \"simple\";\n        User = \"ubuntu\";\n        Group = \"ubuntu\";\n        WorkingDirectory = \"${appSource}\";\n        # Bun will auto-install dependencies from package.json on first run\n        ExecStart = \"${pkgs.bun}/bin/bun run index.ts\";\n        Restart = \"always\";\n        RestartSec = \"10s\";\n      };\n\n      environment = {\n        NODE_ENV = \"production\";\n      };\n    };\n  };\n}\n</code></pre>"},{"location":"examples/custom-app/#indexts-the-application","title":"index.ts (The application)","text":"<p>And finally, here's the <code>index.ts</code> file; it's just a simple REST app that also makes use of one third-party <code>npm</code> library.</p> <pre><code>import cowsay from \"cowsay\";\n\nconst messages = [\n  \"Hello from System Manager!\",\n  \"Bun is blazingly fast!\",\n  \"Nix + Bun = Easy deployments\",\n  \"Making it happen!\",\n  \"Nix rocks!\"\n];\n\nconst server = Bun.serve({\n  port: 3000,\n  fetch(req) {\n    const url = new URL(req.url);\n\n    if (url.pathname === \"/\") {\n      return new Response(JSON.stringify({\n        message: \"Welcome to the Bun API!\",\n        status: \"running\",\n        endpoints: [\"/\", \"/health\", \"/random\", \"/cowsay\"]\n      }), {\n        headers: { \"Content-Type\": \"application/json\" }\n      });\n    }\n\n    if (url.pathname === \"/health\") {\n      return new Response(JSON.stringify({\n        status: \"healthy\"\n      }), {\n        headers: { \"Content-Type\": \"application/json\" }\n      });\n    }\n\n    if (url.pathname === \"/random\") {\n      const randomMessage = messages[Math.floor(Math.random() * messages.length)];\n      return new Response(JSON.stringify({\n        message: randomMessage,\n        timestamp: new Date().toISOString()\n      }), {\n        headers: { \"Content-Type\": \"application/json\" }\n      });\n    }\n\n    if (url.pathname === \"/cowsay\") {\n      const cow = cowsay.say({\n        text: \"Deployed with System Manager and Nix!\"\n      });\n      return new Response(cow, {\n        headers: { \"Content-Type\": \"text/plain\" }\n      });\n    }\n\n    return new Response(\"Not Found\", { status: 404 });\n  },\n});\n\nconsole.log(`Server running on http://localhost:${server.port}`);\n</code></pre>"},{"location":"examples/custom-app/#what-this-configuration-does","title":"What this configuration does","text":"<ol> <li>Fetches the application from GitHub using <code>pkgs.fetchFromGitHub</code></li> <li>Installs Bun as a system package</li> <li>Creates a systemd service that:</li> <li>Runs the TypeScript app using Bun</li> <li>Automatically restarts on failure</li> <li>Sets the working directory to the fetched source</li> <li>Configures Nginx as a reverse proxy to the app on port 3000</li> </ol>"},{"location":"examples/custom-app/#key-concepts","title":"Key concepts","text":"<ul> <li>Separation of concerns: The deployment configuration (<code>.nix</code> files) lives in one repo, while the application source lives in another</li> <li>Automatic dependency installation: Bun installs npm dependencies from <code>package.json</code> on first run</li> <li>Reproducible deployments: The <code>sha256</code> hash ensures you get the exact version you expect</li> </ul>"},{"location":"examples/docker/","title":"Docker","text":"<p>This example shows how to install Docker and configure it as a systemd service.</p>"},{"location":"examples/docker/#configuration","title":"Configuration","text":"<pre><code>{\n  description = \"System Manager - Docker Example\";\n\n  inputs = {\n    nixpkgs.url = \"github:NixOS/nixpkgs/nixos-unstable\";\n    system-manager = {\n      url = \"github:numtide/system-manager\";\n      inputs.nixpkgs.follows = \"nixpkgs\";\n    };\n  };\n\n  outputs = { self, nixpkgs, system-manager }: {\n    systemConfigs.default = system-manager.lib.makeSystemConfig {\n      modules = [\n        {\n          nixpkgs.hostPlatform = \"x86_64-linux\";\n\n          # Install Docker and related tools\n          environment.systemPackages = with nixpkgs.legacyPackages.x86_64-linux; [\n            docker\n            docker-compose\n            docker-buildx\n          ];\n\n          # Docker daemon configuration\n          environment.etc.\"docker/daemon.json\".text = ''\n            {\n              \"log-driver\": \"json-file\",\n              \"log-opts\": {\n                \"max-size\": \"10m\",\n                \"max-file\": \"3\"\n              },\n              \"storage-driver\": \"overlay2\",\n              \"storage-opts\": [\n                \"overlay2.override_kernel_check=true\"\n              ]\n            }\n          '';\n\n          # Create Docker systemd service\n          systemd.services.docker = {\n            enable = true;\n            description = \"Docker Application Container Engine\";\n            documentation = [ \"https://docs.docker.com\" ];\n            after = [ \"network-online.target\" \"firewalld.service\" \"containerd.service\" ];\n            wants = [ \"network-online.target\" ];\n            requires = [ \"docker.socket\" ];\n            wantedBy = [ \"system-manager.target\" ];\n\n            serviceConfig = {\n              Type = \"notify\";\n              ExecStart = \"${nixpkgs.legacyPackages.x86_64-linux.docker}/bin/dockerd --host=fd://\";\n              ExecReload = \"/bin/kill -s HUP $MAINPID\";\n              TimeoutStartSec = 0;\n              RestartSec = 2;\n              Restart = \"always\";\n              StartLimitBurst = 3;\n              StartLimitInterval = \"60s\";\n\n              # Security settings\n              LimitNOFILE = 1048576;\n              LimitNPROC = \"infinity\";\n              LimitCORE = \"infinity\";\n              TasksMax = \"infinity\";\n              Delegate = \"yes\";\n              KillMode = \"process\";\n              OOMScoreAdjust = -500;\n            };\n          };\n\n          # Docker socket\n          systemd.sockets.docker = {\n            enable = true;\n            description = \"Docker Socket for the API\";\n            wantedBy = [ \"sockets.target\" ];\n\n            socketConfig = {\n              ListenStream = \"/var/run/docker.sock\";\n              SocketMode = \"0660\";\n              SocketUser = \"root\";\n              SocketGroup = \"docker\";\n            };\n          };\n\n          # Create necessary directories and setup\n          systemd.tmpfiles.rules = [\n            \"d /var/lib/docker 0710 root root -\"\n            \"d /var/run/docker 0755 root root -\"\n            \"d /etc/docker 0755 root root -\"\n          ];\n        }\n      ];\n    };\n  };\n}\n</code></pre>"},{"location":"examples/docker/#usage","title":"Usage","text":"<pre><code># Activate the configuration\nnix run 'github:numtide/system-manager' -- switch --flake /path/to/this/example --sudo\n\n# Check Docker service status\nsudo systemctl status docker\n\n# Test Docker\nsudo docker run hello-world\n\n# Check Docker version\nsudo docker --version\n\n# View Docker logs\nsudo journalctl -u docker -f\n</code></pre>"},{"location":"examples/docker/#notes","title":"Notes","text":"<ul> <li>Ensure the <code>docker</code> group exists on your system</li> <li>Add your user to the docker group: <code>sudo usermod -aG docker $USER</code></li> <li>You may need to log out and back in for group changes to take effect</li> <li>This example uses the Docker socket for API communication</li> </ul>"},{"location":"examples/nginx-https/","title":"Nginx HTTPS","text":"<p>This example shows how to install Nginx with HTTPS support using SSL certificates.</p>"},{"location":"examples/nginx-https/#configuration","title":"Configuration","text":"<p>Here's an example that installs nginx with HTTPS. This example shows places where you would copy in your own secure certificate information.</p> <pre><code>{ lib, pkgs, ... }:\n{\n  config = {\n    nixpkgs.hostPlatform = \"x86_64-linux\";\n\n    # Enable and configure services\n    # Commenting this out -- apparently this loads a bunch of nginx service files we don't need or want\n    #services = {\n    #  nginx.enable = true;\n    #};\n\n    environment = {\n      systemPackages = [\n        pkgs.hello\n        pkgs.mariadb\n        pkgs.nginx\n      ];\n\n      # Add SSL certificate files to /etc\n      etc = {\n        # SSL Certificate\n        \"ssl/certs/your-domain.crt\" = {\n          user = \"root\";\n          group = \"root\";\n          mode = \"0644\";\n          # Option 1: Embed the certificate directly\n          text = ''\n-----BEGIN CERTIFICATE-----\nMIIDwzCCAqugAwIBAgIUXbQ2ie2/2pxLH/okEB4KEbVDqjEwDQYJKoZIhvcNAQEL...\n-----END CERTIFICATE-----\n          '';\n          # Option 2: Or reference a file from your repo\n          # source = ./certs/your-domain.crt;\n        };\n\n        # SSL Private Key\n        \"ssl/private/your-domain.key\" = {\n          user = \"root\";\n          group = \"root\";\n          mode = \"0600\";  # Restrict access to private key!\n          # Option 1: Embed the key directly\n          text = ''\n-----BEGIN PRIVATE KEY-----\nMIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQC5gQjZxG7rYPub....\n-----END PRIVATE KEY-----\n          '';\n          # Option 2: Or reference a file from your repo\n          # source = ./certs/your-domain.key;\n        };\n\n        # Optional: Certificate chain/intermediate certificates\n        # For this demo we're using a self-signed cert; for a real\n        # one, uncomment below and add your\n        \"ssl/certs/chain.pem\" = {\n          user = \"root\";\n          group = \"root\";\n          mode = \"0644\";\n          text = ''\n            -----BEGIN CERTIFICATE-----\nYOUR_CHAIN_CERTIFICATE_HERE...\n            -----END CERTIFICATE-----\n          '';\n        #};\n\n        # Nginx configuration with HTTPS\n        \"nginx/nginx.conf\" = {\n          user = \"root\";\n          group = \"root\";\n          mode = \"0644\";\n          text = ''\nworker_processes auto;\n\nerror_log /var/log/nginx/error.log;\npid /run/nginx.pid;\n\nevents {\n    worker_connections 1024;\n}\n\nhttp {\n    include             ${pkgs.nginx}/conf/mime.types;\n    default_type        application/octet-stream;\n\n    sendfile            on;\n    keepalive_timeout   65;\n\n    # SSL Settings\n    ssl_protocols TLSv1.2 TLSv1.3;\n    ssl_prefer_server_ciphers on;\n    ssl_ciphers 'ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384';\n\n    # HTTP Server - Redirect to HTTPS\n    server {\n        listen 80;\n        server_name demo.frecklefacelabs.com www.demo.frecklefacelabs.com;\n\n        # Redirect all HTTP to HTTPS\n        return 301 https://$server_name$request_uri;\n    }\n\n    # HTTPS Server\n    server {\n        listen 443 ssl;\n        server_name demo.frecklefacelabs.com www.demo.frecklefacelabs.com;\n\n        # SSL Certificate files\n        ssl_certificate /etc/ssl/certs/your-domain.crt;\n        ssl_certificate_key /etc/ssl/private/your-domain.key;\n\n        # Optional: Certificate chain\n        # ssl_trusted_certificate /etc/ssl/certs/chain.pem;\n\n        # Optional: Enable OCSP stapling\n        ssl_stapling on;\n        ssl_stapling_verify on;\n\n        # Optional: Enable HSTS (HTTP Strict Transport Security)\n        add_header Strict-Transport-Security \"max-age=31536000; includeSubDomains\" always;\n\n        root ${pkgs.nginx}/html;\n\n        location / {\n            index index.html;\n        }\n\n        access_log /var/log/nginx/access.log;\n        error_log /var/log/nginx/error.log;\n    }\n}\n          '';\n        };\n      };\n    };\n\n    systemd.services = {\n      nginx = {\n        enable = true;\n        #description = \"A high performance web server and reverse proxy server\";\n        wantedBy = [ \"system-manager.target\" ];\n        preStart = ''\n          mkdir -p /var/log/nginx\n          chown -R root:root /var/log/nginx\n\n          # Verify SSL certificate files exist\n          if [ ! -f /etc/ssl/certs/your-domain.crt ]; then\n            echo \"ERROR: SSL certificate not found!\"\n            exit 1\n          fi\n          if [ ! -f /etc/ssl/private/your-domain.key ]; then\n            echo \"ERROR: SSL private key not found!\"\n            exit 1\n          fi\n        '';\n        serviceConfig = {\n          Type = \"forking\";\n          PIDFile = \"/run/nginx.pid\";\n          ExecStart = \"${pkgs.nginx}/bin/nginx -c /etc/nginx/nginx.conf\";\n          ExecStop = \"${pkgs.nginx}/bin/nginx -s stop\";\n          User = \"root\";\n          Group = \"root\";\n          Restart = \"on-failure\";\n        };\n      };\n    };\n  };\n}\n</code></pre>"},{"location":"examples/nginx-https/#what-this-configuration-does","title":"What this configuration does","text":"<ol> <li>Creates SSL certificate files in <code>/etc/ssl/</code>:</li> <li><code>/etc/ssl/certs/your-domain.crt</code> - The public certificate</li> <li><code>/etc/ssl/private/your-domain.key</code> - The private key (with restricted permissions)</li> <li> <p><code>/etc/ssl/certs/chain.pem</code> - Optional intermediate certificates</p> </li> <li> <p>Configures Nginx for HTTPS:</p> </li> <li>Redirects HTTP (port 80) to HTTPS</li> <li>Enables TLS 1.2 and 1.3 only</li> <li>Uses strong cipher suites</li> <li> <p>Enables HSTS for security</p> </li> <li> <p>Creates a systemd service that:</p> </li> <li>Verifies SSL certificates exist before starting</li> <li>Runs Nginx with the HTTPS configuration</li> </ol>"},{"location":"examples/nginx-https/#security-notes","title":"Security notes","text":"<ul> <li>The private key file uses mode <code>0600</code> to restrict access</li> <li>TLS 1.0 and 1.1 are disabled for security</li> <li>HSTS is enabled to enforce HTTPS</li> <li>Replace the placeholder certificate content with your actual certificates</li> </ul>"},{"location":"examples/nginx/","title":"Nginx","text":"<p>This example shows how to install and configure Nginx as a web server with HTTP support.</p> <p>Tip</p> <p>This is simply an example to help you learn how to use System Manager. The usual way to install nginx under Nix is to use the nginx package.</p>"},{"location":"examples/nginx/#configuration","title":"Configuration","text":"<p>Here's a <code>.nix</code> file that installs and configures nginx as a system service. Note that this version only supports HTTP and not HTTPS; see Nginx HTTPS for an example that includes HTTPS.</p> <pre><code>{ lib, pkgs, ... }:\n{\n  config = {\n    nixpkgs.hostPlatform = \"x86_64-linux\";\n\n    # Enable and configure services\n    services = {\n      nginx.enable = true;\n    };\n\n    environment = {\n      # Packages that should be installed on a system\n      systemPackages = [\n        pkgs.hello\n        pkgs.mariadb\n        pkgs.nginx\n      ];\n\n      # Add directories and files to `/etc` and set their permissions\n      etc = {\n        \"nginx/nginx.conf\"= {\n\n                user = \"root\";\n                group = \"root\";\n                mode = \"0644\";\n\n                text = ''\n# The user/group is often set to 'nginx' or 'www-data',\n# but for a simple root-only demo, we'll keep the default.\n# user nginx;\nworker_processes auto;\n\n# NGINX looks for modules relative to the install prefix,\n# but we explicitly point to the Nix store path to be safe.\nerror_log /var/log/nginx/error.log;\npid /run/nginx.pid;\n\nevents {\n    worker_connections 1024;\n}\n\nhttp {\n    include             ${pkgs.nginx}/conf/mime.types;\n    default_type        application/octet-stream;\n\n    sendfile            on;\n    keepalive_timeout   65;\n\n    # Basic default server block\n    server {\n        listen 80;\n        server_name localhost;\n\n        # Point the root directory to a standard location or a Nix store path\n        root ${pkgs.nginx}/html;\n\n        location / {\n            index index.html;\n        }\n\n        # Example log files\n        access_log /var/log/nginx/access.log;\n        error_log /var/log/nginx/error.log;\n    }\n}\n    '';\n\n\n        };\n      };\n    };\n\n    # Enable and configure systemd services\n    systemd.services = {\n        nginx = {\n            enable = true;\n            description = \"A high performance web server and reverse proxy server\";\n            wantedBy = [ \"system-manager.target\" ];\n            preStart = ''\n                mkdir -p /var/log/nginx\n                chown -R root:root /var/log/nginx # Ensure permissions are right for root user\n            '';\n            serviceConfig = {\n                Type = \"forking\";\n                PIDFile = \"/run/nginx.pid\";\n\n                # The main binary execution command, pointing to the Nix store path\n                ExecStart = \"${pkgs.nginx}/bin/nginx -c /etc/nginx/nginx.conf\";\n\n                # The command to stop the service gracefully\n                ExecStop = \"${pkgs.nginx}/bin/nginx -s stop\";\n\n                # NGINX needs to run as root to bind to port 80/443\n                User = \"root\";\n                Group = \"root\";\n\n                # Restart policy for robustness\n                Restart = \"on-failure\";\n            };\n        };\n    };\n\n\n  };\n}\n</code></pre>"},{"location":"examples/nginx/#what-this-configuration-does","title":"What this configuration does","text":"<ol> <li>Installs Nginx as a system package</li> <li>Creates <code>/etc/nginx/nginx.conf</code> with a basic HTTP configuration</li> <li>Creates a systemd service that:</li> <li>Creates the log directory on startup</li> <li>Runs Nginx with the custom configuration</li> <li>Restarts on failure</li> <li>Serves the default Nginx welcome page on port 80</li> </ol>"},{"location":"examples/postgresql/","title":"PostgreSQL","text":"<p>This example shows how to install and configure PostgreSQL as a systemd service.</p>"},{"location":"examples/postgresql/#prerequisites","title":"Prerequisites","text":"<p>System Manager is still in its early state, and doesn't yet have user management, which is a planned feature that will be here soon. As such, for now, before you run this, you'll need to manually create the postgres user. Additionally, go ahead and create two directories and grant the postgres user access to them:</p> <pre><code># Create postgres user and group\nsudo groupadd -r postgres\nsudo useradd -r -g postgres -d /var/lib/postgresql -s /bin/bash postgres\n\n# Create directories with proper permissions\nsudo mkdir -p /var/lib/postgresql\nsudo chown postgres:postgres /var/lib/postgresql\n\nsudo mkdir -p /run/postgresql\nsudo chown postgres:postgres /run/postgresql\n</code></pre>"},{"location":"examples/postgresql/#configuration","title":"Configuration","text":"<p>Here's the <code>.nix</code> file that installs PostgreSQL.</p> <pre><code>{ config, lib, pkgs, ... }:\n{\n  config = {\n    nixpkgs.hostPlatform = \"x86_64-linux\";\n\n    environment.systemPackages = with pkgs; [\n      postgresql_16\n    ];\n\n    # PostgreSQL service\n    systemd.services.postgresql = {\n      description = \"PostgreSQL database server\";\n      wantedBy = [ \"multi-user.target\" ];\n      after = [ \"network.target\" ];\n\n      serviceConfig = {\n        Type = \"notify\";\n        User = \"postgres\";\n        Group = \"postgres\";\n        ExecStart = \"${pkgs.postgresql_16}/bin/postgres -D /var/lib/postgresql/16\";\n        ExecReload = \"${pkgs.coreutils}/bin/kill -HUP $MAINPID\";\n        KillMode = \"mixed\";\n        KillSignal = \"SIGINT\";\n        TimeoutSec = 120;\n\n        # Create directories and initialize database\n        ExecStartPre = [\n          \"${pkgs.coreutils}/bin/mkdir -p /var/lib/postgresql/16\"\n          \"${pkgs.bash}/bin/bash -c 'if [ ! -d /var/lib/postgresql/16/base ]; then ${pkgs.postgresql_16}/bin/initdb -D /var/lib/postgresql/16; fi'\"\n        ];\n      };\n\n      environment = {\n        PGDATA = \"/var/lib/postgresql/16\";\n      };\n    };\n\n    # Initialize database and user\n    systemd.services.postgresql-init = {\n      description = \"Initialize PostgreSQL database for myapp\";\n      after = [ \"postgresql.service\" ];\n      wantedBy = [ \"multi-user.target\" ];\n      serviceConfig = {\n        Type = \"oneshot\";\n        RemainAfterExit = true;\n        User = \"postgres\";\n      };\n      script = ''\n        # Wait for PostgreSQL to be ready\n        until ${pkgs.postgresql_16}/bin/pg_isready; do\n          echo \"Waiting for PostgreSQL...\"\n          sleep 2\n        done\n\n        # Optional: Create database if it doesn't exist\n        ${pkgs.postgresql_16}/bin/psql -lqt | ${pkgs.coreutils}/bin/cut -d \\| -f 1 | ${pkgs.gnugrep}/bin/grep -qw myapp || \\\n          ${pkgs.postgresql_16}/bin/createdb myapp\n\n        # Optional: Create user if it doesn't exist\n        ${pkgs.postgresql_16}/bin/psql -tAc \"SELECT 1 FROM pg_roles WHERE rolname='myapp'\" | ${pkgs.gnugrep}/bin/grep -q 1 || \\\n          ${pkgs.postgresql_16}/bin/createuser myapp\n\n        # Grant database privileges\n        ${pkgs.postgresql_16}/bin/psql -c \"GRANT ALL PRIVILEGES ON DATABASE myapp TO myapp\"\n\n        # Grant schema privileges (allows creating tables!)\n        ${pkgs.postgresql_16}/bin/psql -d myapp -c \"GRANT ALL ON SCHEMA public TO myapp\"\n        ${pkgs.postgresql_16}/bin/psql -d myapp -c \"GRANT ALL ON ALL TABLES IN SCHEMA public TO myapp\"\n        ${pkgs.postgresql_16}/bin/psql -d myapp -c \"GRANT ALL ON ALL SEQUENCES IN SCHEMA public TO myapp\"\n\n        echo \"PostgreSQL is ready and configured!\"\n      '';\n    };\n  };\n}\n</code></pre>"},{"location":"examples/postgresql/#what-this-configuration-does","title":"What this configuration does","text":"<ol> <li>Installs PostgreSQL 16 as a system package</li> <li>Creates a systemd service that:</li> <li>Runs as the <code>postgres</code> user</li> <li>Initializes the database directory on first run</li> <li>Starts PostgreSQL with the data directory at <code>/var/lib/postgresql/16</code></li> <li>Creates an initialization service that:</li> <li>Waits for PostgreSQL to be ready</li> <li>Creates a database called <code>myapp</code></li> <li>Creates a user called <code>myapp</code></li> <li>Grants appropriate privileges</li> </ol>"},{"location":"examples/timer/","title":"Timer","text":"<p>This example demonstrates how to install a systemd timer that runs every minute.</p>"},{"location":"examples/timer/#configuration","title":"Configuration","text":""},{"location":"examples/timer/#flakenix","title":"flake.nix","text":"<pre><code>{\n  description = \"Standalone System Manager configuration\";\n\n  inputs = {\n    # Specify the source of System Manager and Nixpkgs.\n    nixpkgs.url = \"github:nixos/nixpkgs/nixos-unstable\";\n    system-manager = {\n      url = \"github:numtide/system-manager\";\n      inputs.nixpkgs.follows = \"nixpkgs\";\n    };\n  };\n\n  outputs =\n    {\n      self,\n      nixpkgs,\n      system-manager,\n      ...\n    }:\n    let\n      system = \"x86_64-linux\";\n    in\n    {\n      systemConfigs.default = system-manager.lib.makeSystemConfig {\n        # Specify your system configuration modules here, for example,\n        # the path to your system.nix.\n        modules = [ ./system.nix ];\n\n        # Optionally specify extraSpecialArgs and overlays\n      };\n    };\n}\n</code></pre>"},{"location":"examples/timer/#systemnix","title":"system.nix","text":"<pre><code>{ pkgs, ... }:\n{\n  nixpkgs.hostPlatform = \"x86_64-linux\";\n\n  # Define the timer that fires every minute\n  systemd.timers.simple-timer = {\n    enable = true;\n    description = \"Simple timer that runs every minute\";\n    wantedBy = [ \"timers.target\" ];\n    timerConfig = {\n      OnCalendar = \"minutely\";\n      Persistent = true;\n    };\n  };\n\n  # Define the service that the timer triggers\n  systemd.services.simple-timer = {\n    enable = true;\n    description = \"Simple timer service\";\n    serviceConfig = {\n      Type = \"oneshot\";\n      ExecStart = \"${pkgs.bash}/bin/bash -c 'echo \\\"Timer fired at $(date)\\\" &gt;&gt; /tmp/simple-timer.log'\";\n    };\n  };\n}\n</code></pre>"},{"location":"examples/timer/#usage","title":"Usage","text":"<pre><code># Activate the configuration\nnix run 'github:numtide/system-manager' -- switch --flake /path/to/this/example --sudo\n</code></pre> <p>Then restart the system; the timer will start automatically.</p> <pre><code># View the file created every one minute\ncat /tmp/simple-timer.log\n</code></pre>"},{"location":"examples/timer/#notes","title":"Notes","text":"<ul> <li>The timer will not start automatically until you reboot the system. If you wish to start it manually, you can do so by typing:</li> </ul> <pre><code>sudo systemctl start simple-timer.timer\n</code></pre>"},{"location":"explanation/declarative-config/","title":"Declarative Configuration","text":"<p>This page explains the declarative configuration paradigm that System Manager uses, and why it matters for system administration.</p>"},{"location":"explanation/declarative-config/#imperative-vs-declarative","title":"Imperative vs Declarative","text":""},{"location":"explanation/declarative-config/#imperative-step-by-step-commands","title":"Imperative: Step-by-Step Commands","text":"<p>Traditional system administration is imperative. You tell the system how to do things, step by step:</p> <pre><code>apt install nginx\nvim /etc/nginx/nginx.conf\nsystemctl enable nginx\nsystemctl start nginx\n</code></pre> <p>Each command mutates the system in place. Over time, you may forget what changes you made, commands may fail partway through, and two machines configured \"the same way\" may end up different.</p>"},{"location":"explanation/declarative-config/#declarative-desired-state","title":"Declarative: Desired State","text":"<p>System Manager uses a declarative approach. You describe what the system should look like:</p> <pre><code>{\n  environment.systemPackages = [ pkgs.nginx ];\n\n  services.nginx = {\n    enable = true;\n    virtualHosts.\"example.com\" = {\n      root = \"/var/www\";\n    };\n  };\n}\n</code></pre> <p>System Manager figures out the steps to make your system match this description. Run it again, and nothing changes (the system already matches). Run it on a fresh machine, and it applies everything needed.</p>"},{"location":"explanation/declarative-config/#benefits-of-declarative-configuration","title":"Benefits of Declarative Configuration","text":""},{"location":"explanation/declarative-config/#reproducibility","title":"Reproducibility","text":"<p>Your configuration files are a complete description of system state. Copy them to another machine, run System Manager, and you get an identical setup.</p>"},{"location":"explanation/declarative-config/#no-configuration-drift","title":"No Configuration Drift","text":"<p>Imperative systems drift over time. Someone SSHs in, makes a quick fix, forgets to document it. With declarative configuration, if it's not in your <code>.nix</code> files, it doesn't exist.</p>"},{"location":"explanation/declarative-config/#version-control","title":"Version Control","text":"<p>Your entire system configuration is text files. Store them in Git:</p> <ul> <li>Track every change with commit history</li> <li>Review changes in pull requests</li> <li>Bisect to find when something broke</li> <li>Branch for experiments</li> </ul>"},{"location":"explanation/declarative-config/#safe-rollback","title":"Safe Rollback","text":"<p>System Manager keeps previous configurations as \"generations.\" If an update breaks something, rollback in seconds:</p> <pre><code>sudo nix-env --profile /nix/var/nix/profiles/system-manager-profiles --rollback\nnix run 'github:numtide/system-manager' -- activate --sudo\n</code></pre>"},{"location":"explanation/declarative-config/#team-collaboration","title":"Team Collaboration","text":"<p>With configuration in Git:</p> <ul> <li>New team members can understand the system by reading code</li> <li>Changes require review before merging</li> <li>Everyone works from the same source of truth</li> </ul>"},{"location":"explanation/declarative-config/#the-mental-shift","title":"The Mental Shift","text":"<p>Moving from imperative to declarative requires a mindset change:</p> Imperative Thinking Declarative Thinking \"Install nginx\" \"The system has nginx\" \"Edit the config file\" \"The config file contains...\" \"Restart the service\" \"The service is running\" \"What did I change?\" \"Read the config file\" <p>You stop thinking about actions and start thinking about state.</p>"},{"location":"explanation/declarative-config/#when-declarative-matters-most","title":"When Declarative Matters Most","text":"<p>Declarative configuration is most valuable when:</p> <ul> <li>Managing multiple similar machines</li> <li>Onboarding new team members</li> <li>Recovering from failures</li> <li>Auditing system state</li> <li>Ensuring compliance</li> </ul> <p>For a single laptop you rarely change, imperative is fine. For anything more complex, declarative pays dividends.</p>"},{"location":"explanation/declarative-config/#see-also","title":"See Also","text":"<ul> <li>Introduction - What is System Manager?</li> <li>How System Manager Works - Architecture details</li> <li>Getting Started - Try it yourself</li> </ul>"},{"location":"explanation/how-it-works/","title":"How System Manager Works","text":"<p>This page explains the architecture and internal workings of System Manager.</p>"},{"location":"explanation/how-it-works/#overview","title":"Overview","text":"<p>System Manager has two main components:</p> <ol> <li>system-manager - The CLI tool you interact with</li> <li>system-manager-engine - The privileged core that modifies the system</li> </ol> <p>When you run <code>nix run 'github:numtide/system-manager' -- switch --flake . --sudo</code>, several things happen.</p>"},{"location":"explanation/how-it-works/#the-build-phase","title":"The Build Phase","text":"<p>First, Nix evaluates your configuration:</p> <ol> <li>Your <code>flake.nix</code> is parsed</li> <li>All imported modules are loaded and merged</li> <li>The final configuration is evaluated</li> <li>Nix builds derivations for all packages, service files, and <code>/etc</code> entries</li> </ol> <p>This happens without root privileges. The output is a store path in <code>/nix/store/</code> containing everything needed to configure your system.</p>"},{"location":"explanation/how-it-works/#the-activation-phase","title":"The Activation Phase","text":"<p>With <code>--sudo</code>, System Manager runs the privileged activation:</p> <ol> <li> <p>Create a new generation - The new configuration is registered as a \"generation\" in <code>/nix/var/nix/profiles/system-manager-profiles/</code></p> </li> <li> <p>Update <code>/etc</code> files - Managed files are symlinked or copied to <code>/etc</code>. System Manager tracks which files it manages and won't touch files outside its scope.</p> </li> <li> <p>Install systemd units - Service files are placed in <code>/etc/systemd/system/</code> and systemd is reloaded.</p> </li> <li> <p>Start/stop services - Services that changed are restarted. New services start. Removed services stop.</p> </li> <li> <p>Update PATH - On first activation, <code>/etc/profile.d/system-manager-path.sh</code> is created to add <code>/run/system-manager/sw/bin</code> to users' PATH.</p> </li> </ol>"},{"location":"explanation/how-it-works/#generations","title":"Generations","text":"<p>Every successful activation creates a new \"generation.\" Generations are stored as Nix profiles:</p> <pre><code>/nix/var/nix/profiles/system-manager-profiles/\n  system-manager-1-link -&gt; /nix/store/...-system-manager-system\n  system-manager-2-link -&gt; /nix/store/...-system-manager-system\n  system-manager-3-link -&gt; /nix/store/...-system-manager-system\n</code></pre> <p>Each generation is a complete, self-contained configuration. You can switch between them instantly because all the files already exist in the Nix store.</p>"},{"location":"explanation/how-it-works/#what-system-manager-manages","title":"What System Manager Manages","text":"<p>System Manager can manage:</p> Component Location How Packages <code>/run/system-manager/sw/bin/</code> Symlinks to Nix store Services <code>/etc/systemd/system/</code> Generated unit files <code>/etc</code> files <code>/etc/*</code> Symlinks or copies tmpfiles <code>/etc/tmpfiles.d/</code> tmpfiles.d configuration"},{"location":"explanation/how-it-works/#what-system-manager-doesnt-manage","title":"What System Manager Doesn't Manage","text":"<p>System Manager intentionally limits its scope:</p> <ul> <li>Users and groups - Use your distro's tools</li> <li>Bootloader - Managed by your distro</li> <li>Kernel - Managed by your distro</li> <li>Files outside <code>/etc</code> - Use environment.etc for <code>/etc</code> only</li> </ul> <p>This lets System Manager coexist peacefully with your distribution's package manager and configuration.</p>"},{"location":"explanation/how-it-works/#coexistence-with-other-tools","title":"Coexistence with Other Tools","text":"<p>System Manager is designed to coexist with:</p> <ul> <li>apt/dnf/pacman - You can use both. System Manager packages go in <code>/run/system-manager/sw/bin/</code>, distro packages go in <code>/usr/bin/</code>.</li> <li>Manual <code>/etc</code> edits - System Manager only touches files it's configured to manage.</li> <li>Other Nix tools - Works alongside home-manager, devenv, etc.</li> </ul>"},{"location":"explanation/how-it-works/#the-system-managertarget","title":"The system-manager.target","text":"<p>System Manager creates a systemd target called <code>system-manager.target</code>. Services configured with <code>wantedBy = [ \"system-manager.target\" ]</code> start when System Manager activates and on every boot.</p> <p>This target is \"wanted by\" <code>multi-user.target</code>, ensuring your services start during normal system boot.</p>"},{"location":"explanation/how-it-works/#see-also","title":"See Also","text":"<ul> <li>Introduction - Why System Manager exists</li> <li>Declarative Configuration - The paradigm behind it</li> <li>CLI Reference - Command documentation</li> </ul>"},{"location":"explanation/introduction/","title":"Introduction","text":"<p>Declarative system configuration for Linux distributions.</p> <p>System Manager brings the power of NixOS-style declarative configuration to other Linux distributions. Define your packages, services, and <code>/etc</code> files in Nix, and System Manager ensures your system matches that configuration.</p>"},{"location":"explanation/introduction/#why-system-manager","title":"Why System Manager?","text":"<ul> <li>No reinstall required - Keep your existing distro (Ubuntu, Debian, Fedora, etc.) while gaining declarative configuration</li> <li>Reproducible systems - Your configuration files fully describe your system state</li> <li>Generational rollback - Switch between previous configurations when needed</li> <li>Familiar to NixOS users - Uses the same module system and configuration patterns</li> </ul>"},{"location":"explanation/introduction/#who-is-it-for","title":"Who is it for?","text":"<p>System Manager is ideal for:</p> <ul> <li>Developers who want reproducible development environments</li> <li>Sysadmins managing fleets of non-NixOS Linux servers</li> <li>NixOS users who need to configure systems where NixOS isn't an option</li> <li>Anyone tired of imperative configuration drift</li> </ul>"},{"location":"explanation/introduction/#next-steps","title":"Next Steps","text":"<ul> <li>Getting Started - Configure your first system</li> <li>Installation - Install Nix and get started</li> <li>Examples - See practical use cases</li> </ul>"},{"location":"explanation/introduction/#learn-more","title":"Learn More","text":"<ul> <li>Declarative Configuration - Understanding the declarative paradigm</li> <li>How System Manager Works - Architecture and internals</li> <li>Comparison with NixOS - When to use which</li> </ul>"},{"location":"explanation/nixos-comparison/","title":"System Manager vs NixOS","text":"<p>This page explains the relationship between System Manager and NixOS, and when to use each.</p>"},{"location":"explanation/nixos-comparison/#what-is-nixos","title":"What is NixOS?","text":"<p>NixOS is a complete Linux distribution built on Nix. The entire system - kernel, bootloader, packages, services, users - is configured declaratively and built atomically.</p>"},{"location":"explanation/nixos-comparison/#what-is-system-manager","title":"What is System Manager?","text":"<p>System Manager brings NixOS-style declarative configuration to other Linux distributions. It manages packages, services, and <code>/etc</code> files, but leaves the base system (kernel, bootloader, init) to your distribution.</p> <p>If you're already running NixOS, you don't need System Manager - NixOS provides these capabilities natively.</p>"},{"location":"explanation/nixos-comparison/#key-differences","title":"Key Differences","text":"Aspect NixOS System Manager Base system Nix all the way down Your distro (Ubuntu, Debian, etc.) Kernel Managed by Nix Managed by distro Bootloader Managed by Nix Managed by distro Users/Groups Managed declaratively Managed by distro Package manager Only Nix Nix + distro's (apt, dnf, etc.) Init system systemd (required) systemd (required) Rollback Full system rollback Service/package rollback"},{"location":"explanation/nixos-comparison/#when-to-use-nixos","title":"When to Use NixOS","text":"<p>Choose NixOS when:</p> <ul> <li>You want complete declarative control over everything</li> <li>You're setting up new machines from scratch</li> <li>You want atomic system upgrades with full rollback</li> <li>You're comfortable with a less traditional Linux experience</li> </ul>"},{"location":"explanation/nixos-comparison/#when-to-use-system-manager","title":"When to Use System Manager","text":"<p>Choose System Manager when:</p> <ul> <li>You can't or won't reinstall the OS</li> <li>You need to configure existing non-NixOS machines</li> <li>Your organization requires specific distributions (Ubuntu, RHEL, etc.)</li> <li>You want gradual adoption of declarative configuration</li> <li>You're managing cloud instances with vendor-supplied images</li> </ul>"},{"location":"explanation/nixos-comparison/#module-compatibility","title":"Module Compatibility","text":"<p>System Manager uses a subset of NixOS modules. Many modules work directly:</p> <pre><code># This works in both NixOS and System Manager\n{\n  environment.systemPackages = [ pkgs.htop ];\n\n  systemd.services.myapp = {\n    description = \"My Application\";\n    wantedBy = [ \"system-manager.target\" ]; # NixOS uses different target\n    serviceConfig.ExecStart = \"${pkgs.myapp}/bin/myapp\";\n  };\n}\n</code></pre> <p>Some NixOS modules don't apply to System Manager:</p> <ul> <li><code>boot.*</code> - Bootloader configuration</li> <li><code>fileSystems.*</code> - Filesystem mounts</li> <li><code>users.users.*</code> - User management (though this may change)</li> <li>Hardware-specific modules</li> </ul>"},{"location":"explanation/nixos-comparison/#migration-path","title":"Migration Path","text":""},{"location":"explanation/nixos-comparison/#from-traditional-linux-to-system-manager","title":"From Traditional Linux to System Manager","text":"<ol> <li>Install Nix on your existing system</li> <li>Start managing services with System Manager</li> <li>Gradually move more configuration to Nix</li> <li>Keep using apt/dnf for things System Manager doesn't manage</li> </ol>"},{"location":"explanation/nixos-comparison/#from-system-manager-to-nixos","title":"From System Manager to NixOS","text":"<p>If you later decide to switch to NixOS:</p> <ol> <li>Your <code>.nix</code> configuration largely transfers over</li> <li>Add NixOS-specific modules (boot, filesystems, users)</li> <li>Install NixOS with your existing configuration as a base</li> </ol>"},{"location":"explanation/nixos-comparison/#from-nixos-to-system-manager","title":"From NixOS to System Manager","text":"<p>If you need to configure non-NixOS machines:</p> <ol> <li>Extract the service/package parts of your NixOS config</li> <li>Replace NixOS-specific targets with <code>system-manager.target</code></li> <li>Use System Manager on your non-NixOS machines</li> </ol>"},{"location":"explanation/nixos-comparison/#using-both-together","title":"Using Both Together","text":"<p>You can use NixOS and System Manager in the same infrastructure:</p> <ul> <li>NixOS for servers you control completely</li> <li>System Manager for servers with OS requirements</li> <li>Same configuration patterns and skills for both</li> </ul>"},{"location":"explanation/nixos-comparison/#see-also","title":"See Also","text":"<ul> <li>Introduction - What is System Manager?</li> <li>How System Manager Works - Architecture details</li> <li>Getting Started - Try System Manager</li> </ul>"},{"location":"how-to/deploy-remotely/","title":"How to Deploy to Remote Machines","text":"<p>System Manager can deploy configurations to remote machines via SSH. This guide covers deploying to one or more remote hosts.</p>"},{"location":"how-to/deploy-remotely/#prerequisites","title":"Prerequisites","text":"<ul> <li>SSH access to the target machine</li> <li>Nix installed on the target machine</li> <li>Your SSH key configured for passwordless authentication (recommended)</li> </ul> <p>Before you can deploy to a remote system, the remote machine's Nix daemon needs to trust incoming store paths from your local machine. Without this, the remote will reject the files you're trying to copy because they lack a signature from a trusted cache.</p> <p>Edit <code>/etc/nix/nix.conf</code> on the remote system and ensure these lines are present; you'll need to add the appropriate usernames, such as \"ubuntu\" if you're using an Amazon EC2 Ubuntu server:</p> <pre><code>trusted-users = root ubuntu\nbuild-users-group = nixbld\n</code></pre> <p>Then restart the Nix daemon: <pre><code>sudo systemctl restart nix-daemon\n</code></pre></p>"},{"location":"how-to/deploy-remotely/#basic-remote-deployment","title":"Basic Remote Deployment","text":"<p>Deploy your local configuration to a remote machine:</p> <pre><code>nix run 'github:numtide/system-manager' -- --target-host user@remote-host \\\n  switch \\\n  --flake . \\\n  --sudo\n</code></pre>"},{"location":"how-to/deploy-remotely/#using-a-remote-flake","title":"Using a Remote Flake","text":"<p>Deploy a configuration hosted on GitHub directly to a remote machine:</p> <pre><code>nix run 'github:numtide/system-manager' -- --target-host user@remote-host \\\n  switch \\\n  --flake github:your-username/your-config \\\n  --sudo\n</code></pre>"},{"location":"how-to/deploy-remotely/#using-different-configurations-per-host","title":"Using Different Configurations per Host","text":"<p>If you have different configurations for different hosts, use the flake output name:</p> <pre><code># Deploy the \"webserver\" configuration to web.example.com\nnix run 'github:numtide/system-manager' -- --target-host admin@web.example.com \\\n  switch \\\n  --flake .#webserver \\\n  --sudo\n\n# Deploy the \"database\" configuration to db.example.com\nnix run 'github:numtide/system-manager' -- --target-host admin@db.example.com \\\n  switch \\\n  --flake .#database \\\n  --sudo\n</code></pre>"},{"location":"how-to/deploy-remotely/#ssh-configuration-tips","title":"SSH Configuration Tips","text":"<p>To connect successfully, you have a couple of options for handling SSH authentication.</p>"},{"location":"how-to/deploy-remotely/#option-1-ssh-config-entry","title":"Option 1: SSH Config Entry","text":"<p>For easier deployment, add your hosts to <code>~/.ssh/config</code>:</p> <pre><code>Host webserver\n  HostName web.example.com\n  User admin\n  IdentityFile ~/.ssh/deploy_key\n\nHost dbserver\n  HostName db.example.com\n  User admin\n  IdentityFile ~/.ssh/deploy_key\n</code></pre> <p>Then deploy with just:</p> <pre><code>nix run 'github:numtide/system-manager' -- --target-host webserver \\\nswitch \\\n  --flake . \\\n  --sudo\n</code></pre>"},{"location":"how-to/deploy-remotely/#option-2-ssh-agent","title":"Option 2: SSH Agent","text":"<p>If you prefer not to modify your SSH config, you can load your key into the SSH agent before running System Manager: <pre><code>eval $(ssh-agent -s)\nssh-add /home/ubuntu/.ssh/my.pem\nnix run github:numtide/system-manager -- --target-host 'ubuntu@172.31.40.14' switch --flake . --sudo\n</code></pre></p> <p>This approach is particularly useful for automation scripts, as we'll see in the next section.</p> <p>Unsupported Format</p> <p>You might be tempted to use Nix's query parameter syntax for SSH keys:</p> <p><code>'ubuntu@172.31.40.14?ssh-key=/home/ubuntu/.ssh/my.pem'</code></p> <p>Although Nix supports this format for some operations, System Manager does not. It will attempt to connect to the entire string literally as a hostname, resulting in a \"Could not resolve hostname\" error.</p>"},{"location":"how-to/deploy-remotely/#deploying-to-multiple-systems","title":"Deploying to Multiple Systems","text":"<p>One of the major benefits of System Manager is the ability to manage entire fleets of machines with consistent configurations. Rather than manually connecting to each server, you can script deployments to dozens or even hundreds of systems.</p> <p>Here's a basic example that deploys to multiple systems: <pre><code>#!/bin/bash\nset -e\n\n# Start the SSH agent and add the key\neval $(ssh-agent -s)\nssh-add ~/.ssh/my.pem\n\n# List of target hosts (using private IP addresses in this example)\nHOSTS=(\n    \"ubuntu@172.31.40.14\"\n    \"ubuntu@172.31.28.157\"\n    \"ubuntu@172.31.25.67\"\n)\n\n# Deploy to each host\nfor host in \"${HOSTS[@]}\"; do\n    echo \"Deploying to $host...\"\n    nix run github:numtide/system-manager -- --target-host \"$host\" switch --flake . --sudo\ndone\n\n# Clean up the SSH agent\nssh-agent -k\necho \"Deployment complete!\"\n</code></pre></p>"},{"location":"how-to/deploy-remotely/#reading-hosts-from-a-file","title":"Reading Hosts from a File","text":"<p>For larger deployments, or when you want to separate your host inventory from your scripts, you can read the target addresses from an external file: <pre><code>#!/bin/bash\nset -e\n\neval $(ssh-agent -s)\nssh-add ~/.ssh/my.pem\n\nwhile IFS= read -r host; do\n    [[ -z \"$host\" || \"$host\" =~ ^# ]] &amp;&amp; continue  # Skip empty lines and comments\n    echo \"Deploying to $host...\"\n    nix run github:numtide/system-manager -- --target-host \"$host\" switch --flake . --sudo\ndone &lt; hosts.txt\n\nssh-agent -k\n</code></pre></p> <p>Where <code>hosts.txt</code> looks like: <pre><code># Production servers\nubuntu@172.31.40.14\nubuntu@172.31.40.15\n# Staging\nubuntu@172.31.40.20\n</code></pre></p> <p>This makes it easy to maintain different host lists for different environments, or to generate the list dynamically from your infrastructure tooling.</p>"},{"location":"how-to/deploy-remotely/#handling-ssh-host-key-verification","title":"Handling SSH Host Key Verification","text":"<p>If this is the first time you've connected to the remote systems via SSH, you'll encounter the familiar host key verification prompt: <pre><code>The authenticity of host '172.31.25.67 (172.31.25.67)' can't be established.\nED25519 key fingerprint is SHA256:rfG7uEi06BL+A2qXa+MWRx/k3JCZCyDjfUcpSBQ1zBI.\nAre you sure you want to continue connecting (yes/no/[fingerprint])?\n</code></pre></p> <p>This will interrupt automated scripts. There are some different approaches to handle this.</p>"},{"location":"how-to/deploy-remotely/#approach-1-pre-scan-host-keys","title":"Approach 1: Pre-scan Host Keys","text":"<p>You can scan and add all host keys to your <code>known_hosts</code> file before deploying. This is explicit and works regardless of your SSH configuration: <pre><code>#!/bin/bash\nset -e\n\neval $(ssh-agent -s)\nssh-add ~/.ssh/my.pem\n\n# Target hosts\nHOSTS=(\n    \"ubuntu@172.31.40.14\"\n    \"ubuntu@172.31.28.157\"\n    \"ubuntu@172.31.25.67\"\n)\n\n# Pre-scan and trust all host keys\necho \"Scanning host keys...\"\nfor host in \"${HOSTS[@]}\"; do\n    ip=\"${host#*@}\"  # Extract IP from ubuntu@172.31.x.x\n    ssh-keyscan -H \"$ip\" &gt;&gt; ~/.ssh/known_hosts 2&gt;/dev/null\ndone\necho \"Host keys added to known_hosts\"\n\n# Deploy to each host\nfor host in \"${HOSTS[@]}\"; do\n    echo \"Deploying to $host...\"\n    nix run github:numtide/system-manager -- --target-host \"$host\" switch --flake . --sudo\ndone\n\nssh-agent -k\necho \"Deployment complete!\"\n</code></pre></p>"},{"location":"how-to/deploy-remotely/#approach-2-wildcard-ssh-config","title":"Approach 2: Wildcard SSH Config","text":"<p>If your servers are all within a predictable subnet (common in cloud environments like AWS VPCs), you can use a wildcard pattern in your SSH config to handle authentication and host key verification automatically:</p> <p>Add this to <code>~/.ssh/config</code>: <pre><code>Host 172.31.*\n    User ubuntu\n    IdentityFile ~/.ssh/my.pem\n    StrictHostKeyChecking accept-new\n</code></pre></p> <p>Note</p> <p><code>StrictHostKeyChecking accept-new</code> automatically trusts and saves host keys for servers you've never connected to before, without asking for confirmation. However, it will still warn you if a previously-saved key changes, which could indicate a security issue or a reinstalled server.</p> <p>With this configuration in place, your deployment script becomes much simpler\u2014no agent setup or key scanning required: <pre><code>#!/bin/bash\nset -e\n\n# Target hosts - just the IPs, credentials come from SSH config\nHOSTS=(\n    \"172.31.40.14\"\n    \"172.31.28.157\"\n    \"172.31.25.67\"\n)\n\n# Deploy to each host\nfor host in \"${HOSTS[@]}\"; do\n    echo \"Deploying to $host...\"\n    nix run github:numtide/system-manager -- --target-host \"$host\" switch --flake . --sudo\ndone\n\necho \"Deployment complete!\"\n</code></pre></p> <p>Tip</p> <p>The pre-scanning approach works well if you want to keep everything in a single self-contained script, which is ideal for CI/CD pipelines and automation systems where you may not have control over the SSH config.</p>"},{"location":"how-to/deploy-remotely/#deploying-from-a-remote-flake","title":"Deploying from a Remote Flake","text":"<p>So far, all examples have used <code>--flake .</code> to reference configuration files on your local machine. But you can also host your Nix configuration in a remote Git repository and deploy directly from there. This is powerful for CI/CD workflows where the configuration lives in version control and deployments are triggered automatically.</p> <p>Simply replace the <code>.</code> with a flake URL pointing to your repository: <pre><code>#!/bin/bash\nset -e\n\neval $(ssh-agent -s)\nssh-add ~/.ssh/my.pem\n\n# Target hosts\nHOSTS=(\n    \"ubuntu@172.31.40.14\"\n    \"ubuntu@172.31.28.157\"\n    \"ubuntu@172.31.25.67\"\n)\n\n# Pre-scan and trust all host keys\necho \"Scanning host keys...\"\nfor host in \"${HOSTS[@]}\"; do\n    ip=\"${host#*@}\"  # Extract IP from ubuntu@172.31.x.x\n    ssh-keyscan -H \"$ip\" &gt;&gt; ~/.ssh/known_hosts 2&gt;/dev/null\ndone\necho \"Host keys added to known_hosts\"\n\n# Deploy to each host from a remote flake\nfor host in \"${HOSTS[@]}\"; do\n    echo \"Deploying to $host...\"\n    nix run github:numtide/system-manager -- --target-host \"$host\" switch --flake git+https://github.com/numtide/system-manager-test#default --sudo\ndone\n\nssh-agent -k\necho \"Deployment complete!\"\n</code></pre></p> <p>Keep Your Flake Lock Updated</p> <p>When using remote flakes, make sure the repository's <code>flake.lock</code> file references a compatible version of System Manager. If the lock file points to an older version, you may encounter errors about missing binaries like <code>system-manager-engine</code>. Run <code>nix flake update</code> in your repository to update the lock file to the latest version.</p>"},{"location":"how-to/deploy-remotely/#see-also","title":"See Also","text":"<ul> <li>Use Remote Flakes - Host your configuration on GitHub</li> <li>CLI Reference - Full command documentation</li> </ul>"},{"location":"how-to/install/","title":"Installation","text":""},{"location":"how-to/install/#requirements","title":"Requirements","text":"<p>To use System Manager, you need:</p> <ul> <li>A Linux machine. We've tested System Manager with Ubuntu both as standalone and under Windows Subsystem for Linux (WSL).</li> <li>At least 12GB Disk Space. However, we recommend at least 16GB, as you will be very tight for space with under 16GB. (This is primarily due to Nix; if you're using System Manager to configure, for example, small servers on the Cloud, 8GB simply won't be enough.)</li> <li>Nix installed system-wide with flakes enabled. (System Manager doesn't work with a per-user installation of Nix)</li> </ul> <p>Warning</p> <p>Rollback functionality is not yet fully implemented. While you can list and switch between generations manually, automatic rollback on failure is not available. Always test configuration changes in a VM or non-production environment first.</p>"},{"location":"how-to/install/#installing-nix","title":"Installing Nix","text":"<p>If you don't have Nix installed yet, you have two options:</p>"},{"location":"how-to/install/#option-1-official-nix-installer-recommended","title":"Option 1: Official Nix Installer (Recommended)","text":"<p>Use the official multi-user installer:</p> <pre><code>sh &lt;(curl -L https://nixos.org/nix/install) --daemon\n</code></pre> <p>After installation, open a new terminal or source the profile:</p> <pre><code>. /nix/var/nix/profiles/default/etc/profile.d/nix-daemon.sh\n</code></pre> <p>Verify the installation:</p> <pre><code>nix --version\n</code></pre>"},{"location":"how-to/install/#option-2-determinate-systems-installer","title":"Option 2: Determinate Systems Installer","text":"<p>The Determinate Systems installer is a wrapper around the official installer with SELinux support and flakes enabled by default.</p> <p>Warning</p> <p>The Determinate Systems installer offers both official Nix and their own variant (Determinate Nix). When prompted, choose official Nix. System Manager is not tested against Determinate Nix.</p>"},{"location":"how-to/install/#enabling-flakes","title":"Enabling Flakes","text":"<p>The official installer does not enable flakes by default. Add this line to <code>/etc/nix/nix.conf</code>:</p> <pre><code>experimental-features = nix-command flakes\n</code></pre> <p>Alternatively, you can pass the <code>--extra-experimental-features</code> option to each <code>nix</code> command, but this is less convenient.</p> <p>Tip</p> <p>For other installation options (platform-specific guides, CI/CD environments), see nix-install.com.</p>"},{"location":"how-to/install/#checking-your-installation","title":"Checking Your Installation","text":"<p>To check if Nix is installed system-wide (required for System Manager), run:</p> <pre><code>which nix\n</code></pre> <p>If the output shows a path in your home directory (e.g., <code>/home/username/.nix-profile/bin/nix</code>), Nix is installed per-user and won't work with System Manager. A system-wide installation shows <code>/nix/var/nix/profiles/default/bin/nix</code>.</p>"},{"location":"how-to/install/#running-system-manager","title":"Running System Manager","text":"<p>Because Nix can load code (called \"flakes\") remotely, you don't need to download or install System Manager. Simply running it the first time will automatically fetch it into the Nix Store (<code>/nix/store</code>).</p> <p>To get started, run:</p> <pre><code>nix run 'github:numtide/system-manager' -- init\n</code></pre> <p>This will create initial configuration files in <code>~/.config/system-manager/</code>. See Getting Started for a complete walkthrough.</p>"},{"location":"how-to/install/#optional-installing-system-manager-locally","title":"Optional: Installing System Manager Locally","text":"<p>Nix allows you to run code that's stored remotely in a repo, such as in GitHub. As such, you don't have to install System Manager locally to use it. However, if you want to install locally, you can do so with the following <code>nix profile</code> command:</p> <pre><code>nix profile add 'github:numtide/system-manager'\n</code></pre> <p>Or, if you don't have the experimental features set in <code>/etc/nix/nix.conf</code>, you can provide them through the command line:</p> <pre><code>nix profile add 'github:numtide/system-manager' --extra-experimental-features 'nix-command flakes'\n</code></pre> <p>Tip</p> <p>After System Manager is installed locally, you no longer need to worry about whether you have experimental features enabled. You will simply pass the <code>--flake</code> option to System Manager.</p> <p>When you install System Manager, you might get some warnings about trusted user; this simply means you're not in the trusted user list of Nix. But System Manager will still install and work fine.</p> <p>Then you can find System Manager:</p> <pre><code>$ which system-manager\n/home/ubuntu/.nix-profile/bin/system-manager\n</code></pre> <p>And you can run System Manager:</p> <pre><code>system-manager switch --flake . --sudo\n</code></pre> <p>Tip</p> <p>System Manager is still in early development. Installing locally will not immediately pick up new changes. If you decide to install locally, periodically check the GitHub repo for changes and upgrade using <code>nix profile upgrade</code>.</p>"},{"location":"how-to/install/#installing-on-nixos","title":"Installing on NixOS","text":"<p>If you're on NixOS and want to install the <code>system-manager</code> CLI as a system package, add it to your NixOS configuration:</p> <pre><code># flake.nix\n{\n  inputs = {\n    nixpkgs.url = \"github:NixOS/nixpkgs/nixos-unstable\";\n    system-manager = {\n      url = \"github:numtide/system-manager\";\n      inputs.nixpkgs.follows = \"nixpkgs\";\n    };\n  };\n\n  outputs = { self, nixpkgs, system-manager, ... }:\n    let\n      system = \"x86_64-linux\";\n    in {\n      nixosConfigurations.myhost = nixpkgs.lib.nixosSystem {\n        inherit system;\n        modules = [\n          ({ config, ... }: {\n            environment.systemPackages = [\n              system-manager.packages.${system}.system-manager\n            ];\n          })\n        ];\n      };\n    };\n}\n</code></pre> <p>Then rebuild:</p> <pre><code>sudo nixos-rebuild switch --flake .#myhost\n</code></pre>"},{"location":"how-to/install/#version-compatibility","title":"Version Compatibility","text":"<p>Occasionally, the nixpkgs version may be incompatible with the <code>main</code> branch of System Manager. If you encounter build errors, you may need to pin to a specific commit.</p>"},{"location":"how-to/install/#pinning-to-a-specific-version","title":"Pinning to a Specific Version","text":"<p>For older nixpkgs versions (e.g., 24.05), you may need to pin System Manager to a compatible commit:</p> <pre><code>{\n  inputs = {\n    nixpkgs.url = \"github:NixOS/nixpkgs/24.05\";\n    system-manager = {\n      type = \"github\";\n      owner = \"numtide\";\n      repo = \"system-manager\";\n      ref = \"64627568a52fd5f4d24ecb504cb33a51ffec086d\";\n      inputs.nixpkgs.follows = \"nixpkgs\";\n    };\n  };\n}\n</code></pre> <p>See GitHub Issue #207 for updates on release versioning.</p>"},{"location":"how-to/rollback/","title":"How to Rollback Changes","text":"<p>System Manager keeps track of previous configurations as \"generations.\" If something goes wrong after applying a new configuration, you can rollback to a previous working state.</p>"},{"location":"how-to/rollback/#list-available-generations","title":"List Available Generations","text":"<p>See all available generations:</p> <pre><code>sudo nix-env --profile /nix/var/nix/profiles/system-manager-profiles --list-generations\n</code></pre>"},{"location":"how-to/rollback/#rollback-to-the-previous-generation","title":"Rollback to the Previous Generation","text":"<p>Quickly revert to the last working configuration:</p> <pre><code># Switch to the previous generation\nsudo nix-env --profile /nix/var/nix/profiles/system-manager-profiles --rollback\n\n# Activate the rollback\nnix run 'github:numtide/system-manager' -- activate --sudo\n</code></pre>"},{"location":"how-to/rollback/#rollback-to-a-specific-generation","title":"Rollback to a Specific Generation","text":"<p>To rollback to a specific generation number:</p> <pre><code># Switch to generation 42\nsudo nix-env --profile /nix/var/nix/profiles/system-manager-profiles --switch-generation 42\n\n# Activate it\nnix run 'github:numtide/system-manager' -- activate --sudo\n</code></pre>"},{"location":"how-to/rollback/#cleaning-up-old-generations","title":"Cleaning Up Old Generations","text":"<p>Over time, old generations consume disk space. Remove them with:</p> <pre><code># Remove all old generations (keeps current)\nsudo nix-env --profile /nix/var/nix/profiles/system-manager-profiles --delete-generations old\n\n# Run garbage collection to reclaim space\nsudo nix-collect-garbage -d\n</code></pre>"},{"location":"how-to/rollback/#keeping-recent-generations","title":"Keeping Recent Generations","text":"<p>To keep the last N generations instead of deleting all old ones, use <code>+N</code>. For example, to keep the last 5 generations:</p> <pre><code>sudo nix-env --profile /nix/var/nix/profiles/system-manager-profiles --delete-generations +5\n</code></pre>"},{"location":"how-to/rollback/#see-also","title":"See Also","text":"<ul> <li>Getting Started - Initial setup</li> <li>CLI Reference - Full command documentation</li> </ul>"},{"location":"how-to/test-configuration/","title":"Test your configuration","text":"<p>system-manager provides a container-based test framework that lets you verify your configuration works correctly before deploying it to real systems. The test framework runs inside the Nix build sandbox using systemd-nspawn containers, providing a fast and reproducible testing environment.</p>"},{"location":"how-to/test-configuration/#prerequisites","title":"Prerequisites","text":"<p>Your Nix installation must have <code>auto-allocate-uids</code> enabled for the <code>uid-range</code> sandbox feature. Add this to your Nix configuration (typically <code>/etc/nix/nix.conf</code> or <code>~/.config/nix/nix.conf</code>):</p> <pre><code>auto-allocate-uids = true\n</code></pre>"},{"location":"how-to/test-configuration/#quick-start","title":"Quick start","text":"<p>Add a container test to your project's <code>flake.nix</code>:</p> <pre><code>{\n  inputs = {\n    nixpkgs.url = \"github:NixOS/nixpkgs/nixos-unstable\";\n    system-manager.url = \"github:numtide/system-manager\";\n  };\n\n  outputs = { self, nixpkgs, system-manager, ... }:\n    let\n      system = \"x86_64-linux\";\n      pkgs = nixpkgs.legacyPackages.${system};\n    in\n    {\n      # Your system-manager configuration\n      systemConfigs.default = system-manager.lib.makeSystemConfig {\n        modules = [ ./config.nix ];\n      };\n\n      # Container test\n      checks.${system}.config-test =\n        system-manager.lib.containerTest.makeContainerTest {\n          hostPkgs = pkgs;\n          name = \"my-config\";\n          toplevel = self.systemConfigs.default;\n          testScript = ''\n            start_all()\n            machine.wait_for_unit(\"multi-user.target\")\n            machine.activate()\n            machine.wait_for_unit(\"system-manager.target\")\n\n            # Verify your services\n            machine.succeed(\"systemctl is-active nginx\")\n            machine.succeed(\"curl -f http://localhost\")\n          '';\n        };\n    };\n}\n</code></pre> <p>Run the test:</p> <pre><code>nix flake check -L\n# or specifically:\nnix build .#checks.x86_64-linux.config-test -L\n</code></pre>"},{"location":"how-to/test-configuration/#test-script-api","title":"Test script API","text":"<p>The test script is Python code with access to a <code>machine</code> object. The API is designed to be compatible with NixOS VM tests and includes testinfra integration for expressive assertions.</p>"},{"location":"how-to/test-configuration/#available-symbols","title":"Available symbols","text":"<p>The test script has access to these symbols:</p> Symbol Description <code>start_all()</code> Start all containers (required at script start) <code>subtest(name)</code> Context manager to group related assertions with timing <code>machine</code> The container machine (when exactly one container) <code>machines</code> List of all machine objects <code>driver</code> The Driver instance <code>Machine</code> Machine class for type hints"},{"location":"how-to/test-configuration/#machine-methods","title":"Machine methods","text":"Method Description <code>machine.activate()</code> Activate system-manager profile and display output <code>machine.succeed(cmd)</code> Run command, fail test if exit code != 0 <code>machine.fail(cmd)</code> Run command, fail test if exit code == 0 <code>machine.wait_for_unit(unit)</code> Wait for systemd unit to be active <code>machine.wait_for_file(path)</code> Wait for file to exist <code>machine.wait_for_open_port(port)</code> Wait for TCP port to be listening <code>machine.wait_until_succeeds(cmd)</code> Retry command until it succeeds <code>machine.execute(cmd)</code> Run command, return result (does not fail test) <code>machine.systemctl(args)</code> Run systemctl with given arguments"},{"location":"how-to/test-configuration/#testinfra-assertions","title":"Testinfra assertions","text":"<p>The <code>machine</code> object provides testinfra assertions for declarative checks on services, files, and users. The testinfra API is well-documented at https://testinfra.readthedocs.io/en/latest/modules.html. These are more readable and provide better error messages than shell commands.</p> <p>Service checks:</p> <pre><code>assert machine.service(\"nginx\").is_running\nassert machine.service(\"nginx\").is_enabled\n</code></pre> <p>File checks:</p> <pre><code># Existence and type\nassert machine.file(\"/etc/foo.conf\").exists\nassert machine.file(\"/etc/foo.conf\").is_file\nassert machine.file(\"/etc/baz\").is_directory\nassert machine.file(\"/etc/link\").is_symlink\n\n# Content\nassert machine.file(\"/etc/foo.conf\").contains(\"expected=value\")\n\n# Ownership (by uid/gid)\nassert machine.file(\"/etc/foo.conf\").uid == 0\nassert machine.file(\"/etc/foo.conf\").gid == 0\n\n# Ownership (by name)\nassert machine.file(\"/etc/foo.conf\").user == \"root\"\nassert machine.file(\"/etc/foo.conf\").group == \"root\"\n</code></pre> <p>User checks:</p> <pre><code>assert machine.user(\"myuser\").exists\n</code></pre>"},{"location":"how-to/test-configuration/#grouping-tests-with-subtest","title":"Grouping tests with subtest","text":"<p>Use the <code>subtest</code> context manager to group related assertions. Each subtest logs timing information and provides clear output when tests fail.</p> <pre><code>with subtest(\"Verify nginx is configured\"):\n    assert machine.service(\"nginx\").is_running\n    assert machine.file(\"/etc/nginx/nginx.conf\").exists\n\nwith subtest(\"Verify application files\"):\n    assert machine.file(\"/var/www/index.html\").exists\n    assert machine.file(\"/var/www/index.html\").contains(\"Welcome\")\n</code></pre> <p>Output shows each subtest name with timing:</p> <pre><code>Test \"Verify nginx is configured\" (0.5s)\nTest \"Verify application files\" (0.3s)\n</code></pre>"},{"location":"how-to/test-configuration/#example-test-script","title":"Example test script","text":"<pre><code>start_all()\n\n# Wait for Ubuntu systemd to be ready\nmachine.wait_for_unit(\"multi-user.target\")\n\n# Activate system-manager configuration (displays full activation output)\nmachine.activate()\nmachine.wait_for_unit(\"system-manager.target\")\n\nwith subtest(\"Verify services are running\"):\n    assert machine.service(\"nginx\").is_running\n    assert machine.service(\"my-service\").is_enabled\n\nwith subtest(\"Verify configuration files\"):\n    config = machine.file(\"/etc/my-config.conf\")\n    assert config.exists\n    assert config.is_file\n    assert config.contains(\"expected_value\")\n    assert config.user == \"root\"\n\nwith subtest(\"Verify packages are in PATH\"):\n    machine.succeed(\"bash --login -c 'which my-tool'\")\n\nwith subtest(\"Verify service is responding\"):\n    machine.wait_for_open_port(8080)\n    machine.succeed(\"curl -f http://localhost:8080/health\")\n</code></pre>"},{"location":"how-to/test-configuration/#how-it-works","title":"How it works","text":"<p>The test framework:</p> <ol> <li>Builds an Ubuntu 24.04 container image with the nix-installer binary included</li> <li>Starts the container using systemd-nspawn within the Nix build sandbox</li> <li>Installs Nix via nix-installer at container startup (multi-user mode with daemon)</li> <li>Copies your system-manager profile closure into the container via <code>nix copy</code></li> <li>Executes your test script</li> </ol> <p>This provides a realistic testing environment that matches how system-manager is deployed on non-NixOS systems.</p>"},{"location":"how-to/test-configuration/#test-script-validation","title":"Test script validation","text":"<p>Test scripts are automatically validated before execution to catch errors early.</p> <p>Type checking with mypy: Validates that your test script uses the API correctly. Type hints are automatically prepended so symbols like <code>machine</code>, <code>subtest</code>, and <code>start_all</code> are recognized.</p> <p>Linting with pyflakes: Catches undefined variables and other common mistakes. The test framework symbols are automatically registered as builtins.</p> <p>Both checks run during the build before the container starts. If either fails, you see the error immediately without waiting for container setup.</p> <p>To disable validation when needed:</p> <pre><code>system-manager.lib.containerTest.makeContainerTest {\n  hostPkgs = pkgs;\n  name = \"my-config\";\n  toplevel = self.systemConfigs.default;\n  skipTypeCheck = true;  # Disable mypy\n  skipLint = true;       # Disable pyflakes\n  testScript = ''\n    # ...\n  '';\n};\n</code></pre>"},{"location":"how-to/test-configuration/#debugging-failed-tests","title":"Debugging failed tests","text":"<p>If a test fails, the output will show:</p> <ul> <li>Which command failed</li> <li>Exit code and stdout/stderr</li> <li>Full system-manager activation output</li> </ul>"},{"location":"how-to/test-configuration/#interactive-debugging","title":"Interactive debugging","text":"<p>For interactive debugging, build the test driver and run it with <code>--interactive</code>:</p> <pre><code># Build the driver\nnix build .#checks.x86_64-linux.config-test.driver\n\n# Run interactively (requires root for systemd-nspawn)\nsudo ./result/bin/run-container-test --interactive\n</code></pre> <p>This starts the container and drops you into a Python REPL where you can run commands:</p> <pre><code>&gt;&gt;&gt; machine.succeed(\"systemctl status nginx\")\n&gt;&gt;&gt; machine.execute(\"journalctl -u nginx --no-pager\")\n&gt;&gt;&gt; machine.activate()\n&gt;&gt;&gt; machine.wait_for_unit(\"system-manager.target\")\n</code></pre> <p>Press Ctrl+D to exit and stop the container.</p> <p>To enter the container shell directly, you can use <code>nsenter</code>. The command using <code>nsenter</code> is printed in the test output.</p>"},{"location":"how-to/test-configuration/#comparison-with-vm-tests","title":"Comparison with VM tests","text":"<p>The container test driver complements the existing VM tests:</p> Aspect Container tests VM tests Speed Fast (no QEMU) Slower (full VM) Isolation systemd-nspawn QEMU VM Requirements <code>uid-range</code> feature KVM support Kernel Shared with host Full kernel Use case Integration testing System-level testing <p>Container tests are ideal for validating that your configuration activates correctly and services start as expected. VM tests are better suited for testing kernel-dependent features or scenarios requiring full system isolation.</p>"},{"location":"how-to/use-blueprint/","title":"Blueprint","text":"<p>Blueprint is an opinionated library that maps a standard folder structure to flake outputs, allowing you to divide up your flake into individual files across these folders. This allows you to modularize and isolate these files so that they can be maintained individually and even shared across multiple projects.</p> <p>Blueprint has built-in support for System Manager, which means:</p> <ul> <li>You do not need to call <code>system-manager.lib.makeSystemConfig</code>; Blueprint calls this for you</li> <li>You must follow Blueprint's folder structure by placing your files under the <code>hosts</code> folder, and you must name your files <code>system-configuration.nix</code>.</li> <li>You can have multiple folders under the <code>hosts</code> folder (but one level deep), and you can access these using the standard nix specifier, e.g. <code>.#folder-name</code>.</li> </ul> <p>In this section we show you how to use Blueprint with System Manager.</p> <p>Blueprint provides its own initialization that you can start with if you don't already have a <code>flake.nix</code> file using Blueprint. The command to type is:</p> <pre><code>nix flake init -t github:numtide/blueprint\n</code></pre> <p>This results in the following flake:</p> <pre><code>{\n  description = \"Simple flake with a devshell\";\n\n  # Add all your dependencies here\n  inputs = {\n    nixpkgs.url = \"github:NixOS/nixpkgs?ref=nixos-unstable\";\n    blueprint.url = \"github:numtide/blueprint\";\n    blueprint.inputs.nixpkgs.follows = \"nixpkgs\";\n  };\n\n  # Load the blueprint\n  outputs = inputs: inputs.blueprint { inherit inputs; };\n}\n</code></pre> <p>Now add System Manager to its inputs section:</p> <pre><code>    system-manager = {\n        url = \"github:numtide/system-manager\";\n        inputs.nixpkgs.follows = \"nixpkgs\";\n    };\n</code></pre> <p>Next, create a folder called <code>hosts</code>, and under that a folder called <code>default</code>:</p> <pre><code>mkdir -p hosts/default\ncd hosts/default\n</code></pre> <p>Inside <code>default</code> is where you'll put your configuration file.</p> <p>This configuration file must be named <code>system-configuration.nix</code>.</p> <p>For example, here's a configuration file that installs <code>bat</code>:</p> <pre><code>{ lib, pkgs, ... }:\n{\n  config = {\n    nixpkgs.hostPlatform = \"x86_64-linux\";\n    environment = {\n      # Packages that should be installed on a system\n      systemPackages = [\n        pkgs.bat\n      ];\n    };\n  };\n}\n</code></pre> <p>Note</p> <p>Notice that we need to include <code>nixpkgs.hostPlatform</code> in this file, as there's no place to include it in the parent <code>flake.nix</code> file.</p> <p>Now return to the folder two levels up (the one containing <code>flake.nix</code>) and you can run System Manager:</p> <pre><code>nix run 'github:numtide/system-manager' -- switch --flake . --sudo\n</code></pre> <p>Remember</p> <p>As mentioned elsewhere, if this is the first time running System Manager on this computer, you'll need to log out and log back in to pick up the new path.</p> <p>Then you should find <code>bat</code> on your path:</p> <pre><code>$ which bat\n/run/system-manager/sw/bin//bat\n</code></pre> <p>The default folder is called <code>default</code>; you can also refer to folders by name as mentioned earlier.</p> <p>If, for example, under the <code>hosts</code> folder you have a folder called <code>tree</code>, and inside <code>tree</code> you create a file called <code>system-configuration.nix</code> with the following contents:</p> <pre><code>{ lib, pkgs, ... }:\n{\n  config = {\n    nixpkgs.hostPlatform = \"x86_64-linux\";\n    environment = {\n      # Packages that should be installed on a system\n      systemPackages = [\n        pkgs.tree\n      ];\n    };\n  };\n}\n</code></pre> <p>Then you can choose to install <code>tree</code> by specifying the <code>tree</code> folder like so:</p> <pre><code>nix run 'github:numtide/system-manager' -- switch --flake '.#tree' --sudo\n</code></pre>"},{"location":"how-to/use-blueprint/#using-multiple-configuration-files-with-blueprint","title":"Using multiple configuration files with Blueprint","text":"<p>If you want to load multiple configuration files at once, you can create a special <code>system-configuration.nix</code> file that loads multiple files from a <code>modules</code> folder (or any name you choose). To accomplish this, create a folder under <code>hosts</code>; for example, you might name it <code>cli-tools</code>. Starting in the folder with <code>flake.nix</code>:</p> <pre><code>mkdir -p hosts/cli-tools/modules\n</code></pre> <p>Then, inside the <code>cli-tools</code> folder, create a <code>system-configuration.nix</code> file with the following:</p> <pre><code>{ config, lib, pkgs, ... }:\n{\n  # Import all your modular configs - they auto-merge!\n  imports = [\n    ./modules/tldr.nix\n    ./modules/cowsay.nix\n  ];\n\n  # Base configuration that applies to everything\n  config = {\n    nixpkgs.hostPlatform = \"x86_64-linux\";\n  };\n}\n</code></pre> <p>(Notice this time we can put the <code>nixpkgs.hostPlatform</code> in a single place. As such we won't need it in the configuration files.)</p> <p>Now move into the <code>modules</code> folder:</p> <pre><code>cd modules\n</code></pre> <p>And create two files here:</p> <p>tldr.nix:</p> <pre><code>{ lib, pkgs, ... }:\n{\n  config = {\n    environment = {\n      # Packages that should be installed on a system\n      systemPackages = [\n        pkgs.tldr\n      ];\n    };\n  };\n}\n</code></pre> <p>cowsay.nix: <pre><code>{ lib, pkgs, ... }:\n{\n  config = {\n    environment = {\n      # Packages that should be installed on a system\n      systemPackages = [\n        pkgs.cowsay\n      ];\n    };\n  };\n}\n</code></pre></p> <p>Now you can return to the top level where your <code>flake.nix</code> file is and run these two configuration files:</p> <pre><code>nix run 'github:numtide/system-manager' -- switch --flake '.#cli-tools' --sudo\n</code></pre> <p>This means if you want to include various recipes, you can easily do so.</p>"},{"location":"how-to/use-remote-flakes/","title":"Remote Flakes","text":"<p>Instead of saving your System Manager configuration files locally, you can optionally keep them in a remote Git repository, such as on GitHub.</p> <p>Note</p> <p>This is a great option if you plan to use the files on multiple machines.</p> <p>In order to store them on a remote repo, it's imperative that you keep your <code>flake.lock</code> file up to date.</p>"},{"location":"how-to/use-remote-flakes/#whats-a-flakelock-file","title":"What's a <code>flake.lock</code> file?","text":"<p>A <code>flake.lock</code> file is a JSON file that stores the exact versions of all the inputs your flake file depends on, including things like nixpkgs, System Manager itself, and anything else you might import. Instead of pulling the latest version every time you build, the lock file ensures that the same inputs are used consistently across machines and over time. This makes your configuration reproducible, stable, and rollback-friendly. When you do want to update to new versions, you run a command like <code>nix flake update</code>, which refreshes the lock file in a controlled way.</p>"},{"location":"how-to/use-remote-flakes/#setting-up-your-project-for-remote-hosting","title":"Setting up your project for remote hosting","text":"<p>As you create your flake.nix and set up any supporting files, you'll want to test it out thoroughly before pushing it up to a remote repo.</p> <p>For this you have a couple options; one is to test it out on the machine you're currently using. However, we recommend against this, as there might be artifacts on your computer that can interfere with the configuration.</p> <p>Instead, we recommend starting with a fresh machine. One option is to spin up an EC2 instance on AWS; another is to open up a Virtual Box session on your computer.</p> <p>Important</p> <p>You'll need to ensure you have at least 16GB of disk space on the virtual machine. If you go with 8GB, you're going to run out of space.</p> <p>After starting with a fresh machine, install Nix, copy over your <code>flake.nix</code> and supporting files, and test it out. Once you're ready, make sure your <code>flake.lock</code> file is up to date. You can create or update the <code>flake.lock</code> file by typing:</p> <pre><code>nix flake update\n</code></pre> <p>And make sure you've pushed it up to the repo. (If you don't do this step, Nix will try to build a <code>flake.lock</code>, but will be unable to write it to the same location as the other files, and will error out.)</p> <pre><code>nix run 'github:numtide/system-manager' --extra-experimental-features 'nix-command flakes' -- switch --flake git+https://github.com/numtide/system-manager-test#default --sudo\n</code></pre>"},{"location":"how-to/use-remote-flakes/#when-should-you-update-your-flakelock-file","title":"When should you update your <code>flake.lock</code> file?","text":"<p>Generally, you only need to update your <code>flake.lock</code> file when you want newer versions of your inputs (nixpkgs, etc). Updating isn't necessary for daily use; your configuration will continue to work with the locked versions. But you will want to update your <code>flake.lock</code> file in cases such as:</p> <ul> <li>You want newer package versions (e.g. newer <code>btop</code>, etc.)</li> <li>You want security patches</li> <li>You've added new inputs to your flakes (in which case you'll be required to update <code>flake.lock</code>)</li> <li>You're preparing a fresh install and decide this is a good time to upgrade everything</li> </ul> <p>Note</p> <p>System Manager is undergoing continual development and revisions. When you create a flake.lock file, it includes the specific commit (version) of System Manager's GitHub repository. You might run into some compatibility problems as we add new features. If you encounter problems, rebuild your flake.nix file (which you should do periodically anyway.)</p>"},{"location":"how-to/use-remote-flakes/#cant-system-manager-build-flakelock-for-me","title":"Can't System Manager build <code>flake.lock</code> for me?","text":"<p>Yes, but only if the <code>flake.nix</code> file is local to your machine. The problem is System Manager will try to write a <code>flake.lock</code> file in the same location as the <code>flake.nix</code> file, which isn't possible (at this time) with a GitHub repo.</p>"},{"location":"how-to/use-remote-flakes/#ensuring-success","title":"Ensuring success","text":"<p>In order to ensure System Manager retrieves the correct <code>.nix</code> files from your repo, we recommend including either a branch or a tag along with your repo.</p>"},{"location":"how-to/use-remote-flakes/#running-system-manager-with-a-remote-flake","title":"Running System Manager with a remote flake","text":"<p>Tip</p> <p>Before you run this command, we recommend that you nevertheless create a folder to run it from, such as <code>~/.config/system-manager</code>.</p> <p>Once your configuration is pushed to a remote repository with a valid <code>flake.lock</code>, you can apply it directly:</p> <pre><code>nix run 'github:numtide/system-manager' -- switch --flake github:your-username/your-repo --sudo\n</code></pre> <p>You can also specify a branch or tag:</p> <pre><code># Using a specific branch\nnix run 'github:numtide/system-manager' -- switch --flake github:your-username/your-repo/main --sudo\n\n# Using a tag\nnix run 'github:numtide/system-manager' -- switch --flake github:your-username/your-repo?ref=v1.0.0 --sudo\n</code></pre> <p>For private repositories, use the <code>git+ssh</code> protocol:</p> <pre><code>nix run 'github:numtide/system-manager' -- switch --flake git+ssh://git@github.com/your-username/your-repo --sudo\n</code></pre>"},{"location":"reference/","title":"Reference","text":"<p>Technical reference documentation for System Manager. For step-by-step guides, see Tutorials. For task-oriented instructions, see How-to Guides.</p>"},{"location":"reference/#sections","title":"Sections","text":""},{"location":"reference/#cli-commands","title":"CLI Commands","text":"<p>Complete reference for all command-line options and subcommands: <code>init</code>, <code>switch</code>, <code>register</code>, <code>build</code>, <code>deactivate</code>, <code>pre-populate</code>, <code>activate</code>, and <code>sudo</code> integration.</p>"},{"location":"reference/#module-options","title":"Module Options","text":"<p>Reference for all configuration options available in <code>.nix</code> modules:</p> <ul> <li><code>environment.systemPackages</code> - System packages</li> <li><code>environment.etc</code> - Files in <code>/etc</code></li> <li><code>systemd.services</code> - Systemd service definitions</li> <li><code>systemd.tmpfiles</code> - Temporary files and directories</li> <li><code>nix.settings</code> - Nix configuration options</li> </ul>"},{"location":"reference/#configuration-patterns","title":"Configuration Patterns","text":"<p>Project organization patterns, folder structures, and workflows for managing System Manager configurations.</p>"},{"location":"reference/#supported-platforms","title":"Supported Platforms","text":"<p>Platform compatibility matrix, system requirements, and distribution-specific notes.</p>"},{"location":"reference/all-options/","title":"All Module Options","text":"<p>This page contains the complete auto-generated reference for all available module options. For a curated overview of the most commonly used options, see Module Options.</p> <p>Auto-generated</p> <p>This documentation is automatically generated from the Nix module definitions using <code>nixosOptionsDoc</code>.</p>"},{"location":"reference/all-options/#_moduleargs","title":"_module.args","text":"<p>Additional arguments passed to each module in addition to ones like <code>lib</code>, <code>config</code>, and <code>pkgs</code>, <code>modulesPath</code>.</p> <p>This option is also available to all submodules. Submodules do not inherit args from their parent module, nor do they provide args to their parent module or sibling submodules. The sole exception to this is the argument <code>name</code> which is provided by parent modules to a submodule and contains the attribute name the submodule is bound to, or a unique generated name if it is not bound to an attribute.</p> <p>Some arguments are already passed by default, of which the following cannot be changed with this option:</p> <ul> <li> <p><code>lib</code>: The nixpkgs library.</p> </li> <li> <p><code>config</code>: The results of all options after merging the values from all modules together.</p> </li> <li> <p><code>options</code>: The options declared in all modules.</p> </li> <li> <p><code>specialArgs</code>: The <code>specialArgs</code> argument passed to <code>evalModules</code>.</p> </li> <li> <p>All attributes of <code>specialArgs</code></p> </li> </ul> <p>Whereas option values can generally depend on other option values    thanks to laziness, this does not apply to <code>imports</code>, which    must be computed statically before anything else.</p> <p>For this reason, callers of the module system can provide <code>specialArgs</code>    which are available during import resolution.</p> <p>For NixOS, <code>specialArgs</code> includes    <code>modulesPath</code>, which allows you to import    extra modules from the nixpkgs package tree without having to    somehow make the module aware of the location of the    <code>nixpkgs</code> or NixOS directories.</p> <pre><code>{ modulesPath, ... }: {\n  imports = [\n    (modulesPath + \"/profiles/minimal.nix\")\n  ];\n}\n</code></pre> <p>For NixOS, the default value for this option includes at least this argument:</p> <ul> <li><code>pkgs</code>: The nixpkgs package set according to    the <code>nixpkgs.pkgs</code> option.</li> </ul> <p>Type: lazy attribute set of raw value</p> <p>Declared by:  - \\"},{"location":"reference/all-options/#boot","title":"boot","text":"<p>This option has no description.</p> <p>Type: raw value</p> <p>Declared by:  - \\"},{"location":"reference/all-options/#buildetcentries","title":"build.etc.entries","text":"<p>This option has no description.</p> <p>Type: attribute set of raw value</p> <p>Declared by:  - \\"},{"location":"reference/all-options/#buildetcstaticenv","title":"build.etc.staticEnv","text":"<p>This option has no description.</p> <p>Type: package</p> <p>Declared by:  - \\"},{"location":"reference/all-options/#buildscripts","title":"build.scripts","text":"<p>This option has no description.</p> <p>Type: attribute set of package</p> <p>Declared by:  - \\"},{"location":"reference/all-options/#buildservices","title":"build.services","text":"<p>This option has no description.</p> <p>Type: attribute set of raw value</p> <p>Declared by:  - \\"},{"location":"reference/all-options/#buildtoplevel","title":"build.toplevel","text":"<p>This option has no description.</p> <p>Type: path in the Nix store (read only)</p> <p>Declared by:  - \\"},{"location":"reference/all-options/#environmentetc","title":"environment.etc","text":"<p>Set of files that have to be linked in <code>/etc</code>.</p> <p>Type: attribute set of (submodule)</p> <p>Default:</p> <pre><code>{ }\n</code></pre> <p>Example:</p> <pre><code>{ example-configuration-file =\n    { source = \"/nix/store/.../etc/dir/file.conf.example\";\n      mode = \"0440\";\n    };\n  \"default/useradd\".text = \"GROUP=100 ...\";\n}\n</code></pre> <p>Declared by:  - \\"},{"location":"reference/all-options/#environmentetcenable","title":"environment.etc.\\.enable <p>Whether this /etc file should be generated.  This option allows specific /etc files to be disabled.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>true\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#environmentetcgid","title":"environment.etc.\\.gid <p>GID of created file. Only takes effect when the file is copied (that is, the mode is not \u2018symlink\u2019).</p> <p>Type: signed integer</p> <p>Default:</p> <pre><code>0\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#environmentetcgroup","title":"environment.etc.\\.group <p>Group name of created file. Only takes effect when the file is copied (that is, the mode is not \u2018symlink\u2019). Changing this option takes precedence over <code>gid</code>.</p> <p>Type: string</p> <p>Default:</p> <pre><code>\"+0\"\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#environmentetcmode","title":"environment.etc.\\.mode <p>If set to something else than <code>symlink</code>, the file is copied instead of symlinked, with the given file mode.</p> <p>Type: string</p> <p>Default:</p> <pre><code>\"symlink\"\n</code></pre> <p>Example:</p> <pre><code>\"0600\"\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#environmentetcsource","title":"environment.etc.\\.source <p>Path of the source file.</p> <p>Type: absolute path</p> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#environmentetctarget","title":"environment.etc.\\.target <p>Name of symlink (relative to <code>/etc</code>).  Defaults to the attribute name.</p> <p>Type: string</p> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#environmentetctext","title":"environment.etc.\\.text <p>Text of the file.</p> <p>Type: null or strings concatenated with \u201c\\n\u201d</p> <p>Default:</p> <pre><code>null\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#environmentetcuid","title":"environment.etc.\\.uid <p>UID of created file. Only takes effect when the file is copied (that is, the mode is not \u2018symlink\u2019).</p> <p>Type: signed integer</p> <p>Default:</p> <pre><code>0\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#environmentetcuser","title":"environment.etc.\\.user <p>User name of created file. Only takes effect when the file is copied (that is, the mode is not \u2018symlink\u2019). Changing this option takes precedence over <code>uid</code>.</p> <p>Type: string</p> <p>Default:</p> <pre><code>\"+0\"\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#environmentpathstolink","title":"environment.pathsToLink <p>This option has no description.</p> <p>Type: list of string</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#environmentsystempackages","title":"environment.systemPackages <p>This option has no description.</p> <p>Type: list of package</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#metamaintainers","title":"meta.maintainers <p>List of maintainers of each module. This option should be defined at most once per module.</p> <p>The option value is not a list of maintainers, but an attribute set that maps module file names to lists of maintainers.</p> <p>Type: list of (maintainer)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Example:</p> <pre><code>[ lib.maintainers.alice lib.maintainers.bob ]\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/modules/generic/meta-maintainers.nix</p>","text":""},{"location":"reference/all-options/#networkingenableipv6","title":"networking.enableIPv6 <p>Whether to enable IPv6.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>true\n</code></pre> <p>Example:</p> <pre><code>true\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#nixenable","title":"nix.enable <p>Whether to enable Nix. Disabling Nix makes the system hard to modify and the Nix programs and configuration will not be made available by NixOS itself.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>true\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#nixpackage","title":"nix.package <p>This option specifies the Nix package instance to use throughout the system.</p> <p>Type: package</p> <p>Default:</p> <pre><code>pkgs.nix\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#nixcheckallerrors","title":"nix.checkAllErrors <p>If enabled, checks the nix.conf parsing for any kind of error. When disabled, checks only for unknown settings.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>true\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/config/nix.nix</p>","text":""},{"location":"reference/all-options/#nixcheckconfig","title":"nix.checkConfig <p>If enabled, checks that Nix can parse the generated nix.conf.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>true\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/config/nix.nix</p>","text":""},{"location":"reference/all-options/#nixextraoptions","title":"nix.extraOptions <p>Additional text appended to <code>nix.conf</code>.</p> <p>Type: strings concatenated with \u201c\\n\u201d</p> <p>Default:</p> <pre><code>\"\"\n</code></pre> <p>Example:</p> <pre><code>''\n  keep-outputs = true\n  keep-derivations = true\n''\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/config/nix.nix</p>","text":""},{"location":"reference/all-options/#nixsettings","title":"nix.settings <p>Configuration for Nix, see https://nixos.org/manual/nix/stable/command-ref/conf-file.html or <code>nix.conf(5)</code> for available options. The value declared here will be translated directly to the key-value pairs Nix expects.</p> <p>You can use <code>nix-instantiate --eval --strict '&lt;nixpkgs/nixos&gt;' -A config.nix.settings</code> to view the current value. By default it is empty.</p> <p>Nix configurations defined under <code>nix.*</code> will be translated and applied to this option. In addition, configuration specified in <code>nix.extraOptions</code> will be appended verbatim to the resulting config file.</p> <p>Type: open submodule of attribute set of (Nix config atom (null, bool, int, float, str, path or package) or list of (Nix config atom (null, bool, int, float, str, path or package)))</p> <p>Default:</p> <pre><code>{ }\n</code></pre> <p>Example:</p> <pre><code>{\n  use-sandbox = true;\n  show-trace = true;\n\n  sandbox-paths = [ \"/bin/sh=${pkgs.busybox-sandbox-shell.out}/bin/busybox\" ];\n}\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/config/nix.nix</p>","text":""},{"location":"reference/all-options/#nixsettingsallowed-users","title":"nix.settings.allowed-users <p>A list of names of users (separated by whitespace) that are allowed to connect to the Nix daemon. As with <code>nix.settings.trusted-users</code>, you can specify groups by prefixing them with <code>@</code>. Also, you can allow all users by specifying <code>*</code>. The default is <code>*</code>. Note that trusted users are always allowed to connect.</p> <p>Type: list of string</p> <p>Default:</p> <pre><code>[\n  \"*\"\n]\n</code></pre> <p>Example:</p> <pre><code>[\n  \"@wheel\"\n  \"@builders\"\n  \"alice\"\n  \"bob\"\n]\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/config/nix.nix</p>","text":""},{"location":"reference/all-options/#nixsettingsauto-optimise-store","title":"nix.settings.auto-optimise-store <p>If set to true, Nix automatically detects files in the store that have identical contents, and replaces them with hard links to a single copy. This saves disk space. If set to false (the default), you can still run nix-store --optimise to get rid of duplicate files.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>false\n</code></pre> <p>Example:</p> <pre><code>true\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/config/nix.nix</p>","text":""},{"location":"reference/all-options/#nixsettingscores","title":"nix.settings.cores <p>This option defines the maximum number of concurrent tasks during one build. It affects, e.g., -j option for make. The special value 0 means that the builder should use all available CPU cores in the system. Some builds may become non-deterministic with this option; use with care! Packages will only be affected if enableParallelBuilding is set for them.</p> <p>Type: signed integer</p> <p>Default:</p> <pre><code>0\n</code></pre> <p>Example:</p> <pre><code>64\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/config/nix.nix</p>","text":""},{"location":"reference/all-options/#nixsettingsextra-sandbox-paths","title":"nix.settings.extra-sandbox-paths <p>Directories from the host filesystem to be included in the sandbox.</p> <p>Type: list of string</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Example:</p> <pre><code>[\n  \"/dev\"\n  \"/proc\"\n]\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/config/nix.nix</p>","text":""},{"location":"reference/all-options/#nixsettingsmax-jobs","title":"nix.settings.max-jobs <p>This option defines the maximum number of jobs that Nix will try to build in parallel. The default is auto, which means it will use all available logical cores. It is recommend to set it to the total number of logical cores in your system (e.g., 16 for two CPUs with 4 cores each and hyper-threading).</p> <p>Type: signed integer or value \u201cauto\u201d (singular enum)</p> <p>Default:</p> <pre><code>\"auto\"\n</code></pre> <p>Example:</p> <pre><code>64\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/config/nix.nix</p>","text":""},{"location":"reference/all-options/#nixsettingsrequire-sigs","title":"nix.settings.require-sigs <p>If enabled (the default), Nix will only download binaries from binary caches if they are cryptographically signed with any of the keys listed in <code>nix.settings.trusted-public-keys</code>. If disabled, signatures are neither required nor checked, so it\u2019s strongly recommended that you use only trustworthy caches and https to prevent man-in-the-middle attacks.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>true\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/config/nix.nix</p>","text":""},{"location":"reference/all-options/#nixsettingssandbox","title":"nix.settings.sandbox <p>If set, Nix will perform builds in a sandboxed environment that it will set up automatically for each build. This prevents impurities in builds by disallowing access to dependencies outside of the Nix store by using network and mount namespaces in a chroot environment.</p> <p>This is enabled by default even though it has a possible performance impact due to the initial setup time of a sandbox for each build. It doesn\u2019t affect derivation hashes, so changing this option will not trigger a rebuild of packages.</p> <p>When set to \u201crelaxed\u201d, this option permits derivations that set <code>__noChroot = true;</code> to run outside of the sandboxed environment. Exercise caution when using this mode of operation! It is intended to be a quick hack when building with packages that are not easily setup to be built reproducibly.</p> <p>Type: boolean or value \u201crelaxed\u201d (singular enum)</p> <p>Default:</p> <pre><code>true\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/config/nix.nix</p>","text":""},{"location":"reference/all-options/#nixsettingssubstituters","title":"nix.settings.substituters <p>List of binary cache URLs used to obtain pre-built binaries of Nix packages.</p> <p>By default https://cache.nixos.org/ is added.</p> <p>Type: list of string</p> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/config/nix.nix</p>","text":""},{"location":"reference/all-options/#nixsettingssystem-features","title":"nix.settings.system-features <p>The set of features supported by the machine. Derivations can express dependencies on system features through the <code>requiredSystemFeatures</code> attribute.</p> <p>Type: list of string</p> <p>Default:</p> <pre><code>[ \"nixos-test\" \"benchmark\" \"big-parallel\" \"kvm\" \"gccarch-&lt;arch&gt;\" ]\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/config/nix.nix</p>","text":""},{"location":"reference/all-options/#nixsettingstrusted-public-keys","title":"nix.settings.trusted-public-keys <p>List of public keys used to sign binary caches. If <code>nix.settings.trusted-public-keys</code> is enabled, then Nix will use a binary from a binary cache if and only if it is signed by any of the keys listed here. By default, only the key for <code>cache.nixos.org</code> is included.</p> <p>Type: list of string</p> <p>Example:</p> <pre><code>[\n  \"hydra.nixos.org-1:CNHJZBh9K4tP3EKF6FkkgeVYsS3ohTl+oS0Qa8bezVs=\"\n]\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/config/nix.nix</p>","text":""},{"location":"reference/all-options/#nixsettingstrusted-substituters","title":"nix.settings.trusted-substituters <p>List of binary cache URLs that non-root users can use (in addition to those specified using <code>nix.settings.substituters</code>) by passing <code>--option binary-caches</code> to Nix commands.</p> <p>Type: list of string</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Example:</p> <pre><code>[\n  \"https://hydra.nixos.org/\"\n]\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/config/nix.nix</p>","text":""},{"location":"reference/all-options/#nixsettingstrusted-users","title":"nix.settings.trusted-users <p>A list of names of users that have additional rights when connecting to the Nix daemon, such as the ability to specify additional binary caches, or to import unsigned NARs. You can also specify groups by prefixing them with <code>@</code>; for instance, <code>@wheel</code> means all users in the wheel group.</p> <p>Type: list of string</p> <p>Example:</p> <pre><code>[\n  \"root\"\n  \"alice\"\n  \"@wheel\"\n]\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/config/nix.nix</p>","text":""},{"location":"reference/all-options/#nixpkgsbuildplatform","title":"nixpkgs.buildPlatform <p>This option has no description.</p> <p>Type: string</p> <p>Default:</p> <pre><code>\"x86_64-linux\"\n</code></pre> <p>Example:</p> <pre><code>\"x86_64-linux\"\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#nixpkgsconfig","title":"nixpkgs.config <p>Configuration used to instantiate nixpkgs.</p> <p>Type: attribute set</p> <p>Default:</p> <pre><code>{ }\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#nixpkgshostplatform","title":"nixpkgs.hostPlatform <p>The platform for which to build the system configuration.</p> <p>Type: string or (attribute set)</p> <p>Default:</p> <pre><code>\"x86_64-linux\"\n</code></pre> <p>Example:</p> <pre><code>\"x86_64-linux\"\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#nixpkgsoverlays","title":"nixpkgs.overlays <p>This option has no description.</p> <p>Type: list of anything</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#securityacmeacceptterms","title":"security.acme.acceptTerms <p>Accept the CA\u2019s terms of service. The default provider is Let\u2019s Encrypt, you can find their ToS at https://letsencrypt.org/repository/.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>false\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmecerts","title":"security.acme.certs <p>Attribute set of certificates to get signed and renewed. Creates <code>acme-${cert}.{service,timer}</code> systemd units for each certificate defined here. Other services can add dependencies to those units if they rely on the certificates being present, or trigger restarts of the service if certificates get renewed.</p> <p>Type: attribute set of (submodule)</p> <p>Default:</p> <pre><code>{ }\n</code></pre> <p>Example:</p> <pre><code>{\n  \"example.com\" = {\n    webroot = \"/var/lib/acme/acme-challenge/\";\n    email = \"foo@example.com\";\n    extraDomainNames = [ \"www.example.com\" \"foo.example.com\" ];\n  };\n  \"bar.example.com\" = {\n    webroot = \"/var/lib/acme/acme-challenge/\";\n    email = \"bar@example.com\";\n  };\n}\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmecertsenabledebuglogs","title":"security.acme.certs.\\.enableDebugLogs <p>Whether to enable debug logging for this certificate.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>config.security.acme.defaults.enableDebugLogs\n</code></pre> <p>Example:</p> <pre><code>true\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmecertscredentialfiles","title":"security.acme.certs.\\.credentialFiles <p>Environment variables suffixed by \u201c_FILE\u201d to set for the cert\u2019s service for your selected dnsProvider. To find out what values you need to set, consult the documentation at https://go-acme.github.io/lego/dns/ for the corresponding dnsProvider. This allows to securely pass credential files to lego by leveraging systemd credentials.</p> <p>Type: attribute set of absolute path</p> <p>Default:</p> <pre><code>config.security.acme.defaults.credentialFiles\n</code></pre> <p>Example:</p> <pre><code>{\n  \"RFC2136_TSIG_SECRET_FILE\" = \"/run/secrets/tsig-secret-example.org\";\n}\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmecertscsr","title":"security.acme.certs.\\.csr <p>Path to a certificate signing request to apply when fetching the certificate.</p> <p>Type: null or string</p> <p>Default:</p> <pre><code>null\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmecertscsrkey","title":"security.acme.certs.\\.csrKey <p>Path to the private key to the matching certificate signing request.</p> <p>Type: null or string</p> <p>Default:</p> <pre><code>null\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmecertsdirectory","title":"security.acme.certs.\\.directory <p>Directory where certificate and other state is stored.</p> <p>Type: string (read only)</p> <p>Default:</p> <pre><code>\"/var/lib/acme/\u2039name\u203a\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmecertsdnspropagationcheck","title":"security.acme.certs.\\.dnsPropagationCheck <p>Toggles lego DNS propagation check, which is used alongside DNS-01 challenge to ensure the DNS entries required are available.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>config.security.acme.defaults.dnsPropagationCheck\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmecertsdnsprovider","title":"security.acme.certs.\\.dnsProvider <p>DNS Challenge provider. For a list of supported providers, see the \u201ccode\u201d field of the DNS providers listed at https://go-acme.github.io/lego/dns/.</p> <p>Type: null or string</p> <p>Default:</p> <pre><code>config.security.acme.defaults.dnsProvider\n</code></pre> <p>Example:</p> <pre><code>\"route53\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmecertsdnsresolver","title":"security.acme.certs.\\.dnsResolver <p>Set the resolver to use for performing recursive DNS queries. Supported: host:port. The default is to use the system resolvers, or Google\u2019s DNS resolvers if the system\u2019s cannot be determined.</p> <p>Type: null or string</p> <p>Default:</p> <pre><code>config.security.acme.defaults.dnsResolver\n</code></pre> <p>Example:</p> <pre><code>\"1.1.1.1:53\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmecertsdomain","title":"security.acme.certs.\\.domain <p>Domain to fetch certificate for (defaults to the entry name).</p> <p>Type: string</p> <p>Default:</p> <pre><code>\"\u2039name\u203a\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmecertsemail","title":"security.acme.certs.\\.email <p>Email address for account creation and correspondence from the CA. It is recommended to use the same email for all certs to avoid account creation limits.</p> <p>Type: null or string</p> <p>Default:</p> <pre><code>config.security.acme.defaults.email\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmecertsenvironmentfile","title":"security.acme.certs.\\.environmentFile <p>Path to an EnvironmentFile for the cert\u2019s service containing any required and optional environment variables for your selected dnsProvider. To find out what values you need to set, consult the documentation at https://go-acme.github.io/lego/dns/ for the corresponding dnsProvider.</p> <p>Type: null or absolute path</p> <p>Default:</p> <pre><code>config.security.acme.defaults.environmentFile\n</code></pre> <p>Example:</p> <pre><code>\"/var/src/secrets/example.org-route53-api-token\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmecertsextradomainnames","title":"security.acme.certs.\\.extraDomainNames <p>A list of extra domain names, which are included in the one certificate to be issued.</p> <p>Type: list of string</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Example:</p> <pre><code>[\n  \"example.org\"\n  \"mydomain.org\"\n]\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmecertsextralegoflags","title":"security.acme.certs.\\.extraLegoFlags <p>Additional global flags to pass to all lego commands.</p> <p>Type: list of string</p> <p>Default:</p> <pre><code>config.security.acme.defaults.extraLegoFlags\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmecertsextralegorenewflags","title":"security.acme.certs.\\.extraLegoRenewFlags <p>Additional flags to pass to lego renew.</p> <p>Type: list of string</p> <p>Default:</p> <pre><code>config.security.acme.defaults.extraLegoRenewFlags\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmecertsextralegorunflags","title":"security.acme.certs.\\.extraLegoRunFlags <p>Additional flags to pass to lego run.</p> <p>Type: list of string</p> <p>Default:</p> <pre><code>config.security.acme.defaults.extraLegoRunFlags\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmecertsgroup","title":"security.acme.certs.\\.group <p>Group running the ACME client.</p> <p>Type: string</p> <p>Default:</p> <pre><code>config.security.acme.defaults.group\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmecertsinheritdefaults","title":"security.acme.certs.\\.inheritDefaults <p>Whether to inherit values set in <code>security.acme.defaults</code> or not.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>true\n</code></pre> <p>Example:</p> <pre><code>true\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmecertskeytype","title":"security.acme.certs.\\.keyType <p>Key type to use for private keys. For an up to date list of supported values check the --key-type option at https://go-acme.github.io/lego/usage/cli/options/.</p> <p>Type: string</p> <p>Default:</p> <pre><code>config.security.acme.defaults.keyType\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmecertslistenhttp","title":"security.acme.certs.\\.listenHTTP <p>Interface and port to listen on to solve HTTP challenges in the form <code>[INTERFACE]:PORT</code>. If you use a port other than 80, you must proxy port 80 to this port.</p> <p>Type: null or string</p> <p>Default:</p> <pre><code>config.security.acme.defaults.listenHTTP\n</code></pre> <p>Example:</p> <pre><code>\":1360\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmecertsocspmuststaple","title":"security.acme.certs.\\.ocspMustStaple <p>Turns on the OCSP Must-Staple TLS extension. Make sure you know what you\u2019re doing! See:</p> <ul> <li>https://blog.apnic.net/2019/01/15/is-the-web-ready-for-ocsp-must-staple/</li> <li>https://blog.hboeck.de/archives/886-The-Problem-with-OCSP-Stapling-and-Must-Staple-and-why-Certificate-Revocation-is-still-broken.html</li> </ul> <p>Type: boolean</p> <p>Default:</p> <pre><code>config.security.acme.defaults.ocspMustStaple\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmecertspostrun","title":"security.acme.certs.\\.postRun <p>Commands to run after new certificates go live. Note that these commands run as the root user.</p> <p>Executed in the same directory with the new certificate.</p> <p>Type: strings concatenated with \u201c\\n\u201d</p> <p>Default:</p> <pre><code>config.security.acme.defaults.postRun\n</code></pre> <p>Example:</p> <pre><code>\"cp full.pem backup.pem\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmecertsprofile","title":"security.acme.certs.\\.profile <p>The certificate profile to choose if the CA offers multiple profiles.</p> <p>Type: null or string</p> <p>Default:</p> <pre><code>config.security.acme.defaults.profile\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmecertsreloadservices","title":"security.acme.certs.\\.reloadServices <p>The list of systemd services to call <code>systemctl try-reload-or-restart</code> on.</p> <p>Type: list of string</p> <p>Default:</p> <pre><code>config.security.acme.defaults.reloadServices\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmecertsrenewinterval","title":"security.acme.certs.\\.renewInterval <p>Systemd calendar expression when to check for renewal. See <code>systemd.time(7)</code>.</p> <p>Type: string</p> <p>Default:</p> <pre><code>config.security.acme.defaults.renewInterval\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmecertss3bucket","title":"security.acme.certs.\\.s3Bucket <p>S3 bucket name to use for HTTP-01 based challenges. Challenges will be written to the S3 bucket.</p> <p>Type: null or string</p> <p>Default:</p> <pre><code>null\n</code></pre> <p>Example:</p> <pre><code>\"acme\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmecertsserver","title":"security.acme.certs.\\.server <p>ACME Directory Resource URI. Defaults to Let\u2019s Encrypt\u2019s production endpoint. For testing Let\u2019s Encrypt\u2019s staging endpoint should be used to avoid the rather tight rate limit on the production endpoint.</p> <p>Type: null or string</p> <p>Default:</p> <pre><code>config.security.acme.defaults.server\n</code></pre> <p>Example:</p> <pre><code>\"https://acme-staging-v02.api.letsencrypt.org/directory\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmecertsvalidmindays","title":"security.acme.certs.\\.validMinDays <p>Minimum remaining validity before renewal in days.</p> <p>Type: signed integer</p> <p>Default:</p> <pre><code>config.security.acme.defaults.validMinDays\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmecertswebroot","title":"security.acme.certs.\\.webroot <p>Where the webroot of the HTTP vhost is located. <code>.well-known/acme-challenge/</code> directory will be created below the webroot if it doesn\u2019t exist. <code>http://example.org/.well-known/acme-challenge/</code> must also be available (notice unencrypted HTTP).</p> <p>Type: null or string</p> <p>Default:</p> <pre><code>config.security.acme.defaults.webroot\n</code></pre> <p>Example:</p> <pre><code>\"/var/lib/acme/acme-challenge\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmedefaults","title":"security.acme.defaults <p>Default values inheritable by all configured certs. You can use this to define options shared by all your certs. These defaults can also be ignored on a per-cert basis using the <code>security.acme.certs.${cert}.inheritDefaults</code> option.</p> <p>Type: submodule</p> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmedefaultsenabledebuglogs","title":"security.acme.defaults.enableDebugLogs <p>Whether to enable debug logging for this certificate.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>true\n</code></pre> <p>Example:</p> <pre><code>true\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmedefaultscredentialfiles","title":"security.acme.defaults.credentialFiles <p>Environment variables suffixed by \u201c_FILE\u201d to set for the cert\u2019s service for your selected dnsProvider. To find out what values you need to set, consult the documentation at https://go-acme.github.io/lego/dns/ for the corresponding dnsProvider. This allows to securely pass credential files to lego by leveraging systemd credentials.</p> <p>Type: attribute set of absolute path</p> <p>Default:</p> <pre><code>{ }\n</code></pre> <p>Example:</p> <pre><code>{\n  \"RFC2136_TSIG_SECRET_FILE\" = \"/run/secrets/tsig-secret-example.org\";\n}\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmedefaultsdnspropagationcheck","title":"security.acme.defaults.dnsPropagationCheck <p>Toggles lego DNS propagation check, which is used alongside DNS-01 challenge to ensure the DNS entries required are available.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>true\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmedefaultsdnsprovider","title":"security.acme.defaults.dnsProvider <p>DNS Challenge provider. For a list of supported providers, see the \u201ccode\u201d field of the DNS providers listed at https://go-acme.github.io/lego/dns/.</p> <p>Type: null or string</p> <p>Default:</p> <pre><code>null\n</code></pre> <p>Example:</p> <pre><code>\"route53\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmedefaultsdnsresolver","title":"security.acme.defaults.dnsResolver <p>Set the resolver to use for performing recursive DNS queries. Supported: host:port. The default is to use the system resolvers, or Google\u2019s DNS resolvers if the system\u2019s cannot be determined.</p> <p>Type: null or string</p> <p>Default:</p> <pre><code>null\n</code></pre> <p>Example:</p> <pre><code>\"1.1.1.1:53\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmedefaultsemail","title":"security.acme.defaults.email <p>Email address for account creation and correspondence from the CA. It is recommended to use the same email for all certs to avoid account creation limits.</p> <p>Type: null or string</p> <p>Default:</p> <pre><code>null\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmedefaultsenvironmentfile","title":"security.acme.defaults.environmentFile <p>Path to an EnvironmentFile for the cert\u2019s service containing any required and optional environment variables for your selected dnsProvider. To find out what values you need to set, consult the documentation at https://go-acme.github.io/lego/dns/ for the corresponding dnsProvider.</p> <p>Type: null or absolute path</p> <p>Default:</p> <pre><code>null\n</code></pre> <p>Example:</p> <pre><code>\"/var/src/secrets/example.org-route53-api-token\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmedefaultsextralegoflags","title":"security.acme.defaults.extraLegoFlags <p>Additional global flags to pass to all lego commands.</p> <p>Type: list of string</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmedefaultsextralegorenewflags","title":"security.acme.defaults.extraLegoRenewFlags <p>Additional flags to pass to lego renew.</p> <p>Type: list of string</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmedefaultsextralegorunflags","title":"security.acme.defaults.extraLegoRunFlags <p>Additional flags to pass to lego run.</p> <p>Type: list of string</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmedefaultsgroup","title":"security.acme.defaults.group <p>Group running the ACME client.</p> <p>Type: string</p> <p>Default:</p> <pre><code>\"acme\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmedefaultskeytype","title":"security.acme.defaults.keyType <p>Key type to use for private keys. For an up to date list of supported values check the --key-type option at https://go-acme.github.io/lego/usage/cli/options/.</p> <p>Type: string</p> <p>Default:</p> <pre><code>\"ec256\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmedefaultslistenhttp","title":"security.acme.defaults.listenHTTP <p>Interface and port to listen on to solve HTTP challenges in the form <code>[INTERFACE]:PORT</code>. If you use a port other than 80, you must proxy port 80 to this port.</p> <p>Type: null or string</p> <p>Default:</p> <pre><code>null\n</code></pre> <p>Example:</p> <pre><code>\":1360\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmedefaultsocspmuststaple","title":"security.acme.defaults.ocspMustStaple <p>Turns on the OCSP Must-Staple TLS extension. Make sure you know what you\u2019re doing! See:</p> <ul> <li>https://blog.apnic.net/2019/01/15/is-the-web-ready-for-ocsp-must-staple/</li> <li>https://blog.hboeck.de/archives/886-The-Problem-with-OCSP-Stapling-and-Must-Staple-and-why-Certificate-Revocation-is-still-broken.html</li> </ul> <p>Type: boolean</p> <p>Default:</p> <pre><code>false\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmedefaultspostrun","title":"security.acme.defaults.postRun <p>Commands to run after new certificates go live. Note that these commands run as the root user.</p> <p>Executed in the same directory with the new certificate.</p> <p>Type: strings concatenated with \u201c\\n\u201d</p> <p>Default:</p> <pre><code>\"\"\n</code></pre> <p>Example:</p> <pre><code>\"cp full.pem backup.pem\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmedefaultsprofile","title":"security.acme.defaults.profile <p>The certificate profile to choose if the CA offers multiple profiles.</p> <p>Type: null or string</p> <p>Default:</p> <pre><code>null\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmedefaultsreloadservices","title":"security.acme.defaults.reloadServices <p>The list of systemd services to call <code>systemctl try-reload-or-restart</code> on.</p> <p>Type: list of string</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmedefaultsrenewinterval","title":"security.acme.defaults.renewInterval <p>Systemd calendar expression when to check for renewal. See <code>systemd.time(7)</code>.</p> <p>Type: string</p> <p>Default:</p> <pre><code>\"daily\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmedefaultsserver","title":"security.acme.defaults.server <p>ACME Directory Resource URI. Defaults to Let\u2019s Encrypt\u2019s production endpoint. For testing Let\u2019s Encrypt\u2019s staging endpoint should be used to avoid the rather tight rate limit on the production endpoint.</p> <p>Type: null or string</p> <p>Default:</p> <pre><code>\"https://acme-v02.api.letsencrypt.org/directory\"\n</code></pre> <p>Example:</p> <pre><code>\"https://acme-staging-v02.api.letsencrypt.org/directory\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmedefaultsvalidmindays","title":"security.acme.defaults.validMinDays <p>Minimum remaining validity before renewal in days.</p> <p>Type: signed integer</p> <p>Default:</p> <pre><code>30\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmedefaultswebroot","title":"security.acme.defaults.webroot <p>Where the webroot of the HTTP vhost is located. <code>.well-known/acme-challenge/</code> directory will be created below the webroot if it doesn\u2019t exist. <code>http://example.org/.well-known/acme-challenge/</code> must also be available (notice unencrypted HTTP).</p> <p>Type: null or string</p> <p>Default:</p> <pre><code>null\n</code></pre> <p>Example:</p> <pre><code>\"/var/lib/acme/acme-challenge\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmemaxconcurrentrenewals","title":"security.acme.maxConcurrentRenewals <p>Maximum number of concurrent certificate generation or renewal jobs. All other jobs will queue and wait running jobs to finish. Reduces the system load of certificate generation.</p> <p>Set to <code>0</code> to allow unlimited number of concurrent job runs.\"</p> <p>Type: signed integer</p> <p>Default:</p> <pre><code>5\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#securityacmeuseroot","title":"security.acme.useRoot <p>Whether to use the root user when generating certs. This is not recommended for security + compatibility reasons. If a service requires root owned certificates consider following the guide on \u201cUsing ACME with services demanding root owned certificates\u201d in the NixOS manual, and only using this as a fallback or for testing.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>false\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/security/acme/</p>","text":""},{"location":"reference/all-options/#servicesnginxenable","title":"services.nginx.enable <p>Whether to enable Nginx Web Server.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>false\n</code></pre> <p>Example:</p> <pre><code>true\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxenablequicbpf","title":"services.nginx.enableQuicBPF <p>Enables routing of QUIC packets using eBPF. When enabled, this allows to support QUIC connection migration. The directive is only supported on Linux 5.7+. Note that enabling this option will make nginx run with extended capabilities that are usually limited to processes running as root namely <code>CAP_SYS_ADMIN</code> and <code>CAP_NET_ADMIN</code>.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>false\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxenablereload","title":"services.nginx.enableReload <p>Reload nginx when configuration file changes (instead of restart). The configuration file is exposed at <code>/etc/nginx/nginx.conf</code>. See also <code>systemd.services.*.restartIfChanged</code>.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>false\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxpackage","title":"services.nginx.package <p>Nginx package to use. This defaults to the stable version. Note that the nginx team recommends to use the mainline version which available in nixpkgs as <code>nginxMainline</code>. Supported Nginx forks include <code>angie</code>, <code>openresty</code> and <code>tengine</code>.</p> <p>Type: package</p> <p>Default:</p> <pre><code>pkgs.nginxStable\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxadditionalmodules","title":"services.nginx.additionalModules <p>Additional third-party nginx modules to install. Packaged modules are available in <code>pkgs.nginxModules</code>.</p> <p>Type: list of attribute set of anything</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Example:</p> <pre><code>[ pkgs.nginxModules.echo ]\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxappendconfig","title":"services.nginx.appendConfig <p>Configuration lines appended to the generated Nginx configuration file. Commonly used by different modules providing http snippets. <code>appendConfig</code> can be specified more than once and its value will be concatenated (contrary to <code>config</code> which can be set only once).</p> <p>Type: strings concatenated with \u201c\\n\u201d</p> <p>Default:</p> <pre><code>\"\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxappendhttpconfig","title":"services.nginx.appendHttpConfig <p>Configuration lines to be appended to the generated http block. This is mutually exclusive with using config and httpConfig for specifying the whole http block verbatim.</p> <p>Type: strings concatenated with \u201c\\n\u201d</p> <p>Default:</p> <pre><code>\"\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxclientmaxbodysize","title":"services.nginx.clientMaxBodySize <p>Set nginx global client_max_body_size.</p> <p>Type: string</p> <p>Default:</p> <pre><code>\"10m\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxcommonhttpconfig","title":"services.nginx.commonHttpConfig <p>With nginx you must provide common http context definitions before they are used, e.g. log_format, resolver, etc. inside of server or location contexts. Use this attribute to set these definitions at the appropriate location.</p> <p>Type: strings concatenated with \u201c\\n\u201d</p> <p>Default:</p> <pre><code>\"\"\n</code></pre> <p>Example:</p> <pre><code>''\n  resolver 127.0.0.1 valid=5s;\n\n  log_format myformat '$remote_addr - $remote_user [$time_local] '\n                      '\"$request\" $status $body_bytes_sent '\n                      '\"$http_referer\" \"$http_user_agent\"';\n''\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxconfig","title":"services.nginx.config <p>Verbatim <code>nginx.conf</code> configuration. This is mutually exclusive to any other config option for <code>nginx.conf</code> except for</p>  <p>If additional verbatim config in addition to other options is needed,  should be used instead.</p> <p>Type: string</p> <p>Default:</p> <pre><code>\"\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxdefaulthttplistenport","title":"services.nginx.defaultHTTPListenPort <p>If vhosts do not specify listen.port, use these ports for HTTP by default.</p> <p>Type: 16 bit unsigned integer; between 0 and 65535 (both inclusive)</p> <p>Default:</p> <pre><code>80\n</code></pre> <p>Example:</p> <pre><code>8080\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxdefaultlisten","title":"services.nginx.defaultListen <p>If vhosts do not specify listen, use these addresses by default. This option takes precedence over <code>defaultListenAddresses</code> and other listen-related defaults options.</p> <p>Type: list of (submodule)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Example:</p> <pre><code>[\n  { addr = \"10.0.0.12\"; proxyProtocol = true; ssl = true; }\n  { addr = \"0.0.0.0\"; }\n  { addr = \"[::0]\"; }\n]\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxdefaultlistenaddr","title":"services.nginx.defaultListen.*.addr <p>IP address.</p> <p>Type: string</p> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxdefaultlistenextraparameters","title":"services.nginx.defaultListen.*.extraParameters <p>Extra parameters of this listen directive.</p> <p>Type: list of string</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Example:</p> <pre><code>[\n  \"backlog=1024\"\n  \"deferred\"\n]\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxdefaultlistenport","title":"services.nginx.defaultListen.*.port <p>Port number.</p> <p>Type: null or 16 bit unsigned integer; between 0 and 65535 (both inclusive)</p> <p>Default:</p> <pre><code>null\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxdefaultlistenproxyprotocol","title":"services.nginx.defaultListen.*.proxyProtocol <p>Enable PROXY protocol.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>false\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxdefaultlistenssl","title":"services.nginx.defaultListen.*.ssl <p>Enable SSL.</p> <p>Type: null or boolean</p> <p>Default:</p> <pre><code>null\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxdefaultlistenaddresses","title":"services.nginx.defaultListenAddresses <p>If vhosts do not specify listenAddresses, use these addresses by default. This is akin to writing <code>defaultListen = [ { addr = \"0.0.0.0\" } ]</code>.</p> <p>Type: list of string</p> <p>Default:</p> <pre><code>[ \"0.0.0.0\" ] ++ lib.optional config.networking.enableIPv6 \"[::0]\"\n</code></pre> <p>Example:</p> <pre><code>[ \"10.0.0.12\" \"[2002:a00:1::]\" ]\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxdefaultmimetypes","title":"services.nginx.defaultMimeTypes <p>Default MIME types for NGINX, as MIME types definitions from NGINX are very incomplete, we use by default the ones bundled in the mailcap package, used by most of the other Linux distributions.</p> <p>Type: absolute path</p> <p>Default:</p> <pre><code>$''{pkgs.mailcap}/etc/nginx/mime.types\n</code></pre> <p>Example:</p> <pre><code>$''{pkgs.nginx}/conf/mime.types\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxdefaultssllistenport","title":"services.nginx.defaultSSLListenPort <p>If vhosts do not specify listen.port, use these ports for SSL by default.</p> <p>Type: 16 bit unsigned integer; between 0 and 65535 (both inclusive)</p> <p>Default:</p> <pre><code>443\n</code></pre> <p>Example:</p> <pre><code>8443\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxeventsconfig","title":"services.nginx.eventsConfig <p>Configuration lines to be set inside the events block.</p> <p>Type: strings concatenated with \u201c\\n\u201d</p> <p>Default:</p> <pre><code>\"\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxexperimentalzstdsettings","title":"services.nginx.experimentalZstdSettings <p>Enable alpha quality zstd module with recommended settings. Learn more about compression in Zstd format here.</p> <p>This adds <code>pkgs.nginxModules.zstd</code> to <code>services.nginx.additionalModules</code>.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>false\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxgroup","title":"services.nginx.group <p>Group account under which nginx runs.</p> <p>Type: string</p> <p>Default:</p> <pre><code>\"nginx\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxhttpconfig","title":"services.nginx.httpConfig <p>Configuration lines to be set inside the http block. This is mutually exclusive with the structured configuration via virtualHosts and the recommendedXyzSettings configuration options. See appendHttpConfig for appending to the generated http block.</p> <p>Type: strings concatenated with \u201c\\n\u201d</p> <p>Default:</p> <pre><code>\"\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxlogerror","title":"services.nginx.logError <p>Configures logging. The first parameter defines a file that will store the log. The special value stderr selects the standard error file. Logging to syslog can be configured by specifying the \u201csyslog:\u201d prefix. The second parameter determines the level of logging, and can be one of the following: debug, info, notice, warn, error, crit, alert, or emerg. Log levels above are listed in the order of increasing severity. Setting a certain log level will cause all messages of the specified and more severe log levels to be logged. If this parameter is omitted then error is used.</p> <p>Type: string</p> <p>Default:</p> <pre><code>\"stderr\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxmaphashbucketsize","title":"services.nginx.mapHashBucketSize <p>Sets the bucket size for the map variables hash tables. Default value depends on the processor\u2019s cache line size.</p> <p>Refer to the nginx docs on hashes for more information.</p> <p>Type: null or (positive integer, meaning &gt;0)</p> <p>Default:</p> <pre><code>null\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxmaphashmaxsize","title":"services.nginx.mapHashMaxSize <p>Sets the maximum size of the map variables hash tables.</p> <p>Type: null or (positive integer, meaning &gt;0)</p> <p>Default:</p> <pre><code>null\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxprestart","title":"services.nginx.preStart <p>Shell commands executed before the service\u2019s nginx is started.</p> <p>Type: strings concatenated with \u201c\\n\u201d</p> <p>Default:</p> <pre><code>\"\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxprependconfig","title":"services.nginx.prependConfig <p>Configuration lines prepended to the generated Nginx configuration file. Can for example be used to load modules. <code>prependConfig</code> can be specified more than once and its value will be concatenated (contrary to <code>config</code> which can be set only once).</p> <p>Type: strings concatenated with \u201c\\n\u201d</p> <p>Default:</p> <pre><code>\"\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxproxycachepath","title":"services.nginx.proxyCachePath <p>Configure a proxy cache path entry. See https://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_cache_path for documentation.</p> <p>Type: attribute set of (submodule)</p> <p>Default:</p> <pre><code>{ }\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxproxycachepathenable","title":"services.nginx.proxyCachePath.\\.enable <p>Whether to enable this proxy cache path entry.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>false\n</code></pre> <p>Example:</p> <pre><code>true\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxproxycachepathinactive","title":"services.nginx.proxyCachePath.\\.inactive <p>Cached data that has not been accessed for the time specified by the inactive parameter is removed from the cache, regardless of its freshness.</p> <p>Type: string</p> <p>Default:</p> <pre><code>\"10m\"\n</code></pre> <p>Example:</p> <pre><code>\"1d\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxproxycachepathkeyszonename","title":"services.nginx.proxyCachePath.\\.keysZoneName <p>Set name to shared memory zone.</p> <p>Type: string</p> <p>Default:</p> <pre><code>\"cache\"\n</code></pre> <p>Example:</p> <pre><code>\"my_cache\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxproxycachepathkeyszonesize","title":"services.nginx.proxyCachePath.\\.keysZoneSize <p>Set size to shared memory zone.</p> <p>Type: string</p> <p>Default:</p> <pre><code>\"10m\"\n</code></pre> <p>Example:</p> <pre><code>\"32m\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxproxycachepathlevels","title":"services.nginx.proxyCachePath.\\.levels <p>The levels parameter defines structure of subdirectories in cache: from 1 to 3, each level accepts values 1 or 2. Can be used any combination of 1 and 2 in these formats: x, x:x and xx.</p> <p>Type: string</p> <p>Default:</p> <pre><code>\"1:2\"\n</code></pre> <p>Example:</p> <pre><code>\"1:2:2\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxproxycachepathmaxsize","title":"services.nginx.proxyCachePath.\\.maxSize <p>Set maximum cache size</p> <p>Type: string</p> <p>Default:</p> <pre><code>\"1g\"\n</code></pre> <p>Example:</p> <pre><code>\"2048m\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxproxycachepathusetemppath","title":"services.nginx.proxyCachePath.\\.useTempPath <p>Nginx first writes files that are destined for the cache to a temporary storage area, and the use_temp_path=off directive instructs Nginx to write them to the same directories where they will be cached. Recommended that you set this parameter to off to avoid unnecessary copying of data between file systems.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>false\n</code></pre> <p>Example:</p> <pre><code>true\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxproxyresolvewhilerunning","title":"services.nginx.proxyResolveWhileRunning <p>Resolves domains of proxyPass targets at runtime and not only at startup. This can be used as a workaround if nginx fails to start because of not-yet-working DNS.</p> <p>:::{.warn} <code>services.nginx.resolver</code> must be set for this option to work. :::</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>false\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxproxytimeout","title":"services.nginx.proxyTimeout <p>Change the proxy related timeouts in recommendedProxySettings.</p> <p>Type: string</p> <p>Default:</p> <pre><code>\"60s\"\n</code></pre> <p>Example:</p> <pre><code>\"20s\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxrecommendedbrotlisettings","title":"services.nginx.recommendedBrotliSettings <p>Enable recommended brotli settings. Learn more about compression in Brotli format here.</p> <p>This adds <code>pkgs.nginxModules.brotli</code> to <code>services.nginx.additionalModules</code>.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>false\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxrecommendedgzipsettings","title":"services.nginx.recommendedGzipSettings <p>Enable recommended gzip settings. Learn more about compression in Gzip format here.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>false\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxrecommendedoptimisation","title":"services.nginx.recommendedOptimisation <p>Enable recommended optimisation settings.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>false\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxrecommendedproxysettings","title":"services.nginx.recommendedProxySettings <p>Whether to enable recommended proxy settings if a vhost does not specify the option manually.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>false\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxrecommendedtlssettings","title":"services.nginx.recommendedTlsSettings <p>Enable recommended TLS settings.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>false\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxrecommendeduwsgisettings","title":"services.nginx.recommendedUwsgiSettings <p>Whether to enable recommended uwsgi settings if a vhost does not specify the option manually.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>false\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxresolver","title":"services.nginx.resolver <p>Configures name servers used to resolve names of upstream servers into addresses</p> <p>Type: submodule</p> <p>Default:</p> <pre><code>{ }\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxresolveraddresses","title":"services.nginx.resolver.addresses <p>List of resolvers to use</p> <p>Type: list of string</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Example:</p> <pre><code>[ \"[::1]\" \"127.0.0.1:5353\" ]\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxresolveripv4","title":"services.nginx.resolver.ipv4 <p>By default, nginx will look up both IPv4 and IPv6 addresses while resolving. If looking up of IPv4 addresses is not desired, the ipv4=off parameter can be specified.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>true\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxresolveripv6","title":"services.nginx.resolver.ipv6 <p>By default, nginx will look up both IPv4 and IPv6 addresses while resolving. If looking up of IPv6 addresses is not desired, the ipv6=off parameter can be specified.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>config.networking.enableIPv6\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxresolvervalid","title":"services.nginx.resolver.valid <p>By default, nginx caches answers using the TTL value of a response. An optional valid parameter allows overriding it</p> <p>Type: string</p> <p>Default:</p> <pre><code>\"\"\n</code></pre> <p>Example:</p> <pre><code>\"30s\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxservernameshashbucketsize","title":"services.nginx.serverNamesHashBucketSize <p>Sets the bucket size for the server names hash tables. Default value depends on the processor\u2019s cache line size.</p> <p>Type: null or (positive integer, meaning &gt;0)</p> <p>Default:</p> <pre><code>null\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxservernameshashmaxsize","title":"services.nginx.serverNamesHashMaxSize <p>Sets the maximum size of the server names hash tables.</p> <p>Type: null or (positive integer, meaning &gt;0)</p> <p>Default:</p> <pre><code>null\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxservertokens","title":"services.nginx.serverTokens <p>Show nginx version in headers and error pages.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>false\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxsslciphers","title":"services.nginx.sslCiphers <p>Ciphers to choose from when negotiating TLS handshakes.</p> <p>Type: null or string</p> <p>Default:</p> <pre><code>\"ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384:DHE-RSA-CHACHA20-POLY1305\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxssldhparam","title":"services.nginx.sslDhparam <p>Path to DH parameters file.</p> <p>Type: null or absolute path</p> <p>Default:</p> <pre><code>null\n</code></pre> <p>Example:</p> <pre><code>\"/path/to/dhparams.pem\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxsslprotocols","title":"services.nginx.sslProtocols <p>Allowed TLS protocol versions.</p> <p>Type: string</p> <p>Default:</p> <pre><code>\"TLSv1.2 TLSv1.3\"\n</code></pre> <p>Example:</p> <pre><code>\"TLSv1 TLSv1.1 TLSv1.2 TLSv1.3\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxstatuspage","title":"services.nginx.statusPage <p>Enable status page reachable from localhost on http://127.0.0.1/nginx_status.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>false\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxstreamconfig","title":"services.nginx.streamConfig <p>Configuration lines to be set inside the stream block.</p> <p>Type: strings concatenated with \u201c\\n\u201d</p> <p>Default:</p> <pre><code>\"\"\n</code></pre> <p>Example:</p> <pre><code>''\n  server {\n    listen 127.0.0.1:53 udp reuseport;\n    proxy_timeout 20s;\n    proxy_pass 192.168.0.1:53535;\n  }\n''\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxtypeshashmaxsize","title":"services.nginx.typesHashMaxSize <p>Sets the maximum size of the types hash tables (<code>types_hash_max_size</code>). It is recommended that the minimum size possible size is used. If <code>recommendedOptimisation</code> is disabled, nginx would otherwise fail to start since the mailmap <code>mime.types</code> database has more entries than the nginx default value 1024.</p> <p>Type: positive integer, meaning &gt;0</p> <p>Default:</p> <pre><code>if config.services.nginx.defaultMimeTypes == \"${pkgs.mailcap}/etc/nginx/mime.types\" then 2688 else 1024\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxupstreams","title":"services.nginx.upstreams <p>Defines a group of servers to use as proxy target.</p> <p>Type: attribute set of (submodule)</p> <p>Default:</p> <pre><code>{ }\n</code></pre> <p>Example:</p> <pre><code>{\n  backend = {\n    extraConfig = ''\n      keepalive 16;\n    '';\n    servers = {\n      \"backend1.example.com:8080\" = {\n        weight = 5;\n      };\n      \"backend2.example.com\" = {\n        fail_timeout = \"30s\";\n        max_fails = 3;\n      };\n      \"backend3.example.com\" = { };\n      \"backup1.example.com\" = {\n        backup = true;\n      };\n      \"backup2.example.com\" = {\n        backup = true;\n      };\n    };\n  };\n  memcached = {\n    servers = {\n      \"unix:/run/memcached/memcached.sock\" = { };\n    };\n  };\n}\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxupstreamsextraconfig","title":"services.nginx.upstreams.\\.extraConfig <p>These lines go to the end of the upstream verbatim.</p> <p>Type: strings concatenated with \u201c\\n\u201d</p> <p>Default:</p> <pre><code>\"\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxupstreamsservers","title":"services.nginx.upstreams.\\.servers <p>Defines the address and other parameters of the upstream servers. See the documentation for the available parameters.</p> <p>Type: attribute set of (open submodule of attribute set of (boolean or signed integer or string))</p> <p>Default:</p> <pre><code>{ }\n</code></pre> <p>Example: see </p> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxupstreamsserversbackup","title":"services.nginx.upstreams.\\.servers.\\.backup <p>Marks the server as a backup server. It will be passed requests when the primary servers are unavailable.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>false\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxuser","title":"services.nginx.user <p>User account under which nginx runs.</p> <p>Type: string</p> <p>Default:</p> <pre><code>\"nginx\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxuwsgiresolvewhilerunning","title":"services.nginx.uwsgiResolveWhileRunning <p>Resolves domains of uwsgi targets at runtime and not only at start, you have to set services.nginx.resolver, too.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>false\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxuwsgitimeout","title":"services.nginx.uwsgiTimeout <p>Change the uwsgi related timeouts in recommendedUwsgiSettings.</p> <p>Type: string</p> <p>Default:</p> <pre><code>\"60s\"\n</code></pre> <p>Example:</p> <pre><code>\"20s\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvalidateconfigfile","title":"services.nginx.validateConfigFile <p>Whether to enable validating configuration with pkgs.writeNginxConfig.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>true\n</code></pre> <p>Example:</p> <pre><code>true\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhosts","title":"services.nginx.virtualHosts <p>Declarative vhost config</p> <p>Type: attribute set of (submodule)</p> <p>Default:</p> <pre><code>{\n  localhost = { };\n}\n</code></pre> <p>Example:</p> <pre><code>{\n  \"hydra.example.com\" = {\n    forceSSL = true;\n    enableACME = true;\n    locations.\"/\" = {\n      proxyPass = \"http://localhost:3000\";\n    };\n  };\n};\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostsenableacme","title":"services.nginx.virtualHosts.\\.enableACME <p>Whether to ask Let\u2019s Encrypt to sign a certificate for this vhost. Alternately, you can use an existing certificate through <code>useACMEHost</code>.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>false\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostsacmefallbackhost","title":"services.nginx.virtualHosts.\\.acmeFallbackHost <p>Host which to proxy requests to if ACME challenge is not found. Useful if you want multiple hosts to be able to verify the same domain name.</p> <p>With this option, you could request certificates for the present domain with an ACME client that is running on another host, which you would specify here.</p> <p>Type: null or string</p> <p>Default:</p> <pre><code>null\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostsacmeroot","title":"services.nginx.virtualHosts.\\.acmeRoot <p>Directory for the ACME challenge, which is public. Don\u2019t put certs or keys in here. Set to null to inherit from config.security.acme.</p> <p>Type: null or string</p> <p>Default:</p> <pre><code>\"/var/lib/acme/acme-challenge\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostsaddssl","title":"services.nginx.virtualHosts.\\.addSSL <p>Whether to enable HTTPS in addition to plain HTTP. This will set defaults for <code>listen</code> to listen on all interfaces on the respective default ports (80, 443).</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>false\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostsbasicauth","title":"services.nginx.virtualHosts.\\.basicAuth <p>Basic Auth protection for a vhost.</p> <p>WARNING: This is implemented to store the password in plain text in the Nix store.</p> <p>Type: attribute set of string</p> <p>Default:</p> <pre><code>{ }\n</code></pre> <p>Example:</p> <pre><code>{\n  user = \"password\";\n};\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostsbasicauthfile","title":"services.nginx.virtualHosts.\\.basicAuthFile <p>Basic Auth password file for a vhost. Can be created by running <code>nix-shell --packages apacheHttpd --run 'htpasswd -B -c FILENAME USERNAME'</code>.</p> <p>Type: null or absolute path</p> <p>Default:</p> <pre><code>null\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostsdefault","title":"services.nginx.virtualHosts.\\.default <p>Makes this vhost the default.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>false\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostsextraconfig","title":"services.nginx.virtualHosts.\\.extraConfig <p>These lines go to the end of the vhost verbatim.</p> <p>Type: strings concatenated with \u201c\\n\u201d</p> <p>Default:</p> <pre><code>\"\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostsforcessl","title":"services.nginx.virtualHosts.\\.forceSSL <p>Whether to add a separate nginx server block that redirects (defaults to 301, configurable with <code>redirectCode</code>) all plain HTTP traffic to HTTPS. This will set defaults for <code>listen</code> to listen on all interfaces on the respective default ports (80, 443), where the non-SSL listens are used for the redirect vhosts.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>false\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostsglobalredirect","title":"services.nginx.virtualHosts.\\.globalRedirect <p>If set, all requests for this host are redirected (defaults to 301, configurable with <code>redirectCode</code>) to the given hostname.</p> <p>Type: null or string</p> <p>Default:</p> <pre><code>null\n</code></pre> <p>Example:</p> <pre><code>\"newserver.example.org\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostshttp2","title":"services.nginx.virtualHosts.\\.http2 <p>Whether to enable the HTTP/2 protocol. Note that (as of writing) due to nginx\u2019s implementation, to disable HTTP/2 you have to disable it on all vhosts that use a given IP address / port. If there is one server block configured to enable http2, then it is enabled for all server blocks on this IP. See https://stackoverflow.com/a/39466948/263061.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>true\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostshttp3","title":"services.nginx.virtualHosts.\\.http3 <p>Whether to enable the HTTP/3 protocol. This requires activating the QUIC transport protocol <code>services.nginx.virtualHosts.&lt;name&gt;.quic = true;</code>. Note that HTTP/3 support is experimental and not yet recommended for production. Read more at https://quic.nginx.org/ HTTP/3 availability must be manually advertised, preferably in each location block.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>true\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostshttp3_hq","title":"services.nginx.virtualHosts.\\.http3_hq <p>Whether to enable the HTTP/0.9 protocol negotiation used in QUIC interoperability tests. This requires activating the QUIC transport protocol <code>services.nginx.virtualHosts.&lt;name&gt;.quic = true;</code>. Note that special application protocol support is experimental and not yet recommended for production. Read more at https://quic.nginx.org/</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>false\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostsktls","title":"services.nginx.virtualHosts.\\.kTLS <p>Whether to enable kTLS support. Implementing TLS in the kernel (kTLS) improves performance by significantly reducing the need for copying operations between user space and the kernel. Required Nginx version 1.21.4 or later.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>false\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostslisten","title":"services.nginx.virtualHosts.\\.listen <p>Listen addresses and ports for this virtual host. IPv6 addresses must be enclosed in square brackets. Note: this option overrides <code>addSSL</code> and <code>onlySSL</code>.</p> <p>If you only want to set the addresses manually and not the ports, take a look at <code>listenAddresses</code>.</p> <p>Type: list of (submodule)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Example:</p> <pre><code>[\n  {\n    addr = \"195.154.1.1\";\n    port = 443;\n    ssl = true;\n  }\n  {\n    addr = \"192.154.1.1\";\n    port = 80;\n  }\n  {\n    addr = \"unix:/var/run/nginx.sock\";\n  }\n]\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostslistenaddr","title":"services.nginx.virtualHosts.\\.listen.*.addr <p>Listen address.</p> <p>Type: string</p> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostslistenextraparameters","title":"services.nginx.virtualHosts.\\.listen.*.extraParameters <p>Extra parameters of this listen directive.</p> <p>Type: list of string</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Example:</p> <pre><code>[\n  \"backlog=1024\"\n  \"deferred\"\n]\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostslistenport","title":"services.nginx.virtualHosts.\\.listen.*.port <p>Port number to listen on. If unset and the listen address is not a socket then nginx defaults to 80.</p> <p>Type: null or 16 bit unsigned integer; between 0 and 65535 (both inclusive)</p> <p>Default:</p> <pre><code>null\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostslistenproxyprotocol","title":"services.nginx.virtualHosts.\\.listen.*.proxyProtocol <p>Enable PROXY protocol.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>false\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostslistenssl","title":"services.nginx.virtualHosts.\\.listen.*.ssl <p>Enable SSL.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>false\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostslistenaddresses","title":"services.nginx.virtualHosts.\\.listenAddresses <p>Listen addresses for this virtual host. Compared to <code>listen</code> this only sets the addresses and the ports are chosen automatically.</p> <p>Note: This option overrides <code>networking.enableIPv6</code></p> <p>Type: list of string</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Example:</p> <pre><code>[\n  \"127.0.0.1\"\n  \"[::1]\"\n]\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostslocations","title":"services.nginx.virtualHosts.\\.locations <p>Declarative location config</p> <p>Type: attribute set of (submodule)</p> <p>Default:</p> <pre><code>{ }\n</code></pre> <p>Example:</p> <pre><code>{\n  \"/\" = {\n    proxyPass = \"http://localhost:3000\";\n  };\n};\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostslocationsalias","title":"services.nginx.virtualHosts.\\.locations.\\.alias <p>Alias directory for requests.</p> <p>Type: null or absolute path</p> <p>Default:</p> <pre><code>null\n</code></pre> <p>Example:</p> <pre><code>\"/your/alias/directory\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostslocationsbasicauth","title":"services.nginx.virtualHosts.\\.locations.\\.basicAuth <p>Basic Auth protection for a vhost.</p> <p>WARNING: This is implemented to store the password in plain text in the Nix store.</p> <p>Type: attribute set of string</p> <p>Default:</p> <pre><code>{ }\n</code></pre> <p>Example:</p> <pre><code>{\n  user = \"password\";\n};\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostslocationsbasicauthfile","title":"services.nginx.virtualHosts.\\.locations.\\.basicAuthFile <p>Basic Auth password file for a vhost. Can be created by running <code>nix-shell --packages apacheHttpd --run 'htpasswd -B -c FILENAME USERNAME'</code>.</p> <p>Type: null or absolute path</p> <p>Default:</p> <pre><code>null\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostslocationsextraconfig","title":"services.nginx.virtualHosts.\\.locations.\\.extraConfig <p>These lines go to the end of the location verbatim.</p> <p>Type: strings concatenated with \u201c\\n\u201d</p> <p>Default:</p> <pre><code>\"\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostslocationsfastcgiparams","title":"services.nginx.virtualHosts.\\.locations.\\.fastcgiParams <p>FastCGI parameters to override.  Unlike in the Nginx configuration file, overriding only some default parameters won\u2019t unset the default values for other parameters.</p> <p>Type: attribute set of (string or absolute path)</p> <p>Default:</p> <pre><code>{ }\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostslocationsindex","title":"services.nginx.virtualHosts.\\.locations.\\.index <p>Adds index directive.</p> <p>Type: null or string</p> <p>Default:</p> <pre><code>null\n</code></pre> <p>Example:</p> <pre><code>\"index.php index.html\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostslocationspriority","title":"services.nginx.virtualHosts.\\.locations.\\.priority <p>Order of this location block in relation to the others in the vhost. The semantics are the same as with <code>lib.mkOrder</code>. Smaller values have a greater priority.</p> <p>Type: signed integer</p> <p>Default:</p> <pre><code>1000\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostslocationsproxypass","title":"services.nginx.virtualHosts.\\.locations.\\.proxyPass <p>Adds proxy_pass directive and sets recommended proxy headers if recommendedProxySettings is enabled.</p> <p>Type: null or string</p> <p>Default:</p> <pre><code>null\n</code></pre> <p>Example:</p> <pre><code>\"http://www.example.org/\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostslocationsproxywebsockets","title":"services.nginx.virtualHosts.\\.locations.\\.proxyWebsockets <p>Whether to support proxying websocket connections with HTTP/1.1.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>false\n</code></pre> <p>Example:</p> <pre><code>true\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostslocationsrecommendedproxysettings","title":"services.nginx.virtualHosts.\\.locations.\\.recommendedProxySettings <p>Enable recommended proxy settings.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>config.services.nginx.recommendedProxySettings\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostslocationsrecommendeduwsgisettings","title":"services.nginx.virtualHosts.\\.locations.\\.recommendedUwsgiSettings <p>Enable recommended uwsgi settings.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>config.services.nginx.recommendedUwsgiSettings\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostslocationsreturn","title":"services.nginx.virtualHosts.\\.locations.\\.return <p>Adds a return directive, for e.g. redirections.</p> <p>Type: null or string or signed integer</p> <p>Default:</p> <pre><code>null\n</code></pre> <p>Example:</p> <pre><code>\"301 http://example.com$request_uri\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostslocationsroot","title":"services.nginx.virtualHosts.\\.locations.\\.root <p>Root directory for requests.</p> <p>Type: null or absolute path</p> <p>Default:</p> <pre><code>null\n</code></pre> <p>Example:</p> <pre><code>\"/your/root/directory\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostslocationstryfiles","title":"services.nginx.virtualHosts.\\.locations.\\.tryFiles <p>Adds try_files directive.</p> <p>Type: null or string</p> <p>Default:</p> <pre><code>null\n</code></pre> <p>Example:</p> <pre><code>\"$uri =404\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostslocationsuwsgipass","title":"services.nginx.virtualHosts.\\.locations.\\.uwsgiPass <p>Adds uwsgi_pass directive and sets recommended proxy headers if recommendedUwsgiSettings is enabled.</p> <p>Type: null or string</p> <p>Default:</p> <pre><code>null\n</code></pre> <p>Example:</p> <pre><code>\"unix:/run/example/example.sock\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostsonlyssl","title":"services.nginx.virtualHosts.\\.onlySSL <p>Whether to enable HTTPS and reject plain HTTP connections. This will set defaults for <code>listen</code> to listen on all interfaces on port 443.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>false\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostsquic","title":"services.nginx.virtualHosts.\\.quic <p>Whether to enable the QUIC transport protocol. Note that QUIC support is experimental and not yet recommended for production. Read more at https://quic.nginx.org/</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>false\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostsredirectcode","title":"services.nginx.virtualHosts.\\.redirectCode <p>HTTP status used by <code>globalRedirect</code> and <code>forceSSL</code>. Possible usecases include temporary (302, 307) redirects, keeping the request method and body (307, 308), or explicitly resetting the method to GET (303). See https://developer.mozilla.org/en-US/docs/Web/HTTP/Redirections.</p> <p>Type: integer between 300 and 399 (both inclusive)</p> <p>Default:</p> <pre><code>301\n</code></pre> <p>Example:</p> <pre><code>308\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostsrejectssl","title":"services.nginx.virtualHosts.\\.rejectSSL <p>Whether to listen for and reject all HTTPS connections to this vhost. Useful in default server blocks to avoid serving the certificate for another vhost. Uses the <code>ssl_reject_handshake</code> directive available in nginx versions 1.19.4 and above.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>false\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostsreuseport","title":"services.nginx.virtualHosts.\\.reuseport <p>Create an individual listening socket . It is required to specify only once on one of the hosts.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>false\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostsroot","title":"services.nginx.virtualHosts.\\.root <p>The path of the web root directory.</p> <p>Type: null or absolute path</p> <p>Default:</p> <pre><code>null\n</code></pre> <p>Example:</p> <pre><code>\"/data/webserver/docs\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostsserveraliases","title":"services.nginx.virtualHosts.\\.serverAliases <p>Additional names of virtual hosts served by this virtual host configuration.</p> <p>Type: list of string</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Example:</p> <pre><code>[\n  \"www.example.org\"\n  \"example.org\"\n]\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostsservername","title":"services.nginx.virtualHosts.\\.serverName <p>Name of this virtual host. Defaults to attribute name in virtualHosts.</p> <p>Type: null or string</p> <p>Default:</p> <pre><code>null\n</code></pre> <p>Example:</p> <pre><code>\"example.org\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostssslcertificate","title":"services.nginx.virtualHosts.\\.sslCertificate <p>Path to server SSL certificate.</p> <p>Type: absolute path</p> <p>Example:</p> <pre><code>\"/var/host.cert\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostssslcertificatekey","title":"services.nginx.virtualHosts.\\.sslCertificateKey <p>Path to server SSL certificate key.</p> <p>Type: absolute path</p> <p>Example:</p> <pre><code>\"/var/host.key\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostsssltrustedcertificate","title":"services.nginx.virtualHosts.\\.sslTrustedCertificate <p>Path to root SSL certificate for stapling and client certificates.</p> <p>Type: null or absolute path</p> <p>Default:</p> <pre><code>null\n</code></pre> <p>Example:</p> <pre><code>\"${pkgs.cacert}/etc/ssl/certs/ca-bundle.crt\"\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#servicesnginxvirtualhostsuseacmehost","title":"services.nginx.virtualHosts.\\.useACMEHost <p>A host of an existing Let\u2019s Encrypt certificate to use. This is useful if you have many subdomains and want to avoid hitting the rate limit. Alternately, you can generate a certificate through <code>enableACME</code>. Note that this option does not create any certificates, nor it does add subdomains to existing ones \u2013 you will need to create them manually using .</p> <p>Type: null or string</p> <p>Default:</p> <pre><code>null\n</code></pre> <p>Declared by:  - /nix/store/z24hgb7s4dcm6gmydvcsimb9nbjsrykm-9ddbmv9s0h6092m1fi85rv2vv32165lp-source/nixos/modules/services/web-servers/nginx/</p>","text":""},{"location":"reference/all-options/#system-managerallowanydistro","title":"system-manager.allowAnyDistro <p>Whether to enable the usage of system-manager on untested distributions.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>false\n</code></pre> <p>Example:</p> <pre><code>true\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#system-managerpreactivationassertions","title":"system-manager.preActivationAssertions <p>This option has no description.</p> <p>Type: attribute set of (submodule)</p> <p>Default:</p> <pre><code>{ }\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#system-managerpreactivationassertionsenable","title":"system-manager.preActivationAssertions.\\.enable <p>Whether to enable the assertion.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>false\n</code></pre> <p>Example:</p> <pre><code>true\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#system-managerpreactivationassertionsname","title":"system-manager.preActivationAssertions.\\.name <p>This option has no description.</p> <p>Type: string</p> <p>Default:</p> <pre><code>\"\u2039name\u203a\"\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#system-managerpreactivationassertionsscript","title":"system-manager.preActivationAssertions.\\.script <p>This option has no description.</p> <p>Type: string</p> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdenablestrictshellchecks","title":"systemd.enableStrictShellChecks <p>Whether to enable running shellcheck on the generated scripts for systemd units\u2026</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>false\n</code></pre> <p>Example:</p> <pre><code>true\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdpackage","title":"systemd.package <p>This option has no description.</p> <p>Type: string or absolute path or package</p> <p>Default:</p> <pre><code>&lt;derivation systemd-minimal-258.3&gt;\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdpackages","title":"systemd.packages <p>Packages providing systemd units and hooks.</p> <p>Type: list of package</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Example:</p> <pre><code>[ pkgs.systemd-cryptsetup-generator ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdautomounts","title":"systemd.automounts <p>Definition of systemd automount units. This is a list instead of an attrSet, because systemd mandates the names to be derived from the \u2018where\u2019 attribute.</p> <p>Type: list of (submodule)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdautomountsenable","title":"systemd.automounts.*.enable <p>If set to false, this unit will be a symlink to /dev/null. This is primarily useful to prevent specific template instances (e.g. <code>serial-getty@ttyS0</code>) from being started. Note that <code>enable=true</code> does not make a unit start by default at boot; if you want that, see <code>wantedBy</code>.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>true\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdautomountsafter","title":"systemd.automounts.*.after <p>If the specified units are started at the same time as this unit, delay this unit until they have started.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdautomountsaliases","title":"systemd.automounts.*.aliases <p>Aliases of that unit.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdautomountsautomountconfig","title":"systemd.automounts.*.automountConfig <p>Each attribute in this set specifies an option in the <code>[Automount]</code> section of the unit.  See <code>systemd.automount(5)</code> for details.</p> <p>Type: attribute set of (systemd option)</p> <p>Default:</p> <pre><code>{ }\n</code></pre> <p>Example:</p> <pre><code>{\n  DirectoryMode = \"0775\";\n}\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdautomountsbefore","title":"systemd.automounts.*.before <p>If the specified units are started at the same time as this unit, delay them until this unit has started.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdautomountsbindsto","title":"systemd.automounts.*.bindsTo <p>Like \u2018requires\u2019, but in addition, if the specified units unexpectedly disappear, this unit will be stopped as well.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdautomountsconflicts","title":"systemd.automounts.*.conflicts <p>If the specified units are started, then this unit is stopped and vice versa.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdautomountsdescription","title":"systemd.automounts.*.description <p>Description of this unit used in systemd messages and progress indicators.</p> <p>Type: (optionally newline-terminated) single-line string</p> <p>Default:</p> <pre><code>\"\"\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdautomountsdocumentation","title":"systemd.automounts.*.documentation <p>A list of URIs referencing documentation for this unit or its configuration.</p> <p>Type: list of string</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdautomountsname","title":"systemd.automounts.*.name <p>The name of this systemd unit, including its extension. This can be used to refer to this unit from other systemd units.</p> <p>Type: string</p> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdautomountsonfailure","title":"systemd.automounts.*.onFailure <p>A list of one or more units that are activated when this unit enters the \u201cfailed\u201d state.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdautomountsonsuccess","title":"systemd.automounts.*.onSuccess <p>A list of one or more units that are activated when this unit enters the \u201cinactive\u201d state.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdautomountsoverridestrategy","title":"systemd.automounts.*.overrideStrategy <p>Defines how unit configuration is provided for systemd:</p> <p><code>asDropinIfExists</code> creates a unit file when no unit file is provided by the package otherwise it creates a drop-in file named <code>overrides.conf</code>.</p> <p><code>asDropin</code> creates a drop-in file named <code>overrides.conf</code>. Mainly needed to define instances for systemd template units (e.g. <code>systemd-nspawn@mycontainer.service</code>).</p> <p>See also <code>systemd.unit(5)</code>.</p> <p>Type: one of \u201casDropinIfExists\u201d, \u201casDropin\u201d</p> <p>Default:</p> <pre><code>\"asDropinIfExists\"\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdautomountspartof","title":"systemd.automounts.*.partOf <p>If the specified units are stopped or restarted, then this unit is stopped or restarted as well.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdautomountsreloadtriggers","title":"systemd.automounts.*.reloadTriggers <p>An arbitrary list of items such as derivations.  If any item in the list changes between reconfigurations, the service will be reloaded.  If anything but a reload trigger changes in the unit file, the unit will be restarted instead.</p> <p>Type: list of (systemd option)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdautomountsrequiredby","title":"systemd.automounts.*.requiredBy <p>Units that require (i.e. depend on and need to go down with) this unit. As discussed in the <code>wantedBy</code> option description this also creates <code>.requires</code> symlinks automatically.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdautomountsrequires","title":"systemd.automounts.*.requires <p>Start the specified units when this unit is started, and stop this unit when the specified units are stopped or fail.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdautomountsrequisite","title":"systemd.automounts.*.requisite <p>Similar to requires. However if the units listed are not started, they will not be started and the transaction will fail.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdautomountsrestarttriggers","title":"systemd.automounts.*.restartTriggers <p>An arbitrary list of items such as derivations.  If any item in the list changes between reconfigurations, the service will be restarted.</p> <p>Type: list of unspecified value</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdautomountsstartlimitburst","title":"systemd.automounts.*.startLimitBurst <p>Configure unit start rate limiting. Units which are started more than startLimitBurst times within an interval time interval are not permitted to start any more.</p> <p>Type: signed integer</p> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdautomountsstartlimitintervalsec","title":"systemd.automounts.*.startLimitIntervalSec <p>Configure unit start rate limiting. Units which are started more than startLimitBurst times within an interval time interval are not permitted to start any more.</p> <p>Type: signed integer</p> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdautomountsunitconfig","title":"systemd.automounts.*.unitConfig <p>Each attribute in this set specifies an option in the <code>[Unit]</code> section of the unit.  See <code>systemd.unit(5)</code> for details.</p> <p>Type: attribute set of (systemd option)</p> <p>Default:</p> <pre><code>{ }\n</code></pre> <p>Example:</p> <pre><code>{\n  RequiresMountsFor = \"/data\";\n}\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdautomountsupheldby","title":"systemd.automounts.*.upheldBy <p>Keep this unit running as long as the listed units are running. This is a continuously enforced version of wantedBy.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdautomountsupholds","title":"systemd.automounts.*.upholds <p>Keeps the specified running while this unit is running. A continuous version of <code>wants</code>.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdautomountswantedby","title":"systemd.automounts.*.wantedBy <p>Units that want (i.e. depend on) this unit. The default method for starting a unit by default at boot time is to set this option to <code>[\"multi-user.target\"]</code> for system services. Likewise for user units (<code>systemd.user.&lt;name&gt;.*</code>) set it to <code>[\"default.target\"]</code> to make a unit start by default when the user <code>&lt;name&gt;</code> logs on.</p> <p>This option creates a <code>.wants</code> symlink in the given target that exists statelessly without the need for running <code>systemctl enable</code>. The <code>[Install]</code> section described in <code>systemd.unit(5)</code> however is not supported because it is a stateful process that does not fit well into the NixOS design.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdautomountswants","title":"systemd.automounts.*.wants <p>Start the specified units when this unit is started.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdautomountswhere","title":"systemd.automounts.*.where <p>Absolute path of a directory of the mount point. Will be created if it doesn\u2019t exist. (Mandatory)</p> <p>Type: string</p> <p>Example:</p> <pre><code>\"/mnt\"\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdgenerators","title":"systemd.generators <p>Definition of systemd generators. For each <code>NAME = VALUE</code> pair of the attrSet, a link is generated from <code>/etc/systemd/system-generators/NAME</code> to <code>VALUE</code>.</p> <p>Type: attribute set of absolute path</p> <p>Default:</p> <pre><code>{ }\n</code></pre> <p>Example:</p> <pre><code>{\n  systemd-gpt-auto-generator = \"/dev/null\";\n}\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdglobalenvironment","title":"systemd.globalEnvironment <p>Environment variables passed to all systemd units.</p> <p>Type: attribute set of (null or string or absolute path or package)</p> <p>Default:</p> <pre><code>{ }\n</code></pre> <p>Example:</p> <pre><code>{\n  TZ = \"CET\";\n}\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdmounts","title":"systemd.mounts <p>Definition of systemd mount units. This is a list instead of an attrSet, because systemd mandates the names to be derived from the \u2018where\u2019 attribute.</p> <p>Type: list of (submodule)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdmountsenable","title":"systemd.mounts.*.enable <p>If set to false, this unit will be a symlink to /dev/null. This is primarily useful to prevent specific template instances (e.g. <code>serial-getty@ttyS0</code>) from being started. Note that <code>enable=true</code> does not make a unit start by default at boot; if you want that, see <code>wantedBy</code>.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>true\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdmountsafter","title":"systemd.mounts.*.after <p>If the specified units are started at the same time as this unit, delay this unit until they have started.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdmountsaliases","title":"systemd.mounts.*.aliases <p>Aliases of that unit.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdmountsbefore","title":"systemd.mounts.*.before <p>If the specified units are started at the same time as this unit, delay them until this unit has started.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdmountsbindsto","title":"systemd.mounts.*.bindsTo <p>Like \u2018requires\u2019, but in addition, if the specified units unexpectedly disappear, this unit will be stopped as well.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdmountsconflicts","title":"systemd.mounts.*.conflicts <p>If the specified units are started, then this unit is stopped and vice versa.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdmountsdescription","title":"systemd.mounts.*.description <p>Description of this unit used in systemd messages and progress indicators.</p> <p>Type: (optionally newline-terminated) single-line string</p> <p>Default:</p> <pre><code>\"\"\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdmountsdocumentation","title":"systemd.mounts.*.documentation <p>A list of URIs referencing documentation for this unit or its configuration.</p> <p>Type: list of string</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdmountsmountconfig","title":"systemd.mounts.*.mountConfig <p>Each attribute in this set specifies an option in the <code>[Mount]</code> section of the unit.  See <code>systemd.mount(5)</code> for details.</p> <p>Type: attribute set of (systemd option)</p> <p>Default:</p> <pre><code>{ }\n</code></pre> <p>Example:</p> <pre><code>{\n  DirectoryMode = \"0775\";\n}\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdmountsname","title":"systemd.mounts.*.name <p>The name of this systemd unit, including its extension. This can be used to refer to this unit from other systemd units.</p> <p>Type: string</p> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdmountsonfailure","title":"systemd.mounts.*.onFailure <p>A list of one or more units that are activated when this unit enters the \u201cfailed\u201d state.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdmountsonsuccess","title":"systemd.mounts.*.onSuccess <p>A list of one or more units that are activated when this unit enters the \u201cinactive\u201d state.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdmountsoptions","title":"systemd.mounts.*.options <p>Options used to mount the file system.</p> <p>Type: strings concatenated with \u201c,\u201d</p> <p>Default:</p> <pre><code>\"\"\n</code></pre> <p>Example:</p> <pre><code>\"noatime\"\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdmountsoverridestrategy","title":"systemd.mounts.*.overrideStrategy <p>Defines how unit configuration is provided for systemd:</p> <p><code>asDropinIfExists</code> creates a unit file when no unit file is provided by the package otherwise it creates a drop-in file named <code>overrides.conf</code>.</p> <p><code>asDropin</code> creates a drop-in file named <code>overrides.conf</code>. Mainly needed to define instances for systemd template units (e.g. <code>systemd-nspawn@mycontainer.service</code>).</p> <p>See also <code>systemd.unit(5)</code>.</p> <p>Type: one of \u201casDropinIfExists\u201d, \u201casDropin\u201d</p> <p>Default:</p> <pre><code>\"asDropinIfExists\"\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdmountspartof","title":"systemd.mounts.*.partOf <p>If the specified units are stopped or restarted, then this unit is stopped or restarted as well.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdmountsreloadtriggers","title":"systemd.mounts.*.reloadTriggers <p>An arbitrary list of items such as derivations.  If any item in the list changes between reconfigurations, the service will be reloaded.  If anything but a reload trigger changes in the unit file, the unit will be restarted instead.</p> <p>Type: list of (systemd option)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdmountsrequiredby","title":"systemd.mounts.*.requiredBy <p>Units that require (i.e. depend on and need to go down with) this unit. As discussed in the <code>wantedBy</code> option description this also creates <code>.requires</code> symlinks automatically.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdmountsrequires","title":"systemd.mounts.*.requires <p>Start the specified units when this unit is started, and stop this unit when the specified units are stopped or fail.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdmountsrequisite","title":"systemd.mounts.*.requisite <p>Similar to requires. However if the units listed are not started, they will not be started and the transaction will fail.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdmountsrestarttriggers","title":"systemd.mounts.*.restartTriggers <p>An arbitrary list of items such as derivations.  If any item in the list changes between reconfigurations, the service will be restarted.</p> <p>Type: list of unspecified value</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdmountsstartlimitburst","title":"systemd.mounts.*.startLimitBurst <p>Configure unit start rate limiting. Units which are started more than startLimitBurst times within an interval time interval are not permitted to start any more.</p> <p>Type: signed integer</p> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdmountsstartlimitintervalsec","title":"systemd.mounts.*.startLimitIntervalSec <p>Configure unit start rate limiting. Units which are started more than startLimitBurst times within an interval time interval are not permitted to start any more.</p> <p>Type: signed integer</p> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdmountstype","title":"systemd.mounts.*.type <p>File system type.</p> <p>Type: string</p> <p>Default:</p> <pre><code>\"\"\n</code></pre> <p>Example:</p> <pre><code>\"ext4\"\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdmountsunitconfig","title":"systemd.mounts.*.unitConfig <p>Each attribute in this set specifies an option in the <code>[Unit]</code> section of the unit.  See <code>systemd.unit(5)</code> for details.</p> <p>Type: attribute set of (systemd option)</p> <p>Default:</p> <pre><code>{ }\n</code></pre> <p>Example:</p> <pre><code>{\n  RequiresMountsFor = \"/data\";\n}\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdmountsupheldby","title":"systemd.mounts.*.upheldBy <p>Keep this unit running as long as the listed units are running. This is a continuously enforced version of wantedBy.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdmountsupholds","title":"systemd.mounts.*.upholds <p>Keeps the specified running while this unit is running. A continuous version of <code>wants</code>.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdmountswantedby","title":"systemd.mounts.*.wantedBy <p>Units that want (i.e. depend on) this unit. The default method for starting a unit by default at boot time is to set this option to <code>[\"multi-user.target\"]</code> for system services. Likewise for user units (<code>systemd.user.&lt;name&gt;.*</code>) set it to <code>[\"default.target\"]</code> to make a unit start by default when the user <code>&lt;name&gt;</code> logs on.</p> <p>This option creates a <code>.wants</code> symlink in the given target that exists statelessly without the need for running <code>systemctl enable</code>. The <code>[Install]</code> section described in <code>systemd.unit(5)</code> however is not supported because it is a stateful process that does not fit well into the NixOS design.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdmountswants","title":"systemd.mounts.*.wants <p>Start the specified units when this unit is started.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdmountswhat","title":"systemd.mounts.*.what <p>Absolute path of device node, file or other resource. (Mandatory)</p> <p>Type: string</p> <p>Example:</p> <pre><code>\"/dev/sda1\"\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdmountswhere","title":"systemd.mounts.*.where <p>Absolute path of a directory of the mount point. Will be created if it doesn\u2019t exist. (Mandatory)</p> <p>Type: string</p> <p>Example:</p> <pre><code>\"/mnt\"\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdpaths","title":"systemd.paths <p>Definition of systemd path units.</p> <p>Type: attribute set of (submodule)</p> <p>Default:</p> <pre><code>{ }\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdpathsenable","title":"systemd.paths.\\.enable <p>If set to false, this unit will be a symlink to /dev/null. This is primarily useful to prevent specific template instances (e.g. <code>serial-getty@ttyS0</code>) from being started. Note that <code>enable=true</code> does not make a unit start by default at boot; if you want that, see <code>wantedBy</code>.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>true\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdpathsafter","title":"systemd.paths.\\.after <p>If the specified units are started at the same time as this unit, delay this unit until they have started.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdpathsaliases","title":"systemd.paths.\\.aliases <p>Aliases of that unit.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdpathsbefore","title":"systemd.paths.\\.before <p>If the specified units are started at the same time as this unit, delay them until this unit has started.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdpathsbindsto","title":"systemd.paths.\\.bindsTo <p>Like \u2018requires\u2019, but in addition, if the specified units unexpectedly disappear, this unit will be stopped as well.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdpathsconflicts","title":"systemd.paths.\\.conflicts <p>If the specified units are started, then this unit is stopped and vice versa.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdpathsdescription","title":"systemd.paths.\\.description <p>Description of this unit used in systemd messages and progress indicators.</p> <p>Type: (optionally newline-terminated) single-line string</p> <p>Default:</p> <pre><code>\"\"\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdpathsdocumentation","title":"systemd.paths.\\.documentation <p>A list of URIs referencing documentation for this unit or its configuration.</p> <p>Type: list of string</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdpathsname","title":"systemd.paths.\\.name <p>The name of this systemd unit, including its extension. This can be used to refer to this unit from other systemd units.</p> <p>Type: string</p> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdpathsonfailure","title":"systemd.paths.\\.onFailure <p>A list of one or more units that are activated when this unit enters the \u201cfailed\u201d state.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdpathsonsuccess","title":"systemd.paths.\\.onSuccess <p>A list of one or more units that are activated when this unit enters the \u201cinactive\u201d state.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdpathsoverridestrategy","title":"systemd.paths.\\.overrideStrategy <p>Defines how unit configuration is provided for systemd:</p> <p><code>asDropinIfExists</code> creates a unit file when no unit file is provided by the package otherwise it creates a drop-in file named <code>overrides.conf</code>.</p> <p><code>asDropin</code> creates a drop-in file named <code>overrides.conf</code>. Mainly needed to define instances for systemd template units (e.g. <code>systemd-nspawn@mycontainer.service</code>).</p> <p>See also <code>systemd.unit(5)</code>.</p> <p>Type: one of \u201casDropinIfExists\u201d, \u201casDropin\u201d</p> <p>Default:</p> <pre><code>\"asDropinIfExists\"\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdpathspartof","title":"systemd.paths.\\.partOf <p>If the specified units are stopped or restarted, then this unit is stopped or restarted as well.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdpathspathconfig","title":"systemd.paths.\\.pathConfig <p>Each attribute in this set specifies an option in the <code>[Path]</code> section of the unit.  See <code>systemd.path(5)</code> for details.</p> <p>Type: attribute set of (systemd option)</p> <p>Default:</p> <pre><code>{ }\n</code></pre> <p>Example:</p> <pre><code>{\n  PathChanged = \"/some/path\";\n  Unit = \"changedpath.service\";\n}\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdpathsreloadtriggers","title":"systemd.paths.\\.reloadTriggers <p>An arbitrary list of items such as derivations.  If any item in the list changes between reconfigurations, the service will be reloaded.  If anything but a reload trigger changes in the unit file, the unit will be restarted instead.</p> <p>Type: list of (systemd option)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdpathsrequiredby","title":"systemd.paths.\\.requiredBy <p>Units that require (i.e. depend on and need to go down with) this unit. As discussed in the <code>wantedBy</code> option description this also creates <code>.requires</code> symlinks automatically.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdpathsrequires","title":"systemd.paths.\\.requires <p>Start the specified units when this unit is started, and stop this unit when the specified units are stopped or fail.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdpathsrequisite","title":"systemd.paths.\\.requisite <p>Similar to requires. However if the units listed are not started, they will not be started and the transaction will fail.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdpathsrestarttriggers","title":"systemd.paths.\\.restartTriggers <p>An arbitrary list of items such as derivations.  If any item in the list changes between reconfigurations, the service will be restarted.</p> <p>Type: list of unspecified value</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdpathsstartlimitburst","title":"systemd.paths.\\.startLimitBurst <p>Configure unit start rate limiting. Units which are started more than startLimitBurst times within an interval time interval are not permitted to start any more.</p> <p>Type: signed integer</p> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdpathsstartlimitintervalsec","title":"systemd.paths.\\.startLimitIntervalSec <p>Configure unit start rate limiting. Units which are started more than startLimitBurst times within an interval time interval are not permitted to start any more.</p> <p>Type: signed integer</p> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdpathsunitconfig","title":"systemd.paths.\\.unitConfig <p>Each attribute in this set specifies an option in the <code>[Unit]</code> section of the unit.  See <code>systemd.unit(5)</code> for details.</p> <p>Type: attribute set of (systemd option)</p> <p>Default:</p> <pre><code>{ }\n</code></pre> <p>Example:</p> <pre><code>{\n  RequiresMountsFor = \"/data\";\n}\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdpathsupheldby","title":"systemd.paths.\\.upheldBy <p>Keep this unit running as long as the listed units are running. This is a continuously enforced version of wantedBy.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdpathsupholds","title":"systemd.paths.\\.upholds <p>Keeps the specified running while this unit is running. A continuous version of <code>wants</code>.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdpathswantedby","title":"systemd.paths.\\.wantedBy <p>Units that want (i.e. depend on) this unit. The default method for starting a unit by default at boot time is to set this option to <code>[\"multi-user.target\"]</code> for system services. Likewise for user units (<code>systemd.user.&lt;name&gt;.*</code>) set it to <code>[\"default.target\"]</code> to make a unit start by default when the user <code>&lt;name&gt;</code> logs on.</p> <p>This option creates a <code>.wants</code> symlink in the given target that exists statelessly without the need for running <code>systemctl enable</code>. The <code>[Install]</code> section described in <code>systemd.unit(5)</code> however is not supported because it is a stateful process that does not fit well into the NixOS design.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdpathswants","title":"systemd.paths.\\.wants <p>Start the specified units when this unit is started.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdservices","title":"systemd.services <p>Definition of systemd service units.</p> <p>Type: attribute set of (submodule)</p> <p>Default:</p> <pre><code>{ }\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdservicesenable","title":"systemd.services.\\.enable <p>If set to false, this unit will be a symlink to /dev/null. This is primarily useful to prevent specific template instances (e.g. <code>serial-getty@ttyS0</code>) from being started. Note that <code>enable=true</code> does not make a unit start by default at boot; if you want that, see <code>wantedBy</code>.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>true\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdservicesenablestrictshellchecks","title":"systemd.services.\\.enableStrictShellChecks <p>Enable running <code>shellcheck</code> on the generated scripts for this unit.</p> <p>When enabled, scripts generated by the unit will be checked with <code>shellcheck</code> and any errors or warnings will cause the build to fail.</p> <p>This affects all scripts that have been created through the <code>script</code>, <code>reload</code>, <code>preStart</code>, <code>postStart</code>, <code>preStop</code> and <code>postStop</code> options for systemd services. This does not affect command lines passed directly to <code>ExecStart</code>, <code>ExecReload</code>, <code>ExecStartPre</code>, <code>ExecStartPost</code>, <code>ExecStop</code> or <code>ExecStopPost</code>.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>config.systemd.enableStrictShellChecks\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdservicesafter","title":"systemd.services.\\.after <p>If the specified units are started at the same time as this unit, delay this unit until they have started.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdservicesaliases","title":"systemd.services.\\.aliases <p>Aliases of that unit.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdservicesbefore","title":"systemd.services.\\.before <p>If the specified units are started at the same time as this unit, delay them until this unit has started.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdservicesbindsto","title":"systemd.services.\\.bindsTo <p>Like \u2018requires\u2019, but in addition, if the specified units unexpectedly disappear, this unit will be stopped as well.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdservicesconflicts","title":"systemd.services.\\.conflicts <p>If the specified units are started, then this unit is stopped and vice versa.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdservicesdescription","title":"systemd.services.\\.description <p>Description of this unit used in systemd messages and progress indicators.</p> <p>Type: (optionally newline-terminated) single-line string</p> <p>Default:</p> <pre><code>\"\"\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdservicesdocumentation","title":"systemd.services.\\.documentation <p>A list of URIs referencing documentation for this unit or its configuration.</p> <p>Type: list of string</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdservicesenvironment","title":"systemd.services.\\.environment <p>Environment variables passed to the service\u2019s processes.</p> <p>Type: attribute set of (null or string or absolute path or package)</p> <p>Default:</p> <pre><code>{ }\n</code></pre> <p>Example:</p> <pre><code>{\n  LANG = \"nl_NL.UTF-8\";\n  PATH = \"/foo/bar/bin\";\n}\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdservicesname","title":"systemd.services.\\.name <p>The name of this systemd unit, including its extension. This can be used to refer to this unit from other systemd units.</p> <p>Type: string</p> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdservicesnotsocketactivated","title":"systemd.services.\\.notSocketActivated <p>If set, a changed unit is never assumed to be socket-activated on configuration switch, even if it might have associated socket units. Instead, the unit will be restarted (or stopped/started) as if it had no associated sockets.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>false\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdservicesonfailure","title":"systemd.services.\\.onFailure <p>A list of one or more units that are activated when this unit enters the \u201cfailed\u201d state.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdservicesonsuccess","title":"systemd.services.\\.onSuccess <p>A list of one or more units that are activated when this unit enters the \u201cinactive\u201d state.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdservicesoverridestrategy","title":"systemd.services.\\.overrideStrategy <p>Defines how unit configuration is provided for systemd:</p> <p><code>asDropinIfExists</code> creates a unit file when no unit file is provided by the package otherwise it creates a drop-in file named <code>overrides.conf</code>.</p> <p><code>asDropin</code> creates a drop-in file named <code>overrides.conf</code>. Mainly needed to define instances for systemd template units (e.g. <code>systemd-nspawn@mycontainer.service</code>).</p> <p>See also <code>systemd.unit(5)</code>.</p> <p>Type: one of \u201casDropinIfExists\u201d, \u201casDropin\u201d</p> <p>Default:</p> <pre><code>\"asDropinIfExists\"\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdservicespartof","title":"systemd.services.\\.partOf <p>If the specified units are stopped or restarted, then this unit is stopped or restarted as well.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdservicespath","title":"systemd.services.\\.path <p>Packages added to the service\u2019s <code>PATH</code> environment variable.  Both the <code>bin</code> and <code>sbin</code> subdirectories of each package are added.</p> <p>Type: list of (package or string)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdservicespoststart","title":"systemd.services.\\.postStart <p>Shell commands executed after the service\u2019s main process is started.</p> <p>Type: strings concatenated with \u201c\\n\u201d</p> <p>Default:</p> <pre><code>\"\"\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdservicespoststop","title":"systemd.services.\\.postStop <p>Shell commands executed after the service\u2019s main process has exited.</p> <p>Type: strings concatenated with \u201c\\n\u201d</p> <p>Default:</p> <pre><code>\"\"\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdservicesprestart","title":"systemd.services.\\.preStart <p>Shell commands executed before the service\u2019s main process is started.</p> <p>Type: strings concatenated with \u201c\\n\u201d</p> <p>Default:</p> <pre><code>\"\"\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdservicesprestop","title":"systemd.services.\\.preStop <p>Shell commands executed to stop the service.</p> <p>Type: strings concatenated with \u201c\\n\u201d</p> <p>Default:</p> <pre><code>\"\"\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdservicesreload","title":"systemd.services.\\.reload <p>Shell commands executed when the service\u2019s main process is reloaded.</p> <p>Type: strings concatenated with \u201c\\n\u201d</p> <p>Default:</p> <pre><code>\"\"\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdservicesreloadifchanged","title":"systemd.services.\\.reloadIfChanged <p>Whether the service should be reloaded during a NixOS configuration switch if its definition has changed.  If enabled, the value of <code>restartIfChanged</code> is ignored.</p> <p>This option should not be used anymore in favor of <code>reloadTriggers</code> which allows more granular control of when a service is reloaded and when a service is restarted.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>false\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdservicesreloadtriggers","title":"systemd.services.\\.reloadTriggers <p>An arbitrary list of items such as derivations.  If any item in the list changes between reconfigurations, the service will be reloaded.  If anything but a reload trigger changes in the unit file, the unit will be restarted instead.</p> <p>Type: list of (systemd option)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdservicesrequiredby","title":"systemd.services.\\.requiredBy <p>Units that require (i.e. depend on and need to go down with) this unit. As discussed in the <code>wantedBy</code> option description this also creates <code>.requires</code> symlinks automatically.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdservicesrequires","title":"systemd.services.\\.requires <p>Start the specified units when this unit is started, and stop this unit when the specified units are stopped or fail.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdservicesrequisite","title":"systemd.services.\\.requisite <p>Similar to requires. However if the units listed are not started, they will not be started and the transaction will fail.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdservicesrestartifchanged","title":"systemd.services.\\.restartIfChanged <p>Whether the service should be restarted during a NixOS configuration switch if its definition has changed.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>true\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdservicesrestarttriggers","title":"systemd.services.\\.restartTriggers <p>An arbitrary list of items such as derivations.  If any item in the list changes between reconfigurations, the service will be restarted.</p> <p>Type: list of unspecified value</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdservicesscript","title":"systemd.services.\\.script <p>Shell commands executed as the service\u2019s main process.</p> <p>Type: strings concatenated with \u201c\\n\u201d</p> <p>Default:</p> <pre><code>\"\"\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdservicesscriptargs","title":"systemd.services.\\.scriptArgs <p>Arguments passed to the main process script. Can contain specifiers (<code>%</code> placeholders expanded by systemd, see <code>systemd.unit(5)</code>).</p> <p>Type: string</p> <p>Default:</p> <pre><code>\"\"\n</code></pre> <p>Example:</p> <pre><code>\"%i\"\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdservicesserviceconfig","title":"systemd.services.\\.serviceConfig <p>Each attribute in this set specifies an option in the <code>[Service]</code> section of the unit.  See <code>systemd.service(5)</code> for details.</p> <p>Type: attribute set of (systemd option)</p> <p>Default:</p> <pre><code>{ }\n</code></pre> <p>Example:</p> <pre><code>{\n  RestartSec = 5;\n}\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdservicesstartat","title":"systemd.services.\\.startAt <p>Automatically start this unit at the given date/time, which must be in the format described in <code>systemd.time(7)</code>.  This is equivalent to adding a corresponding timer unit with <code>OnCalendar</code> set to the value given here.</p> <p>Type: string or list of string</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Example:</p> <pre><code>\"Sun 14:00:00\"\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdservicesstartlimitburst","title":"systemd.services.\\.startLimitBurst <p>Configure unit start rate limiting. Units which are started more than startLimitBurst times within an interval time interval are not permitted to start any more.</p> <p>Type: signed integer</p> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdservicesstartlimitintervalsec","title":"systemd.services.\\.startLimitIntervalSec <p>Configure unit start rate limiting. Units which are started more than startLimitBurst times within an interval time interval are not permitted to start any more.</p> <p>Type: signed integer</p> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdservicesstopifchanged","title":"systemd.services.\\.stopIfChanged <p>If set, a changed unit is restarted by calling <code>systemctl stop</code> in the old configuration, then <code>systemctl start</code> in the new one. Otherwise, it is restarted in a single step using <code>systemctl restart</code> in the new configuration. The latter is less correct because it runs the <code>ExecStop</code> commands from the new configuration.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>true\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdservicesunitconfig","title":"systemd.services.\\.unitConfig <p>Each attribute in this set specifies an option in the <code>[Unit]</code> section of the unit.  See <code>systemd.unit(5)</code> for details.</p> <p>Type: attribute set of (systemd option)</p> <p>Default:</p> <pre><code>{ }\n</code></pre> <p>Example:</p> <pre><code>{\n  RequiresMountsFor = \"/data\";\n}\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdservicesupheldby","title":"systemd.services.\\.upheldBy <p>Keep this unit running as long as the listed units are running. This is a continuously enforced version of wantedBy.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdservicesupholds","title":"systemd.services.\\.upholds <p>Keeps the specified running while this unit is running. A continuous version of <code>wants</code>.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdserviceswantedby","title":"systemd.services.\\.wantedBy <p>Units that want (i.e. depend on) this unit. The default method for starting a unit by default at boot time is to set this option to <code>[\"multi-user.target\"]</code> for system services. Likewise for user units (<code>systemd.user.&lt;name&gt;.*</code>) set it to <code>[\"default.target\"]</code> to make a unit start by default when the user <code>&lt;name&gt;</code> logs on.</p> <p>This option creates a <code>.wants</code> symlink in the given target that exists statelessly without the need for running <code>systemctl enable</code>. The <code>[Install]</code> section described in <code>systemd.unit(5)</code> however is not supported because it is a stateful process that does not fit well into the NixOS design.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdserviceswants","title":"systemd.services.\\.wants <p>Start the specified units when this unit is started.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdshutdown","title":"systemd.shutdown <p>Definition of systemd shutdown executables. For each <code>NAME = VALUE</code> pair of the attrSet, a link is generated from <code>/etc/systemd/system-shutdown/NAME</code> to <code>VALUE</code>.</p> <p>Type: attribute set of absolute path</p> <p>Default:</p> <pre><code>{ }\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdslices","title":"systemd.slices <p>Definition of slice configurations.</p> <p>Type: attribute set of (submodule)</p> <p>Default:</p> <pre><code>{ }\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdslicesenable","title":"systemd.slices.\\.enable <p>If set to false, this unit will be a symlink to /dev/null. This is primarily useful to prevent specific template instances (e.g. <code>serial-getty@ttyS0</code>) from being started. Note that <code>enable=true</code> does not make a unit start by default at boot; if you want that, see <code>wantedBy</code>.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>true\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdslicesafter","title":"systemd.slices.\\.after <p>If the specified units are started at the same time as this unit, delay this unit until they have started.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdslicesaliases","title":"systemd.slices.\\.aliases <p>Aliases of that unit.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdslicesbefore","title":"systemd.slices.\\.before <p>If the specified units are started at the same time as this unit, delay them until this unit has started.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdslicesbindsto","title":"systemd.slices.\\.bindsTo <p>Like \u2018requires\u2019, but in addition, if the specified units unexpectedly disappear, this unit will be stopped as well.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdslicesconflicts","title":"systemd.slices.\\.conflicts <p>If the specified units are started, then this unit is stopped and vice versa.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdslicesdescription","title":"systemd.slices.\\.description <p>Description of this unit used in systemd messages and progress indicators.</p> <p>Type: (optionally newline-terminated) single-line string</p> <p>Default:</p> <pre><code>\"\"\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdslicesdocumentation","title":"systemd.slices.\\.documentation <p>A list of URIs referencing documentation for this unit or its configuration.</p> <p>Type: list of string</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdslicesname","title":"systemd.slices.\\.name <p>The name of this systemd unit, including its extension. This can be used to refer to this unit from other systemd units.</p> <p>Type: string</p> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdslicesonfailure","title":"systemd.slices.\\.onFailure <p>A list of one or more units that are activated when this unit enters the \u201cfailed\u201d state.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdslicesonsuccess","title":"systemd.slices.\\.onSuccess <p>A list of one or more units that are activated when this unit enters the \u201cinactive\u201d state.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdslicesoverridestrategy","title":"systemd.slices.\\.overrideStrategy <p>Defines how unit configuration is provided for systemd:</p> <p><code>asDropinIfExists</code> creates a unit file when no unit file is provided by the package otherwise it creates a drop-in file named <code>overrides.conf</code>.</p> <p><code>asDropin</code> creates a drop-in file named <code>overrides.conf</code>. Mainly needed to define instances for systemd template units (e.g. <code>systemd-nspawn@mycontainer.service</code>).</p> <p>See also <code>systemd.unit(5)</code>.</p> <p>Type: one of \u201casDropinIfExists\u201d, \u201casDropin\u201d</p> <p>Default:</p> <pre><code>\"asDropinIfExists\"\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdslicespartof","title":"systemd.slices.\\.partOf <p>If the specified units are stopped or restarted, then this unit is stopped or restarted as well.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdslicesreloadtriggers","title":"systemd.slices.\\.reloadTriggers <p>An arbitrary list of items such as derivations.  If any item in the list changes between reconfigurations, the service will be reloaded.  If anything but a reload trigger changes in the unit file, the unit will be restarted instead.</p> <p>Type: list of (systemd option)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdslicesrequiredby","title":"systemd.slices.\\.requiredBy <p>Units that require (i.e. depend on and need to go down with) this unit. As discussed in the <code>wantedBy</code> option description this also creates <code>.requires</code> symlinks automatically.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdslicesrequires","title":"systemd.slices.\\.requires <p>Start the specified units when this unit is started, and stop this unit when the specified units are stopped or fail.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdslicesrequisite","title":"systemd.slices.\\.requisite <p>Similar to requires. However if the units listed are not started, they will not be started and the transaction will fail.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdslicesrestarttriggers","title":"systemd.slices.\\.restartTriggers <p>An arbitrary list of items such as derivations.  If any item in the list changes between reconfigurations, the service will be restarted.</p> <p>Type: list of unspecified value</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdslicessliceconfig","title":"systemd.slices.\\.sliceConfig <p>Each attribute in this set specifies an option in the <code>[Slice]</code> section of the unit.  See <code>systemd.slice(5)</code> for details.</p> <p>Type: attribute set of (systemd option)</p> <p>Default:</p> <pre><code>{ }\n</code></pre> <p>Example:</p> <pre><code>{\n  MemoryMax = \"2G\";\n}\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdslicesstartlimitburst","title":"systemd.slices.\\.startLimitBurst <p>Configure unit start rate limiting. Units which are started more than startLimitBurst times within an interval time interval are not permitted to start any more.</p> <p>Type: signed integer</p> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdslicesstartlimitintervalsec","title":"systemd.slices.\\.startLimitIntervalSec <p>Configure unit start rate limiting. Units which are started more than startLimitBurst times within an interval time interval are not permitted to start any more.</p> <p>Type: signed integer</p> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdslicesunitconfig","title":"systemd.slices.\\.unitConfig <p>Each attribute in this set specifies an option in the <code>[Unit]</code> section of the unit.  See <code>systemd.unit(5)</code> for details.</p> <p>Type: attribute set of (systemd option)</p> <p>Default:</p> <pre><code>{ }\n</code></pre> <p>Example:</p> <pre><code>{\n  RequiresMountsFor = \"/data\";\n}\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdslicesupheldby","title":"systemd.slices.\\.upheldBy <p>Keep this unit running as long as the listed units are running. This is a continuously enforced version of wantedBy.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdslicesupholds","title":"systemd.slices.\\.upholds <p>Keeps the specified running while this unit is running. A continuous version of <code>wants</code>.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdsliceswantedby","title":"systemd.slices.\\.wantedBy <p>Units that want (i.e. depend on) this unit. The default method for starting a unit by default at boot time is to set this option to <code>[\"multi-user.target\"]</code> for system services. Likewise for user units (<code>systemd.user.&lt;name&gt;.*</code>) set it to <code>[\"default.target\"]</code> to make a unit start by default when the user <code>&lt;name&gt;</code> logs on.</p> <p>This option creates a <code>.wants</code> symlink in the given target that exists statelessly without the need for running <code>systemctl enable</code>. The <code>[Install]</code> section described in <code>systemd.unit(5)</code> however is not supported because it is a stateful process that does not fit well into the NixOS design.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdsliceswants","title":"systemd.slices.\\.wants <p>Start the specified units when this unit is started.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdsockets","title":"systemd.sockets <p>Definition of systemd socket units.</p> <p>Type: attribute set of (submodule)</p> <p>Default:</p> <pre><code>{ }\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdsocketsenable","title":"systemd.sockets.\\.enable <p>If set to false, this unit will be a symlink to /dev/null. This is primarily useful to prevent specific template instances (e.g. <code>serial-getty@ttyS0</code>) from being started. Note that <code>enable=true</code> does not make a unit start by default at boot; if you want that, see <code>wantedBy</code>.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>true\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdsocketsafter","title":"systemd.sockets.\\.after <p>If the specified units are started at the same time as this unit, delay this unit until they have started.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdsocketsaliases","title":"systemd.sockets.\\.aliases <p>Aliases of that unit.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdsocketsbefore","title":"systemd.sockets.\\.before <p>If the specified units are started at the same time as this unit, delay them until this unit has started.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdsocketsbindsto","title":"systemd.sockets.\\.bindsTo <p>Like \u2018requires\u2019, but in addition, if the specified units unexpectedly disappear, this unit will be stopped as well.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdsocketsconflicts","title":"systemd.sockets.\\.conflicts <p>If the specified units are started, then this unit is stopped and vice versa.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdsocketsdescription","title":"systemd.sockets.\\.description <p>Description of this unit used in systemd messages and progress indicators.</p> <p>Type: (optionally newline-terminated) single-line string</p> <p>Default:</p> <pre><code>\"\"\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdsocketsdocumentation","title":"systemd.sockets.\\.documentation <p>A list of URIs referencing documentation for this unit or its configuration.</p> <p>Type: list of string</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdsocketslistendatagrams","title":"systemd.sockets.\\.listenDatagrams <p>For each item in this list, a <code>ListenDatagram</code> option in the <code>[Socket]</code> section will be created.</p> <p>Type: list of string</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Example:</p> <pre><code>[\n  \"0.0.0.0:993\"\n  \"/run/my-socket\"\n]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdsocketslistenstreams","title":"systemd.sockets.\\.listenStreams <p>For each item in this list, a <code>ListenStream</code> option in the <code>[Socket]</code> section will be created.</p> <p>Type: list of string</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Example:</p> <pre><code>[\n  \"0.0.0.0:993\"\n  \"/run/my-socket\"\n]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdsocketsname","title":"systemd.sockets.\\.name <p>The name of this systemd unit, including its extension. This can be used to refer to this unit from other systemd units.</p> <p>Type: string</p> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdsocketsonfailure","title":"systemd.sockets.\\.onFailure <p>A list of one or more units that are activated when this unit enters the \u201cfailed\u201d state.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdsocketsonsuccess","title":"systemd.sockets.\\.onSuccess <p>A list of one or more units that are activated when this unit enters the \u201cinactive\u201d state.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdsocketsoverridestrategy","title":"systemd.sockets.\\.overrideStrategy <p>Defines how unit configuration is provided for systemd:</p> <p><code>asDropinIfExists</code> creates a unit file when no unit file is provided by the package otherwise it creates a drop-in file named <code>overrides.conf</code>.</p> <p><code>asDropin</code> creates a drop-in file named <code>overrides.conf</code>. Mainly needed to define instances for systemd template units (e.g. <code>systemd-nspawn@mycontainer.service</code>).</p> <p>See also <code>systemd.unit(5)</code>.</p> <p>Type: one of \u201casDropinIfExists\u201d, \u201casDropin\u201d</p> <p>Default:</p> <pre><code>\"asDropinIfExists\"\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdsocketspartof","title":"systemd.sockets.\\.partOf <p>If the specified units are stopped or restarted, then this unit is stopped or restarted as well.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdsocketsreloadtriggers","title":"systemd.sockets.\\.reloadTriggers <p>An arbitrary list of items such as derivations.  If any item in the list changes between reconfigurations, the service will be reloaded.  If anything but a reload trigger changes in the unit file, the unit will be restarted instead.</p> <p>Type: list of (systemd option)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdsocketsrequiredby","title":"systemd.sockets.\\.requiredBy <p>Units that require (i.e. depend on and need to go down with) this unit. As discussed in the <code>wantedBy</code> option description this also creates <code>.requires</code> symlinks automatically.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdsocketsrequires","title":"systemd.sockets.\\.requires <p>Start the specified units when this unit is started, and stop this unit when the specified units are stopped or fail.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdsocketsrequisite","title":"systemd.sockets.\\.requisite <p>Similar to requires. However if the units listed are not started, they will not be started and the transaction will fail.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdsocketsrestarttriggers","title":"systemd.sockets.\\.restartTriggers <p>An arbitrary list of items such as derivations.  If any item in the list changes between reconfigurations, the service will be restarted.</p> <p>Type: list of unspecified value</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdsocketssocketconfig","title":"systemd.sockets.\\.socketConfig <p>Each attribute in this set specifies an option in the <code>[Socket]</code> section of the unit.  See <code>systemd.socket(5)</code> for details.</p> <p>Type: attribute set of (systemd option)</p> <p>Default:</p> <pre><code>{ }\n</code></pre> <p>Example:</p> <pre><code>{\n  ListenStream = \"/run/my-socket\";\n}\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdsocketsstartlimitburst","title":"systemd.sockets.\\.startLimitBurst <p>Configure unit start rate limiting. Units which are started more than startLimitBurst times within an interval time interval are not permitted to start any more.</p> <p>Type: signed integer</p> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdsocketsstartlimitintervalsec","title":"systemd.sockets.\\.startLimitIntervalSec <p>Configure unit start rate limiting. Units which are started more than startLimitBurst times within an interval time interval are not permitted to start any more.</p> <p>Type: signed integer</p> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdsocketsunitconfig","title":"systemd.sockets.\\.unitConfig <p>Each attribute in this set specifies an option in the <code>[Unit]</code> section of the unit.  See <code>systemd.unit(5)</code> for details.</p> <p>Type: attribute set of (systemd option)</p> <p>Default:</p> <pre><code>{ }\n</code></pre> <p>Example:</p> <pre><code>{\n  RequiresMountsFor = \"/data\";\n}\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdsocketsupheldby","title":"systemd.sockets.\\.upheldBy <p>Keep this unit running as long as the listed units are running. This is a continuously enforced version of wantedBy.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdsocketsupholds","title":"systemd.sockets.\\.upholds <p>Keeps the specified running while this unit is running. A continuous version of <code>wants</code>.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdsocketswantedby","title":"systemd.sockets.\\.wantedBy <p>Units that want (i.e. depend on) this unit. The default method for starting a unit by default at boot time is to set this option to <code>[\"multi-user.target\"]</code> for system services. Likewise for user units (<code>systemd.user.&lt;name&gt;.*</code>) set it to <code>[\"default.target\"]</code> to make a unit start by default when the user <code>&lt;name&gt;</code> logs on.</p> <p>This option creates a <code>.wants</code> symlink in the given target that exists statelessly without the need for running <code>systemctl enable</code>. The <code>[Install]</code> section described in <code>systemd.unit(5)</code> however is not supported because it is a stateful process that does not fit well into the NixOS design.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdsocketswants","title":"systemd.sockets.\\.wants <p>Start the specified units when this unit is started.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtargets","title":"systemd.targets <p>Definition of systemd target units.</p> <p>Type: attribute set of (submodule)</p> <p>Default:</p> <pre><code>{ }\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtargetsenable","title":"systemd.targets.\\.enable <p>If set to false, this unit will be a symlink to /dev/null. This is primarily useful to prevent specific template instances (e.g. <code>serial-getty@ttyS0</code>) from being started. Note that <code>enable=true</code> does not make a unit start by default at boot; if you want that, see <code>wantedBy</code>.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>true\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtargetsafter","title":"systemd.targets.\\.after <p>If the specified units are started at the same time as this unit, delay this unit until they have started.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtargetsaliases","title":"systemd.targets.\\.aliases <p>Aliases of that unit.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtargetsbefore","title":"systemd.targets.\\.before <p>If the specified units are started at the same time as this unit, delay them until this unit has started.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtargetsbindsto","title":"systemd.targets.\\.bindsTo <p>Like \u2018requires\u2019, but in addition, if the specified units unexpectedly disappear, this unit will be stopped as well.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtargetsconflicts","title":"systemd.targets.\\.conflicts <p>If the specified units are started, then this unit is stopped and vice versa.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtargetsdescription","title":"systemd.targets.\\.description <p>Description of this unit used in systemd messages and progress indicators.</p> <p>Type: (optionally newline-terminated) single-line string</p> <p>Default:</p> <pre><code>\"\"\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtargetsdocumentation","title":"systemd.targets.\\.documentation <p>A list of URIs referencing documentation for this unit or its configuration.</p> <p>Type: list of string</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtargetsname","title":"systemd.targets.\\.name <p>The name of this systemd unit, including its extension. This can be used to refer to this unit from other systemd units.</p> <p>Type: string</p> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtargetsonfailure","title":"systemd.targets.\\.onFailure <p>A list of one or more units that are activated when this unit enters the \u201cfailed\u201d state.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtargetsonsuccess","title":"systemd.targets.\\.onSuccess <p>A list of one or more units that are activated when this unit enters the \u201cinactive\u201d state.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtargetsoverridestrategy","title":"systemd.targets.\\.overrideStrategy <p>Defines how unit configuration is provided for systemd:</p> <p><code>asDropinIfExists</code> creates a unit file when no unit file is provided by the package otherwise it creates a drop-in file named <code>overrides.conf</code>.</p> <p><code>asDropin</code> creates a drop-in file named <code>overrides.conf</code>. Mainly needed to define instances for systemd template units (e.g. <code>systemd-nspawn@mycontainer.service</code>).</p> <p>See also <code>systemd.unit(5)</code>.</p> <p>Type: one of \u201casDropinIfExists\u201d, \u201casDropin\u201d</p> <p>Default:</p> <pre><code>\"asDropinIfExists\"\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtargetspartof","title":"systemd.targets.\\.partOf <p>If the specified units are stopped or restarted, then this unit is stopped or restarted as well.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtargetsreloadtriggers","title":"systemd.targets.\\.reloadTriggers <p>An arbitrary list of items such as derivations.  If any item in the list changes between reconfigurations, the service will be reloaded.  If anything but a reload trigger changes in the unit file, the unit will be restarted instead.</p> <p>Type: list of (systemd option)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtargetsrequiredby","title":"systemd.targets.\\.requiredBy <p>Units that require (i.e. depend on and need to go down with) this unit. As discussed in the <code>wantedBy</code> option description this also creates <code>.requires</code> symlinks automatically.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtargetsrequires","title":"systemd.targets.\\.requires <p>Start the specified units when this unit is started, and stop this unit when the specified units are stopped or fail.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtargetsrequisite","title":"systemd.targets.\\.requisite <p>Similar to requires. However if the units listed are not started, they will not be started and the transaction will fail.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtargetsrestarttriggers","title":"systemd.targets.\\.restartTriggers <p>An arbitrary list of items such as derivations.  If any item in the list changes between reconfigurations, the service will be restarted.</p> <p>Type: list of unspecified value</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtargetsstartlimitburst","title":"systemd.targets.\\.startLimitBurst <p>Configure unit start rate limiting. Units which are started more than startLimitBurst times within an interval time interval are not permitted to start any more.</p> <p>Type: signed integer</p> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtargetsstartlimitintervalsec","title":"systemd.targets.\\.startLimitIntervalSec <p>Configure unit start rate limiting. Units which are started more than startLimitBurst times within an interval time interval are not permitted to start any more.</p> <p>Type: signed integer</p> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtargetsunitconfig","title":"systemd.targets.\\.unitConfig <p>Each attribute in this set specifies an option in the <code>[Unit]</code> section of the unit.  See <code>systemd.unit(5)</code> for details.</p> <p>Type: attribute set of (systemd option)</p> <p>Default:</p> <pre><code>{ }\n</code></pre> <p>Example:</p> <pre><code>{\n  RequiresMountsFor = \"/data\";\n}\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtargetsupheldby","title":"systemd.targets.\\.upheldBy <p>Keep this unit running as long as the listed units are running. This is a continuously enforced version of wantedBy.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtargetsupholds","title":"systemd.targets.\\.upholds <p>Keeps the specified running while this unit is running. A continuous version of <code>wants</code>.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtargetswantedby","title":"systemd.targets.\\.wantedBy <p>Units that want (i.e. depend on) this unit. The default method for starting a unit by default at boot time is to set this option to <code>[\"multi-user.target\"]</code> for system services. Likewise for user units (<code>systemd.user.&lt;name&gt;.*</code>) set it to <code>[\"default.target\"]</code> to make a unit start by default when the user <code>&lt;name&gt;</code> logs on.</p> <p>This option creates a <code>.wants</code> symlink in the given target that exists statelessly without the need for running <code>systemctl enable</code>. The <code>[Install]</code> section described in <code>systemd.unit(5)</code> however is not supported because it is a stateful process that does not fit well into the NixOS design.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtargetswants","title":"systemd.targets.\\.wants <p>Start the specified units when this unit is started.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtimers","title":"systemd.timers <p>Definition of systemd timer units.</p> <p>Type: attribute set of (submodule)</p> <p>Default:</p> <pre><code>{ }\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtimersenable","title":"systemd.timers.\\.enable <p>If set to false, this unit will be a symlink to /dev/null. This is primarily useful to prevent specific template instances (e.g. <code>serial-getty@ttyS0</code>) from being started. Note that <code>enable=true</code> does not make a unit start by default at boot; if you want that, see <code>wantedBy</code>.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>true\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtimersafter","title":"systemd.timers.\\.after <p>If the specified units are started at the same time as this unit, delay this unit until they have started.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtimersaliases","title":"systemd.timers.\\.aliases <p>Aliases of that unit.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtimersbefore","title":"systemd.timers.\\.before <p>If the specified units are started at the same time as this unit, delay them until this unit has started.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtimersbindsto","title":"systemd.timers.\\.bindsTo <p>Like \u2018requires\u2019, but in addition, if the specified units unexpectedly disappear, this unit will be stopped as well.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtimersconflicts","title":"systemd.timers.\\.conflicts <p>If the specified units are started, then this unit is stopped and vice versa.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtimersdescription","title":"systemd.timers.\\.description <p>Description of this unit used in systemd messages and progress indicators.</p> <p>Type: (optionally newline-terminated) single-line string</p> <p>Default:</p> <pre><code>\"\"\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtimersdocumentation","title":"systemd.timers.\\.documentation <p>A list of URIs referencing documentation for this unit or its configuration.</p> <p>Type: list of string</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtimersname","title":"systemd.timers.\\.name <p>The name of this systemd unit, including its extension. This can be used to refer to this unit from other systemd units.</p> <p>Type: string</p> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtimersonfailure","title":"systemd.timers.\\.onFailure <p>A list of one or more units that are activated when this unit enters the \u201cfailed\u201d state.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtimersonsuccess","title":"systemd.timers.\\.onSuccess <p>A list of one or more units that are activated when this unit enters the \u201cinactive\u201d state.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtimersoverridestrategy","title":"systemd.timers.\\.overrideStrategy <p>Defines how unit configuration is provided for systemd:</p> <p><code>asDropinIfExists</code> creates a unit file when no unit file is provided by the package otherwise it creates a drop-in file named <code>overrides.conf</code>.</p> <p><code>asDropin</code> creates a drop-in file named <code>overrides.conf</code>. Mainly needed to define instances for systemd template units (e.g. <code>systemd-nspawn@mycontainer.service</code>).</p> <p>See also <code>systemd.unit(5)</code>.</p> <p>Type: one of \u201casDropinIfExists\u201d, \u201casDropin\u201d</p> <p>Default:</p> <pre><code>\"asDropinIfExists\"\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtimerspartof","title":"systemd.timers.\\.partOf <p>If the specified units are stopped or restarted, then this unit is stopped or restarted as well.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtimersreloadtriggers","title":"systemd.timers.\\.reloadTriggers <p>An arbitrary list of items such as derivations.  If any item in the list changes between reconfigurations, the service will be reloaded.  If anything but a reload trigger changes in the unit file, the unit will be restarted instead.</p> <p>Type: list of (systemd option)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtimersrequiredby","title":"systemd.timers.\\.requiredBy <p>Units that require (i.e. depend on and need to go down with) this unit. As discussed in the <code>wantedBy</code> option description this also creates <code>.requires</code> symlinks automatically.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtimersrequires","title":"systemd.timers.\\.requires <p>Start the specified units when this unit is started, and stop this unit when the specified units are stopped or fail.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtimersrequisite","title":"systemd.timers.\\.requisite <p>Similar to requires. However if the units listed are not started, they will not be started and the transaction will fail.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtimersrestarttriggers","title":"systemd.timers.\\.restartTriggers <p>An arbitrary list of items such as derivations.  If any item in the list changes between reconfigurations, the service will be restarted.</p> <p>Type: list of unspecified value</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtimersstartlimitburst","title":"systemd.timers.\\.startLimitBurst <p>Configure unit start rate limiting. Units which are started more than startLimitBurst times within an interval time interval are not permitted to start any more.</p> <p>Type: signed integer</p> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtimersstartlimitintervalsec","title":"systemd.timers.\\.startLimitIntervalSec <p>Configure unit start rate limiting. Units which are started more than startLimitBurst times within an interval time interval are not permitted to start any more.</p> <p>Type: signed integer</p> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtimerstimerconfig","title":"systemd.timers.\\.timerConfig <p>Each attribute in this set specifies an option in the <code>[Timer]</code> section of the unit.  See <code>systemd.timer(5)</code> and <code>systemd.time(7)</code> for details.</p> <p>Type: attribute set of (systemd option)</p> <p>Default:</p> <pre><code>{ }\n</code></pre> <p>Example:</p> <pre><code>{\n  OnCalendar = \"Sun 14:00:00\";\n  Unit = \"foo.service\";\n}\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtimersunitconfig","title":"systemd.timers.\\.unitConfig <p>Each attribute in this set specifies an option in the <code>[Unit]</code> section of the unit.  See <code>systemd.unit(5)</code> for details.</p> <p>Type: attribute set of (systemd option)</p> <p>Default:</p> <pre><code>{ }\n</code></pre> <p>Example:</p> <pre><code>{\n  RequiresMountsFor = \"/data\";\n}\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtimersupheldby","title":"systemd.timers.\\.upheldBy <p>Keep this unit running as long as the listed units are running. This is a continuously enforced version of wantedBy.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtimersupholds","title":"systemd.timers.\\.upholds <p>Keeps the specified running while this unit is running. A continuous version of <code>wants</code>.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtimerswantedby","title":"systemd.timers.\\.wantedBy <p>Units that want (i.e. depend on) this unit. The default method for starting a unit by default at boot time is to set this option to <code>[\"multi-user.target\"]</code> for system services. Likewise for user units (<code>systemd.user.&lt;name&gt;.*</code>) set it to <code>[\"default.target\"]</code> to make a unit start by default when the user <code>&lt;name&gt;</code> logs on.</p> <p>This option creates a <code>.wants</code> symlink in the given target that exists statelessly without the need for running <code>systemctl enable</code>. The <code>[Install]</code> section described in <code>systemd.unit(5)</code> however is not supported because it is a stateful process that does not fit well into the NixOS design.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtimerswants","title":"systemd.timers.\\.wants <p>Start the specified units when this unit is started.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtmpfilespackages","title":"systemd.tmpfiles.packages <p>List of packages containing <code>systemd-tmpfiles</code> rules.</p> <p>All files ending in .conf found in <code>\u00abpkg\u00bb/lib/tmpfiles.d</code> will be included. If this folder does not exist or does not contain any files an error will be returned instead.</p> <p>If a <code>lib</code> output is available, rules are searched there and only there. If there is no <code>lib</code> output it will fall back to <code>out</code> and if that does not exist either, the default output will be used.</p> <p>Type: list of package</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Example:</p> <pre><code>[ pkgs.lvm2 ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtmpfilesrules","title":"systemd.tmpfiles.rules <p>Rules for creation, deletion and cleaning of volatile and temporary files automatically. See <code>tmpfiles.d(5)</code> for the exact format.</p> <p>Type: list of string</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Example:</p> <pre><code>[\n  \"d /tmp 1777 root root 10d\"\n]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtmpfilessettings","title":"systemd.tmpfiles.settings <p>Declare systemd-tmpfiles rules to create, delete, and clean up volatile and temporary files and directories.</p> <p>Even though the service is called <code>*tmp*files</code> you can also create persistent files.</p> <p>Type: attribute set of attribute set of attribute set of (submodule)</p> <p>Default:</p> <pre><code>{ }\n</code></pre> <p>Example:</p> <pre><code>{\n  \"10-mypackage\" = {\n    \"/var/lib/my-service/statefolder\" = {\n      d = {\n        group = \"root\";\n        mode = \"0755\";\n        user = \"root\";\n      };\n    };\n  };\n}\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtmpfilessettingsage","title":"systemd.tmpfiles.settings.\\.\\.\\.age <p>Delete a file when it reaches a certain age.</p> <p>If a file or directory is older than the current time minus the age field, it is deleted.</p> <p>If set to <code>\"-\"</code> no automatic clean-up is done.</p> <p>Type: string</p> <p>Default:</p> <pre><code>\"-\"\n</code></pre> <p>Example:</p> <pre><code>\"10d\"\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtmpfilessettingsargument","title":"systemd.tmpfiles.settings.\\.\\.\\.argument <p>An argument whose meaning depends on the type of operation.</p> <p>Please see the upstream documentation for the meaning of this parameter in different situations: https://www.freedesktop.org/software/systemd/man/tmpfiles.d</p> <p>Type: string</p> <p>Default:</p> <pre><code>\"\"\n</code></pre> <p>Example:</p> <pre><code>\"\"\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtmpfilessettingsgroup","title":"systemd.tmpfiles.settings.\\.\\.\\.group <p>The group of the file.</p> <p>This may either be a numeric ID or a user/group name.</p> <p>If omitted or when set to <code>\"-\"</code>, the user and group of the user who invokes systemd-tmpfiles is used.</p> <p>Type: string</p> <p>Default:</p> <pre><code>\"-\"\n</code></pre> <p>Example:</p> <pre><code>\"root\"\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtmpfilessettingsmode","title":"systemd.tmpfiles.settings.\\.\\.\\.mode <p>The file access mode to use when creating this file or directory.</p> <p>Type: string</p> <p>Default:</p> <pre><code>\"-\"\n</code></pre> <p>Example:</p> <pre><code>\"0755\"\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtmpfilessettingstype","title":"systemd.tmpfiles.settings.\\.\\.\\.type <p>The type of operation to perform on the file.</p> <p>The type consists of a single letter and optionally one or more modifier characters.</p> <p>Please see the upstream documentation for the available types and more details: https://www.freedesktop.org/software/systemd/man/tmpfiles.d</p> <p>Type: string</p> <p>Default:</p> <pre><code>\"\u2039name\u203a\"\n</code></pre> <p>Example:</p> <pre><code>\"d\"\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdtmpfilessettingsuser","title":"systemd.tmpfiles.settings.\\.\\.\\.user <p>The user of the file.</p> <p>This may either be a numeric ID or a user/group name.</p> <p>If omitted or when set to <code>\"-\"</code>, the user and group of the user who invokes systemd-tmpfiles is used.</p> <p>Type: string</p> <p>Default:</p> <pre><code>\"-\"\n</code></pre> <p>Example:</p> <pre><code>\"root\"\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdunits","title":"systemd.units <p>Definition of systemd units.</p> <p>Type: attribute set of (submodule)</p> <p>Default:</p> <pre><code>{ }\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdunitsenable","title":"systemd.units.\\.enable <p>If set to false, this unit will be a symlink to /dev/null. This is primarily useful to prevent specific template instances (e.g. <code>serial-getty@ttyS0</code>) from being started. Note that <code>enable=true</code> does not make a unit start by default at boot; if you want that, see <code>wantedBy</code>.</p> <p>Type: boolean</p> <p>Default:</p> <pre><code>true\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdunitsaliases","title":"systemd.units.\\.aliases <p>Aliases of that unit.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdunitsname","title":"systemd.units.\\.name <p>The name of this systemd unit, including its extension. This can be used to refer to this unit from other systemd units.</p> <p>Type: string</p> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdunitsoverridestrategy","title":"systemd.units.\\.overrideStrategy <p>Defines how unit configuration is provided for systemd:</p> <p><code>asDropinIfExists</code> creates a unit file when no unit file is provided by the package otherwise it creates a drop-in file named <code>overrides.conf</code>.</p> <p><code>asDropin</code> creates a drop-in file named <code>overrides.conf</code>. Mainly needed to define instances for systemd template units (e.g. <code>systemd-nspawn@mycontainer.service</code>).</p> <p>See also <code>systemd.unit(5)</code>.</p> <p>Type: one of \u201casDropinIfExists\u201d, \u201casDropin\u201d</p> <p>Default:</p> <pre><code>\"asDropinIfExists\"\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdunitsrequiredby","title":"systemd.units.\\.requiredBy <p>Units that require (i.e. depend on and need to go down with) this unit. As discussed in the <code>wantedBy</code> option description this also creates <code>.requires</code> symlinks automatically.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdunitstext","title":"systemd.units.\\.text <p>Text of this systemd unit.</p> <p>Type: null or string</p> <p>Default:</p> <pre><code>null\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdunitsupheldby","title":"systemd.units.\\.upheldBy <p>Keep this unit running as long as the listed units are running. This is a continuously enforced version of wantedBy.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/all-options/#systemdunitswantedby","title":"systemd.units.\\.wantedBy <p>Units that want (i.e. depend on) this unit. The default method for starting a unit by default at boot time is to set this option to <code>[\"multi-user.target\"]</code> for system services. Likewise for user units (<code>systemd.user.&lt;name&gt;.*</code>) set it to <code>[\"default.target\"]</code> to make a unit start by default when the user <code>&lt;name&gt;</code> logs on.</p> <p>This option creates a <code>.wants</code> symlink in the given target that exists statelessly without the need for running <code>systemctl enable</code>. The <code>[Install]</code> section described in <code>systemd.unit(5)</code> however is not supported because it is a stateful process that does not fit well into the NixOS design.</p> <p>Type: list of string matching the pattern [a-zA-Z0-9@%:_.\\-]+[.](service|socket|device|mount|automount|swap|target|path|timer|scope|slice)</p> <p>Default:</p> <pre><code>[ ]\n</code></pre> <p>Declared by:  - \\","text":""},{"location":"reference/cli/","title":"CLI Commands","text":"<p>The basic command looks like this:</p> <pre><code>nix run 'github:numtide/system-manager' -- switch --flake . --sudo\n</code></pre> <p>This is the most common scenario you'll use.</p>"},{"location":"reference/cli/#command-line-options","title":"Command-line Options","text":""},{"location":"reference/cli/#init","title":"init","text":"<p>This subcommand creates two initial files for use with System Manager, a fully-functional <code>flake.nix</code>, and a <code>system.nix</code> file that contains skeleton code.</p>"},{"location":"reference/cli/#command-line-options_1","title":"Command line options","text":"<p>path: The path where to create the files. If the path doesn't exist, it will be created.</p>"},{"location":"reference/cli/#example","title":"Example","text":"<pre><code>nix run 'github:numtide/system-manager' -- init\n</code></pre> <p>This will create the initial files in <code>~/.config/system-manager</code> by default.</p> <pre><code>nix run 'github:numtide/system-manager' -- init --path='/home/ubuntu/system-manager'\n</code></pre> <p>This will create the initial files in <code>/home/ubuntu/system-manager</code>.</p> <p>Note</p> <p>System Manager requires flakes to be enabled in <code>/etc/nix/nix.conf</code>. See Enabling Flakes for setup instructions.</p>"},{"location":"reference/cli/#switch","title":"switch","text":"<p>The <code>switch</code> subcommand builds and activates your configuration immediately, making it both the current running configuration and the default for future boots. Use it whenever you want to apply your changes.</p> <p>Note: Rollbacks are not yet implemented.</p> <p>--flake: Specifies a flake to use for configuration. Defaults to <code>~/.config/system-manager</code> if not provided.</p> <p>--sudo: Specifies that System Manager can use sudo.</p>"},{"location":"reference/cli/#register","title":"register","text":"<p>The <code>register</code> subcommand builds and registers a System Manager configuration, but does not activate it. Compare this to <code>switch</code>, which does everything register does, but then activates it.</p>"},{"location":"reference/cli/#build","title":"build","text":"<p>The <code>build</code> subcommand builds everything needed for a switch, but does not register it.</p>"},{"location":"reference/cli/#deactivate","title":"deactivate","text":"<p>The <code>deactivate</code> deactivates System Manager.</p>"},{"location":"reference/cli/#pre-populate","title":"pre-populate","text":"<p>The <code>pre-populate</code> subcommand puts all files defined by the given generation in place, but does not start the services. This is useful in scripts.</p>"},{"location":"reference/cli/#sudo","title":"sudo","text":"<p>The <code>sudo</code> subcommand grants sudo access to System Manager, while running under the current user. All created files will be owned by the current user.</p>"},{"location":"reference/configuration/","title":"Configuration","text":"<p>This guide covers how to organize your System Manager project and recommended workflows for different scenarios.</p>"},{"location":"reference/configuration/#setting-up-a-folder-and-file-structure","title":"Setting up a folder and file structure","text":"<p>Before you begin with System Manager, you'll need to decide on your folder structure.</p> <p>Note</p> <p>If you prefer, you can host all your System Manager configuration files on a remote Git repo (such as GitHub), and then you don't need to worry about where on your computer to store the files. For more info, see Working with Remote Flakes.</p> <p>Technically, you are free to set up your folders and files however you like; System Manager does not enforce any rules, thus allowing you full flexibility. Below are simply some options that we recommend.</p> <p>Tip</p> <p>While you are free to have different System Manager <code>.nix</code> files scattered throughout your system, we recommend, if possible, keeping them in a single location simply for organizational purposes. But again, this is just a recommendation and you're not bound by any such rules.</p>"},{"location":"reference/configuration/#deciding-on-a-folder-structure","title":"Deciding on a folder structure","text":"<p>You'll need to choose where your System Manager configuration will live. Here are two main organizational patterns we recommend.</p> <ul> <li>Option A: A single folder for all your configuration</li> </ul> <p>A single folder keeps everything together. This offers a clean long-term solution, along with easy version control. It's also convenient for replicating between machines.</p> <ul> <li>Option B: A separate folder for each use case</li> </ul> <p>While not as common, it's entirely possible to organize your System Manager configuration into multiple independent folders, each focused on a specific use case. In this model, you treat each configuration as its own standalone unit, often stored in its own Git repository.</p> <p>For example, you might keep:</p> <ul> <li> <p>a dedicated configuration folder strictly for managing nginx,</p> </li> <li> <p>another for custom systemd services,</p> </li> <li> <p>another for developer tools,</p> </li> <li> <p>and yet another for monitoring and observability packages.</p> </li> </ul> <p>In this manner, you can then build up a system by picking and choosing which services you need for a particular machine, and pull each one down from GitHub.</p> <p>To make this happen, however, requires careful consideration as we discuss later.</p>"},{"location":"reference/configuration/#choosing-a-location","title":"Choosing a location","text":""},{"location":"reference/configuration/#option-1-your-personal-config-folder","title":"Option 1: Your personal ~/.config folder","text":"<p>If you're managing a system yourself and only you will be using it, one possibility is to put the files in <code>~/.config/system-manager</code>.</p> <p>This approach keeps everything scoped to you and avoids having to place files under <code>/etc</code> and, perhaps most importantly, avoids having to use sudo. Here's an example layout:</p> <pre><code>~/.config/system-manager/\n  flake.nix\n  modules/\n    default.nix\n</code></pre> <p>Tip</p> <p>Avoid this location if multiple people use the machine or if this configuration is meant to be shared with a team. Home-directory paths are user-specific and may not make sense across machines.</p>"},{"location":"reference/configuration/#option-2-a-shared-etcsystem-manager-folder-recommended-for-multi-user-or-organizational-setups","title":"Option 2: A shared <code>/etc/system-manager</code> folder (Recommended for multi-user or organizational setups)","text":"<p>If you are:</p> <ul> <li> <p>managing multiple machines,</p> </li> <li> <p>part of a team,</p> </li> <li> <p>deploying configurations in a corporate or server environment,</p> </li> <li> <p>or simply want a clear system-level location,</p> </li> </ul> <p>then <code>/etc/system-manager</code> is a great choice. Among the advantages are consistency across all machines; standard within an organization; and treating system manager as a system-level tool rather than a personal configuration. Here's an example layout:</p> <pre><code>/etc/system-manager/\n  flake.nix\n  modules/\n    default.nix\n    services.nix\n</code></pre>"},{"location":"reference/configuration/#choosing-a-file-structure","title":"Choosing a file structure","text":"<p>After choosing where your configuration lives, you must decide how to structure the files inside it. And note that while System Manager does not enforce any rules, we do recommend you maintain consistency, especially if you have multiple locations on your computer where you store System Manager <code>.nix</code> files.</p> <p>Essentially, you have two options:</p> <ul> <li> <p>A single <code>flake.nix</code> file</p> </li> <li> <p>A reusable <code>flake.nix</code> file with one or more separate configuration files that describe what the system will look like.</p> </li> </ul> <p>Within Option B, you can also use our open-source Blueprint product to help you manage your files, which we'll cover shortly.</p>"},{"location":"reference/configuration/#option-a-single-flakenix-file","title":"Option A: Single <code>flake.nix</code> file","text":"<p>This configuration is ideal for:</p> <ul> <li> <p>Small, simple setups</p> </li> <li> <p>Demos and experiments</p> </li> <li> <p>One-off configurations</p> </li> </ul> <p>Drawback: This approach doesn't scale well once you need multiple services, multiple hosts, or reusable modules.</p>"},{"location":"reference/configuration/#option-b-flake-file-with-one-or-more-configuration-files","title":"Option B: Flake file with one or more configuration files","text":"<p>This is the structure used by most production setups and by NixOS itself. Your arrangement might look like:</p> <pre><code>system-manager/\n  flake.nix\n  modules/\n    default.nix\n    services.nix\n    users.nix\n</code></pre> <p>Or, perhaps you might have separate services, one per file:</p> <pre><code>system-manager/\n  flake.nix\n  modules/\n    default.nix\n    service-1.nix\n    service-2.nix\n    users.nix\n</code></pre> <p>This also lends itself well to having multiple \"recipes\". For example, you might want to add nginx and postgres to your system. You might have them preconfigured somewhere, and simply \"drop\" them in like so:</p> <pre><code>system-manager/\n  flake.nix\n  modules/\n    default.nix\n    service-1.nix\n    service-2.nix\n    users.nix\n    nginx.nix\n    postgres.nix\n</code></pre> <p>Tip</p> <p>This is the approach we use in our examples in this document. That way each isolated \"recipe\" is repeatable and can be re-used across multiple systems.</p>"},{"location":"reference/configuration/#dealing-with-conflicting-nix-files","title":"Dealing with conflicting <code>.nix</code> files","text":"<p>If you have multiple flakes throughout your computer, you can run into a situation where one might install some software, and the other might install a different software -- but uninstall what was in the other configuration.</p> <p>For example; suppose you have one configuration file that includes this list of apps:</p> <pre><code>    environment = {\n      systemPackages = [\n        pkgs.bat\n        pkgs.nginx\n        pkgs.mysql84\n      ];\n</code></pre> <p>And you run System Manager, which installs the three apps.</p> <p>Then you separately in another folder have another flake with a different configuration and set of apps:</p> <pre><code>    environment = {\n      systemPackages = [\n        pkgs.hello\n        pkgs.postgresql_18\n        pkgs.vscode\n      ];\n</code></pre> <p>Then in this folder your run System Manager.</p> <p>System Manager does not track files, and see this as a changed configuration:</p> <ul> <li>The configuration no longer has <code>bat</code>, <code>nginx</code>, and <code>mysql84</code>.</li> <li>The configuration does have <code>hello</code>, <code>postgresql_18</code>, and <code>vscode</code>.</li> </ul> <p>The end result is that System Manager will remove <code>bat</code>, <code>nginx</code>, and <code>mysql84</code>, and install <code>hello</code>, <code>postgresql_18</code>, and <code>vscode</code>.</p> <p>The fix to this problem is to instead have a single main <code>flake.nix</code> file, which loads all of the different <code>.nix</code> files, allowing you to run System Manager from a single location.</p> <p>This is because Nix has the ability to merge together objects in separate files into a single object; the above would then merge into:</p> <pre><code>      systemPackages = [\n        pkgs.bat\n        pkgs.nginx\n        pkgs.mysql84\n        pkgs.hello\n        pkgs.postgresql_18\n        pkgs.vscode\n      ];\n</code></pre> <p>We describe this technique in the Multi-file Configuration tutorial.</p>"},{"location":"reference/configuration/#letting-system-manager-manage-etcnixnixconf","title":"Letting System Manager manage <code>/etc/nix/nix.conf</code>","text":"<p>System Manager can optionally manage your <code>/etc/nix/nix.conf</code> file for you.</p> <p>If you have an existing <code>/etc/nix/nix.conf</code> file, you'll need to delete it if you want System Manager to manage the file; then run System Manager again. From that point on System Manager will manage the file for you, and you should not make changes to it.</p> <p>Instead, you'll put the changes in one of your <code>.nix</code> files you'll be building to configure System Manager.</p>"},{"location":"reference/configuration/#recommended-workflow-for-starting-out","title":"Recommended Workflow for Starting Out","text":"<p>As described previously, System Manager wants to manage your <code>/etc/nix/nix.conf</code> file for you, after which you can instead place your configurations directly in the <code>flake.nix</code> file, including specifying experimental features.</p> <p>To do so requires a careful set of steps. Follow these steps precisely when starting out with a fresh system.</p> <p>Note</p> <p>We will first run System Manager to create an initial <code>flake.nix</code> and <code>system.nix</code> file; we will then delete the <code>/etc/nix/nix.conf</code> file, and instead add the flags to the <code>flake.nix</code> file. Then we will run System Manager again to start managing your system, including the <code>/etc/nix/nix.conf</code> file.</p> <ol> <li>Temporarily run System Manager with <code>init</code> with experimental features enabled by including the following line in <code>/etc/nix/nix.conf</code>; this way <code>init</code> will generate a <code>flake.nix</code> file:</li> </ol> <pre><code>experimental-features = nix-command flakes\n</code></pre> <p>And then running System Manager with the init subcommand:</p> <pre><code>nix run 'github:numtide/system-manager' -- init\n</code></pre> <p>(For this step, do not simply add the flag for experimental features; otherwise <code>init</code> won't create the <code>flake.nix</code> file.)</p> <ol> <li>Under <code>~/.config/system-manager</code>, edit the <code>flake.nix</code> file, replacing this line:</li> </ol> <pre><code>  modules = [ ./system.nix ];\n</code></pre> <p>with this:</p> <pre><code>modules = [\n    {\n        nix.settings.experimental-features = \"nix-command flakes\";\n    }\n    ./system.nix\n];\n</code></pre> <ol> <li>Delete the <code>/etc/nix/nix.conf</code> file, optionally backing it up first:</li> </ol> <pre><code>sudo cp /etc/nix/nix.conf /etc/nix/nix_old # optional\nsudo rm /etc/nix/nix.conf\n</code></pre> <ol> <li>Run System Manager to initialize your system, with the experimental flags set this one time in the command-line:</li> </ol> <pre><code>cd ~/.config/system-manager\nnix run 'github:numtide/system-manager' --extra-experimental-features 'nix-command flakes' -- switch --sudo\n</code></pre> <p>System Manager is now managing your system for you, including the <code>/etc/nix/nix.conf</code> file. And experimental features are required and turned on through the <code>flake.nix</code> file, meaning you do not need to include the <code>--extra-experimental-features</code> option when you run System Manager:</p> <pre><code>nix run 'github:numtide/system-manager' -- switch --sudo\n</code></pre> <p>Next, if you want to make sure experimental features are always on, you can add it to your flake.</p>"},{"location":"reference/configuration/#using-system-manager-in-a-non-interactive-setting","title":"Using System Manager in a non-Interactive Setting","text":"<p>If you're running System Manager in a non-interative script, you might run into a problem with the four questions presented when you first run it:</p> <ul> <li> <p>Do you want to allow configuration setting 'extra-substituters' to be set to 'https://cache.numtide.com' (y/N)?</p> </li> <li> <p>Do you want to permanently mark this value as trusted (y/N)?</p> </li> <li> <p>Do you want to allow configuration setting 'extra-trusted-public-keys' to be set to 'niks3.numtide.com-1:DTx8wZduET09hRmMtKdQDxNNthLQETkc/yaX7M4qK0g=' (y/N)?</p> </li> <li> <p>Do you want to permanently mark this value as trusted (y/N)?</p> </li> </ul> <p>The reason for these questions is Numtide has made pre-built binary versions of System Manager available from our cache, which speeds up performance since your system doesn't have to build System Manager from source. However, this triggers Nix to ask these four questions. You'll most likely want to answer \"y\" to all four.</p> <p>But doing so can cause problems with a non-interactive script. To run System Manager in a script, you can simply add the <code>--accept-flake-config</code> option like so:</p> <pre><code>nix run 'github:numtide/system-manager' --accept-flake-config --extra-experimental-features 'nix-command flakes' -- switch --flake . --sudo\n</code></pre> <p>If you like, you can add these settings into your flake file, such as in the following:</p> <pre><code>{\n  description = \"Standalone System Manager configuration\";\n\n  inputs = {\n    nixpkgs.url = \"github:nixos/nixpkgs/nixos-unstable\";\n    system-manager = {\n      url = \"github:numtide/system-manager\";\n      inputs.nixpkgs.follows = \"nixpkgs\";\n    };\n  };\n\n  outputs =\n    {\n      self,\n      nixpkgs,\n      system-manager,\n      ...\n    }:\n    {\n      systemConfigs.default = system-manager.lib.makeSystemConfig {\n        modules = [\n            {\n                nix.settings.experimental-features = \"nix-command flakes\";\n                nix.settings.extra-substituters = https://cache.numtide.com;\n                nix.settings.extra-trusted-public-keys = niks3.numtide.com-1:DTx8wZduET09hRmMtKdQDxNNthLQETkc/yaX7M4qK0g=;\n            }\n            ./glow.nix\n        ];\n      };\n    };\n}\n</code></pre> <p>Remember, however, the flake shows what the system looks like after System Manager runs. That means these changes won't affect the first run of System Manager, which in this case is likely through a script. As such, the first time you run System Manager, you'll still need the <code>--accept-flake-config</code> option. Then on subsequent runs you don't need the <code>--accept-flake-config</code> option.</p>"},{"location":"reference/configuration/#recommended-workflow-if-you-already-have-your-nix-files","title":"Recommended Workflow if You Already Have Your Nix Files","text":"<p>If you already have your <code>.nix</code> files, you don't need to run the <code>init</code> subcommand. Instead, we recommend the following if you're starting out on a clean system:</p> <ol> <li> <p>Remove the <code>/etc/nix/nix.conf</code> file. Then, when you run System Manager the first time, System Manager will take control managing this file for you. You can then place any configuration you previously had in the <code>/etc/nix/nix.conf</code> file in your <code>.nix</code> files.</p> </li> <li> <p>Run System Manager the first time, and you'll be ready to go.</p> </li> </ol> <p>As an example, here's a starting <code>flake.nix</code> file:</p> <p>flake.nix <pre><code>{\n  description = \"Standalone System Manager configuration\";\n\n  inputs = {\n    nixpkgs.url = \"github:nixos/nixpkgs/nixos-unstable\";\n    system-manager = {\n      url = \"github:numtide/system-manager\";\n      inputs.nixpkgs.follows = \"nixpkgs\";\n    };\n  };\n\n  outputs =\n    {\n      self,\n      nixpkgs,\n      system-manager,\n      ...\n    }:\n    {\n      systemConfigs.default = system-manager.lib.makeSystemConfig {\n        modules = [\n            {\n                nix.settings.experimental-features = \"nix-command flakes\";\n            }\n            ./glow.nix\n        ];\n      };\n    };\n}\n</code></pre></p> <p>Notice that we've included in the modules list an object that sets experimental features, turning on flakes.</p> <p>Now here's the <code>glow.nix</code> file referenced above; it simply installs the <code>glow</code> command, which is for displaying markdown files in a shell:</p> <p>glow.nix</p> <pre><code>{ pkgs, ... }:\n{\n  config = {\n    nixpkgs.hostPlatform = \"x86_64-linux\";\n\n    environment.systemPackages = with pkgs; [\n        glow\n    ];\n  };\n}\n</code></pre> <p>Go ahead and delete <code>/etc/nix/nix.conf</code>:</p> <pre><code>sudo rm /etc/nix/nix.conf\n</code></pre> <p>And now run System Manager. Because you removed <code>nix.conf</code>, you'll need to turn on experimental features as a command-line option.</p> <pre><code>nix run 'github:numtide/system-manager' --extra-experimental-features 'nix-command flakes' -- switch --flake . --sudo\n</code></pre> <p>After System Manager runs, you'll have the changes in place (in this case the <code>glow</code> command added), and you'll be able to manage features, including experimental features, through your flake. And because you turned on the flakes experimental features, future runs of System Manager no longer need the flags. You can simply run:</p> <pre><code>nix run 'github:numtide/system-manager' -- switch --flake . --sudo\n</code></pre>"},{"location":"reference/modules/","title":"Module Options Reference","text":"<p>This reference documents all configuration options available in System Manager modules.</p>"},{"location":"reference/modules/#nixpkgs","title":"nixpkgs","text":"<p>Options for configuring the Nix package set.</p>"},{"location":"reference/modules/#nixpkgshostplatform","title":"nixpkgs.hostPlatform","text":"<p>Type: <code>string</code> or <code>attrset</code></p> <p>Default: (required)</p> <p>Example: <code>\"x86_64-linux\"</code></p> <p>The platform for which packages are built. This option must be set in every configuration.</p>"},{"location":"reference/modules/#nixpkgsbuildplatform","title":"nixpkgs.buildPlatform","text":"<p>Type: <code>string</code></p> <p>Default: Value of <code>nixpkgs.hostPlatform</code></p> <p>Example: <code>\"x86_64-linux\"</code></p> <p>The platform on which packages are built. Used for cross-compilation.</p>"},{"location":"reference/modules/#nixpkgsoverlays","title":"nixpkgs.overlays","text":"<p>Type: <code>list of overlays</code></p> <p>Default: <code>[]</code></p> <p>Overlays to apply to the package set.</p>"},{"location":"reference/modules/#nixpkgsconfig","title":"nixpkgs.config","text":"<p>Type: <code>attrset</code></p> <p>Default: <code>{}</code></p> <p>Configuration passed to nixpkgs when instantiating the package set (e.g., <code>{ allowUnfree = true; }</code>).</p>"},{"location":"reference/modules/#environment","title":"environment","text":"<p>Options for system environment configuration.</p>"},{"location":"reference/modules/#environmentsystempackages","title":"environment.systemPackages","text":"<p>Type: <code>list of packages</code></p> <p>Default: <code>[]</code></p> <p>Packages to install system-wide. Installed packages are available at <code>/run/system-manager/sw/bin/</code>.</p> <pre><code>environment.systemPackages = with pkgs; [\n  vim\n  git\n  htop\n];\n</code></pre>"},{"location":"reference/modules/#environmentpathstolink","title":"environment.pathsToLink","text":"<p>Type: <code>list of strings</code></p> <p>Default: <code>[ \"/bin\" ]</code></p> <p>Paths to link from packages into the system environment.</p>"},{"location":"reference/modules/#environmentetc","title":"environment.etc","text":"<p>Manages files under <code>/etc</code>. Each attribute creates a file at <code>/etc/&lt;name&gt;</code>.</p> <p>Type: <code>attrset of submodules</code></p> <p>Default: <code>{}</code></p> <pre><code>environment.etc.\"myapp/config.conf\" = {\n  text = \"setting = value\";\n  mode = \"0644\";\n};\n</code></pre>"},{"location":"reference/modules/#environmentetcnameenable","title":"environment.etc.{name}.enable","text":"<p>Type: <code>boolean</code></p> <p>Default: <code>true</code></p> <p>Whether to create this file.</p>"},{"location":"reference/modules/#environmentetcnametext","title":"environment.etc.{name}.text","text":"<p>Type: <code>null or string</code></p> <p>Default: <code>null</code></p> <p>Content of the file. Mutually exclusive with <code>source</code>.</p>"},{"location":"reference/modules/#environmentetcnamesource","title":"environment.etc.{name}.source","text":"<p>Type: <code>path</code></p> <p>Default: Derived from <code>text</code> if set</p> <p>Path to the source file.</p>"},{"location":"reference/modules/#environmentetcnametarget","title":"environment.etc.{name}.target","text":"<p>Type: <code>string</code></p> <p>Default: Attribute name</p> <p>Target path relative to <code>/etc</code>.</p>"},{"location":"reference/modules/#environmentetcnamemode","title":"environment.etc.{name}.mode","text":"<p>Type: <code>string</code></p> <p>Default: <code>\"symlink\"</code></p> <p>Example: <code>\"0644\"</code></p> <p>File mode. Use <code>\"symlink\"</code> to create a symlink to the Nix store, or an octal mode (e.g., <code>\"0644\"</code>) to copy the file with that mode.</p> <p>Octal modes consist of three digits representing owner, group, and others. Each digit is the sum of: 4 (read), 2 (write), 1 (execute).</p> Mode Meaning <code>\"0644\"</code> Owner read/write, everyone else read-only <code>\"0755\"</code> Owner full access, everyone else read/execute <code>\"0600\"</code> Owner read/write, no access for others <code>\"0400\"</code> Owner read-only, no access for others"},{"location":"reference/modules/#environmentetcnameuid","title":"environment.etc.{name}.uid","text":"<p>Type: <code>integer</code></p> <p>Default: <code>0</code></p> <p>Numeric user ID for file ownership. Only applies when <code>mode</code> is not <code>\"symlink\"</code>.</p>"},{"location":"reference/modules/#environmentetcnamegid","title":"environment.etc.{name}.gid","text":"<p>Type: <code>integer</code></p> <p>Default: <code>0</code></p> <p>Numeric group ID for file ownership. Only applies when <code>mode</code> is not <code>\"symlink\"</code>.</p>"},{"location":"reference/modules/#environmentetcnameuser","title":"environment.etc.{name}.user","text":"<p>Type: <code>string</code></p> <p>Default: <code>\"+&lt;uid&gt;\"</code></p> <p>User name for file ownership. Takes precedence over <code>uid</code>. Only applies when <code>mode</code> is not <code>\"symlink\"</code>.</p>"},{"location":"reference/modules/#environmentetcnamegroup","title":"environment.etc.{name}.group","text":"<p>Type: <code>string</code></p> <p>Default: <code>\"+&lt;gid&gt;\"</code></p> <p>Group name for file ownership. Takes precedence over <code>gid</code>. Only applies when <code>mode</code> is not <code>\"symlink\"</code>.</p> <p>Choosing between numeric IDs and names</p> <p>Use <code>uid</code>/<code>gid</code> when you need consistent ownership across systems where user/group names might differ. Use <code>user</code>/<code>group</code> for readability when the names are guaranteed to exist.</p>"},{"location":"reference/modules/#systemd","title":"systemd","text":"<p>Options for systemd unit management.</p>"},{"location":"reference/modules/#systemdpackage","title":"systemd.package","text":"<p>Type: <code>package</code></p> <p>Default: <code>pkgs.systemdMinimal</code></p> <p>The systemd package to use.</p>"},{"location":"reference/modules/#systemdglobalenvironment","title":"systemd.globalEnvironment","text":"<p>Type: <code>attrset of (null or string or path or package)</code></p> <p>Default: <code>{}</code></p> <p>Example: <code>{ TZ = \"CET\"; }</code></p> <p>Environment variables passed to all systemd units.</p>"},{"location":"reference/modules/#systemdenablestrictshellchecks","title":"systemd.enableStrictShellChecks","text":"<p>Type: <code>boolean</code></p> <p>Default: <code>false</code></p> <p>Run shellcheck on generated unit scripts.</p>"},{"location":"reference/modules/#systemdservices","title":"systemd.services","text":"<p>Defines systemd service units.</p> <p>Type: <code>attrset of service submodules</code></p> <p>Default: <code>{}</code></p> <pre><code>systemd.services.myservice = {\n  description = \"My Service\";\n  wantedBy = [ \"system-manager.target\" ];\n  serviceConfig = {\n    Type = \"oneshot\";\n    ExecStart = \"${pkgs.hello}/bin/hello\";\n  };\n};\n</code></pre> <p>Common service options:</p> Option Type Description <code>enable</code> boolean Whether to enable this service (default: <code>true</code>) <code>description</code> string Service description <code>wantedBy</code> list of strings Targets that want this service <code>after</code> list of strings Units this service starts after <code>requires</code> list of strings Units this service requires <code>serviceConfig</code> attrset systemd <code>[Service]</code> section options <code>script</code> string Shell script to execute <code>environment</code> attrset Environment variables for this service <code>path</code> list of packages Packages to add to <code>PATH</code> <p>Starting services on activation</p> <p>Use <code>wantedBy = [ \"system-manager.target\" ];</code> to start a service when System Manager activates.</p>"},{"location":"reference/modules/#systemdtimers","title":"systemd.timers","text":"<p>Defines systemd timer units for scheduled tasks.</p> <p>Type: <code>attrset of timer submodules</code></p> <p>Default: <code>{}</code></p> <pre><code>systemd.timers.mytimer = {\n  wantedBy = [ \"timers.target\" ];\n  timerConfig = {\n    OnCalendar = \"daily\";\n    Persistent = true;\n  };\n};\n</code></pre> <p>Common timer options:</p> Option Type Description <code>enable</code> boolean Whether to enable this timer <code>description</code> string Timer description <code>wantedBy</code> list of strings Targets that want this timer <code>timerConfig</code> attrset systemd <code>[Timer]</code> section options"},{"location":"reference/modules/#systemdsockets","title":"systemd.sockets","text":"<p>Defines systemd socket units for socket activation.</p> <p>Type: <code>attrset of socket submodules</code></p> <p>Default: <code>{}</code></p>"},{"location":"reference/modules/#systemdtargets","title":"systemd.targets","text":"<p>Defines systemd target units.</p> <p>Type: <code>attrset of target submodules</code></p> <p>Default: <code>{}</code></p> <p>Note</p> <p>System Manager provides a <code>system-manager.target</code> that is wanted by <code>default.target</code>.</p>"},{"location":"reference/modules/#systemdpaths","title":"systemd.paths","text":"<p>Defines systemd path units for path-based activation.</p> <p>Type: <code>attrset of path submodules</code></p> <p>Default: <code>{}</code></p>"},{"location":"reference/modules/#systemdmounts","title":"systemd.mounts","text":"<p>Defines systemd mount units.</p> <p>Type: <code>list of mount submodules</code></p> <p>Default: <code>[]</code></p> <p>Note</p> <p>This is a list (not attrset) because systemd requires mount unit names to match the mount path.</p>"},{"location":"reference/modules/#systemdautomounts","title":"systemd.automounts","text":"<p>Defines systemd automount units.</p> <p>Type: <code>list of automount submodules</code></p> <p>Default: <code>[]</code></p>"},{"location":"reference/modules/#systemdslices","title":"systemd.slices","text":"<p>Defines systemd slice units for resource management.</p> <p>Type: <code>attrset of slice submodules</code></p> <p>Default: <code>{}</code></p>"},{"location":"reference/modules/#systemdgenerators","title":"systemd.generators","text":"<p>Defines systemd generators.</p> <p>Type: <code>attrset of paths</code></p> <p>Default: <code>{}</code></p> <p>Example: <code>{ systemd-gpt-auto-generator = \"/dev/null\"; }</code></p> <p>Creates symlinks from <code>/etc/systemd/system-generators/&lt;name&gt;</code> to the specified path.</p>"},{"location":"reference/modules/#systemdshutdown","title":"systemd.shutdown","text":"<p>Defines systemd shutdown executables.</p> <p>Type: <code>attrset of paths</code></p> <p>Default: <code>{}</code></p> <p>Creates symlinks from <code>/etc/systemd/system-shutdown/&lt;name&gt;</code> to the specified path.</p>"},{"location":"reference/modules/#systemdtmpfiles","title":"systemd.tmpfiles","text":"<p>Manages temporary files and directories via systemd-tmpfiles.</p>"},{"location":"reference/modules/#systemdtmpfilesrules","title":"systemd.tmpfiles.rules","text":"<p>Type: <code>list of strings</code></p> <p>Default: <code>[]</code></p> <p>Example: <code>[ \"d /tmp 1777 root root 10d\" ]</code></p> <p>Rules in tmpfiles.d(5) format.</p>"},{"location":"reference/modules/#systemdtmpfilessettings","title":"systemd.tmpfiles.settings","text":"<p>Type: <code>nested attrset</code></p> <p>Default: <code>{}</code></p> <p>Structured tmpfiles configuration.</p> <pre><code>systemd.tmpfiles.settings.\"10-myapp\" = {\n  \"/var/lib/myapp\".d = {\n    mode = \"0755\";\n    user = \"root\";\n    group = \"root\";\n  };\n};\n</code></pre> <p>Each entry supports:</p> Option Type Default Description <code>type</code> string Key name Operation type (see tmpfiles.d(5)) <code>mode</code> string <code>\"-\"</code> File mode <code>user</code> string <code>\"-\"</code> Owner user <code>group</code> string <code>\"-\"</code> Owner group <code>age</code> string <code>\"-\"</code> Cleanup age <code>argument</code> string <code>\"\"</code> Type-specific argument"},{"location":"reference/modules/#systemdtmpfilespackages","title":"systemd.tmpfiles.packages","text":"<p>Type: <code>list of packages</code></p> <p>Default: <code>[]</code></p> <p>Packages containing tmpfiles.d rules in <code>lib/tmpfiles.d/*.conf</code>.</p>"},{"location":"reference/modules/#networking","title":"networking","text":""},{"location":"reference/modules/#networkingenableipv6","title":"networking.enableIPv6","text":"<p>Type: <code>boolean</code></p> <p>Default: <code>true</code></p> <p>Whether to enable IPv6 support.</p>"},{"location":"reference/modules/#system-manager","title":"system-manager","text":""},{"location":"reference/modules/#system-managerallowanydistro","title":"system-manager.allowAnyDistro","text":"<p>Type: <code>boolean</code></p> <p>Default: <code>false</code></p> <p>Bypass distribution compatibility checks. Enable this to use System Manager on untested distributions.</p>"},{"location":"reference/modules/#see-also","title":"See Also","text":"<ul> <li>Getting Started Tutorial - Learn module basics</li> <li>First Service Tutorial - Create your first systemd service</li> <li>systemd.exec(5) - Service execution options</li> <li>tmpfiles.d(5) - Tmpfiles format</li> </ul>"},{"location":"reference/supported-platforms/","title":"Supported Platforms","text":"<p>System Manager runs on Linux systems that use systemd for service management.</p>"},{"location":"reference/supported-platforms/#tested-platforms","title":"Tested Platforms","text":"Platform Status Notes Ubuntu 22.04+ Tested Primary development platform Ubuntu on WSL2 Tested Windows Subsystem for Linux NixOS Tested Works alongside existing NixOS configuration Debian Community Should work; similar to Ubuntu Fedora Community Should work; uses systemd Arch Linux Community Should work; uses systemd"},{"location":"reference/supported-platforms/#requirements","title":"Requirements","text":""},{"location":"reference/supported-platforms/#hardware","title":"Hardware","text":"<ul> <li>Disk Space: Minimum 12GB, recommended 16GB+</li> <li>Memory: Sufficient for Nix builds (2GB+ recommended)</li> </ul>"},{"location":"reference/supported-platforms/#software","title":"Software","text":"<ul> <li>Linux kernel: Any recent version with systemd support</li> <li>Init system: systemd (required)</li> <li>Nix: System-wide multi-user installation with flakes enabled</li> </ul>"},{"location":"reference/supported-platforms/#platform-detection","title":"Platform Detection","text":"<p>System Manager checks the platform at activation time. By default, it only allows activation on Ubuntu and NixOS. This is controlled by the <code>assertions.osChecks</code> option.</p>"},{"location":"reference/supported-platforms/#enabling-other-distributions","title":"Enabling Other Distributions","text":"<p>To enable System Manager on other distributions, add this to your configuration:</p> <pre><code>{\n  config = {\n    assertions.osChecks = false;\n  };\n}\n</code></pre> <p>Or specify allowed OS IDs explicitly:</p> <pre><code>{\n  config = {\n    assertions.osRelease.id = [ \"ubuntu\" \"debian\" \"fedora\" ];\n  };\n}\n</code></pre>"},{"location":"reference/supported-platforms/#limitations","title":"Limitations","text":""},{"location":"reference/supported-platforms/#not-supported","title":"Not Supported","text":"<ul> <li>Non-systemd systems: Systems using OpenRC, runit, or other init systems</li> <li>macOS: System Manager is Linux-only</li> <li>BSD: Not supported</li> <li>Per-user Nix installations: System Manager requires system-wide Nix</li> </ul>"},{"location":"reference/supported-platforms/#known-issues","title":"Known Issues","text":"<ul> <li>SELinux may require additional configuration (see Troubleshooting)</li> <li>Some NixOS-specific modules are not available on non-NixOS systems</li> </ul>"},{"location":"reference/supported-platforms/#see-also","title":"See Also","text":"<ul> <li>Installation - How to install Nix and System Manager</li> <li>FAQ - Troubleshooting and best practices</li> </ul>"},{"location":"tutorials/first-service/","title":"Your First Systemd Service","text":"<p>This tutorial walks you through creating and managing a systemd service with System Manager.</p>"},{"location":"tutorials/first-service/#prerequisites","title":"Prerequisites","text":"<ul> <li>System Manager initialized (see Getting Started)</li> <li>Basic familiarity with Nix syntax</li> </ul>"},{"location":"tutorials/first-service/#what-youll-build","title":"What You'll Build","text":"<p>A simple \"hello world\" systemd service that runs when System Manager activates your configuration.</p>"},{"location":"tutorials/first-service/#step-1-create-a-service-module","title":"Step 1: Create a Service Module","text":"<p>Create a file called <code>hello-service.nix</code> in your <code>~/.config/system-manager/</code> folder:</p> <pre><code>{ lib, pkgs, ... }:\n{\n  config = {\n    nixpkgs.hostPlatform = \"x86_64-linux\";\n\n    systemd.services.say-hello = {\n      description = \"say-hello\";\n      enable = true;\n      wantedBy = [ \"system-manager.target\" ];\n      serviceConfig = {\n        Type = \"oneshot\";\n        RemainAfterExit = true;\n      };\n      script = ''\n        ${lib.getBin pkgs.hello}/bin/hello\n      '';\n    };\n  };\n}\n</code></pre> <p>Let's break down what each part does:</p> <ul> <li><code>systemd.services.say-hello</code>: Creates a service named \"say-hello\".</li> <li><code>enable = true</code>: Activates the service.</li> <li><code>wantedBy = [ \"system-manager.target\" ]</code>: Starts the service when System Manager activates.</li> <li><code>Type = \"oneshot\"</code>: Runs once and exits.</li> <li><code>RemainAfterExit = true</code>: Keeps the service marked as \"active\" after the script finishes.</li> <li><code>script</code>: The actual command to run.</li> </ul>"},{"location":"tutorials/first-service/#step-2-add-the-module-to-your-flake","title":"Step 2: Add the Module to Your Flake","text":"<p>Edit your <code>flake.nix</code> and add the new module:</p> <pre><code>modules = [\n    ./system.nix\n    ./hello-service.nix\n];\n</code></pre>"},{"location":"tutorials/first-service/#step-3-apply-the-configuration","title":"Step 3: Apply the Configuration","text":"<p>Run System Manager to activate your new service:</p> <pre><code>nix run 'github:numtide/system-manager' -- switch --flake . --sudo\n</code></pre>"},{"location":"tutorials/first-service/#step-4-verify-it-worked","title":"Step 4: Verify It Worked","text":"<p>Check the journal to see if your service ran:</p> <pre><code>journalctl -n 20\n</code></pre> <p>You should see output like:</p> <pre><code>Nov 18 12:12:51 my-ubuntu systemd[1]: Starting say-hello.service - say-hello...\nNov 18 12:12:51 my-ubuntu say-hello-start[3488278]: Hello, world!\nNov 18 12:12:51 my-ubuntu systemd[1]: Finished say-hello.service - say-hello.\n</code></pre>"},{"location":"tutorials/first-service/#step-5-check-the-generated-service-file","title":"Step 5: Check the Generated Service File","text":"<p>System Manager created a systemd unit file at <code>/etc/systemd/system/say-hello.service</code>. You can view it with:</p> <pre><code>cat /etc/systemd/system/say-hello.service\n</code></pre>"},{"location":"tutorials/first-service/#next-steps","title":"Next Steps","text":"<ul> <li>Learn about service configuration options in the reference.</li> <li>See the timer example for scheduled services.</li> <li>Explore the nginx example for a real-world service.</li> </ul>"},{"location":"tutorials/getting-started/","title":"Getting Started","text":"<p>If you've heard of NixOS, you've probably heard that it lets you define your entire system in configuration files and then reproduce that system anywhere with a single command. System Manager brings that same declarative model to other Linux distributions*, with no reinstalling, no switching operating systems, and no special prerequisites beyond having Nix installed.</p> <p>*Presently, System Manager is only tested on Ubuntu, and is limited to only Linux distributions based on systemd.</p>"},{"location":"tutorials/getting-started/#initializing-your-system","title":"Initializing Your System","text":"<p>Before proceeding, ensure you have installed Nix with flakes enabled.</p> <p>To get started with System Manager, run the init subcommand, which will create an initial set of files in the <code>~/.config/system-manager</code> folder:</p> <pre><code>nix run 'github:numtide/system-manager' -- init\n</code></pre> <p>(Remember, the double dash -- signifies that any options following it are passed to the following command, in this case System Manager, rather than to the main command, <code>nix</code>).</p> <p>You might see the following for questions; you can simply answer yes to them:</p> <ul> <li> <p>Do you want to allow configuration setting 'extra-substituters' to be set to 'https://cache.numtide.com' (y/N)?</p> </li> <li> <p>Do you want to permanently mark this value as trusted (y/N)?</p> </li> <li> <p>Do you want to allow configuration setting 'extra-trusted-public-keys' to be set to 'niks3.numtide.com-1:DTx8wZduET09hRmMtKdQDxNNthLQETkc/yaX7M4qK0g=' (y/N)?</p> </li> <li> <p>Do you want to permanently mark this value as trusted (y/N)?</p> </li> </ul> <p>After running the command, you will have the following files in your <code>~/.config/system-manager</code> folder:</p> <ul> <li><code>flake.nix</code> -- A flake entrypoint that loads the <code>system.nix</code> file</li> <li><code>system.nix</code> -- The declarative file that describes what your system should look like.</li> </ul> <p>Tip</p> <p>Because this is your first time running System Manager, Nix will download and build several files, which might take some time. This only happens once, and in the future, System Manager will run very quickly.</p> <p>Here are the contents of the files that were created:</p>"},{"location":"tutorials/getting-started/#flakenix","title":"flake.nix","text":"<pre><code>{\n  description = \"Standalone System Manager configuration\";\n\n  inputs = {\n    # Specify the source of System Manager and Nixpkgs.\n    nixpkgs.url = \"github:nixos/nixpkgs/nixos-unstable\";\n    system-manager = {\n      url = \"github:numtide/system-manager\";\n      inputs.nixpkgs.follows = \"nixpkgs\";\n    };\n  };\n\n  outputs =\n    {\n      self,\n      nixpkgs,\n      system-manager,\n      ...\n    }:\n    let\n      system = \"x86_64-linux\";\n    in\n    {\n      systemConfigs.default = system-manager.lib.makeSystemConfig {\n        # Specify your system configuration modules here, for example,\n        # the path to your system.nix.\n        modules = [ \n            ./system.nix \n        ];\n\n        # Optionally specify extraSpecialArgs and overlays\n      };\n    };\n}\n</code></pre>"},{"location":"tutorials/getting-started/#systemnix","title":"system.nix","text":"<pre><code>{ lib, pkgs, ... }:\n{\n  config = {\n    nixpkgs.hostPlatform = \"x86_64-linux\";\n\n    # Enable and configure services\n    services = {\n      # nginx.enable = true;\n    };\n\n    environment = {\n      # Packages that should be installed on a system\n      systemPackages = [\n        # pkgs.hello\n      ];\n\n      # Add directories and files to `/etc` and set their permissions\n      etc = {\n        # with_ownership = {\n        #   text = ''\n        #     This is just a test!\n        #   '';\n        #   mode = \"0755\";\n        #   uid = 5;\n        #   gid = 6;\n        # };\n        #\n        # with_ownership2 = {\n        #   text = ''\n        #     This is just a test!\n        #   '';\n        #   mode = \"0755\";\n        #   user = \"nobody\";\n        #   group = \"users\";\n        # };\n      };\n    };\n\n    # Enable and configure systemd services\n    systemd.services = { };\n\n    # Configure systemd tmpfile settings\n    systemd.tmpfiles = {\n      # rules = [\n      #   \"D /var/tmp/system-manager 0755 root root -\"\n      # ];\n      #\n      # settings.sample = {\n      #   \"/var/tmp/sample\".d = {\n      #     mode = \"0755\";\n      #   };\n      # };\n    };\n  };\n}\n</code></pre>"},{"location":"tutorials/getting-started/#example-installinguninstalling-apps","title":"Example: Installing/Uninstalling Apps","text":"<p>First, let's create a configuration file that allows for the installation or uninstallation of apps.</p> <p>Tip</p> <p>The idea is that the configuration file describes what the system should look like. Keep that in mind, rather than thinking that the configuration file \"installs software\" or \"uninstalls software.\"</p> <p>To get started, we'll create another <code>.nix</code> file that will install a single app. Then we'll run System Manager and verify it's installed.</p> <p>Then, to demonstrate what System Manager can do, we'll add another line to the configuration file with another app; run System Manager again, and verify its installation once more.</p> <p>Then, after that, we'll remove one of the apps from the configuration file, run System Manager, and verify that the app is no longer installed.</p> <p>This will fully demonstrate the declarative nature of these configuration files.</p> <p>First, in the <code>~/.config/system-manager</code> folder, create a file <code>apps.nix</code> and place the following in it:</p> <pre><code>{ pkgs, ... }:\n{\n  nixpkgs.hostPlatform = \"x86_64-linux\";\n\n  environment.systemPackages = with pkgs; [\n    tldr\n  ];\n}\n</code></pre> <p>This configuration states that the system being configured should have the <code>tldr</code> app present, and if it isn't, System Manager will install it. (Notice how we phrased that! We didn't just say this file installs the app. With <code>.nix</code> files, it's important to get into the mindset that they state what the system should look like.)</p> <p>Now add the file to the modules list in <code>flake.nix</code> by replacing this modules line:</p> <pre><code>-         modules = [ ./system.nix ];\n+         modules = [\n+             ./system.nix\n+             ./apps.nix\n+         ];\n</code></pre> <p>Note: By default, <code>system.nix</code> includes starter code and some commented-out examples, and nothing else. You can leave it in the list; in its original state, it does nothing.</p> <p>Next, we'll run System Manager to apply the configuration.</p> <p>System Manager requires root privileges to modify <code>/etc</code>, manage systemd services, and create system profiles. Use the <code>--sudo</code> flag to run these operations via sudo:</p> <pre><code>nix run 'github:numtide/system-manager' -- switch --flake . --sudo\n</code></pre> <p>After a short moment, the <code>tldr</code> app should be installed on your system.</p> <p>Tip</p> <p>The first time you install software with System Manager, it adds a path to your <code>$PATH</code> variable by creating an entry in <code>/etc/profile.d/</code>. This won't take effect until you log out and back in; or you can source the file like so: <code>source /etc/profile.d/system-manager-path.sh</code> After that, you should find the <code>tldr</code> program: <code>which tldr</code> should yield <code>/run/system-manager/sw/bin//tldr</code>.</p> <p>Now, to demonstrate the declarative feature of System Manager, let's add another app to the list. Here's a fun app called <code>cowsay</code>. Add a single line <code>cowsay</code> to the list passed into <code>systemPackages</code>:</p> <pre><code>{ pkgs, ... }:\n{\n  config = {\n    nixpkgs.hostPlatform = \"x86_64-linux\";\n\n    environment.systemPackages = with pkgs; [\n      tldr\n      cowsay\n    ];\n  };\n}\n</code></pre> <p>Run System Manager again with the same command as above, and you should now have <code>cowsay</code> on your system:</p> <pre><code>~/.config/system-manager$ cowsay Hello!\n ________\n&lt; Hello! &gt;\n --------\n        \\   ^__^\n         \\  (oo)\\_______\n            (__)\\       )\\/\\\n                ||----w |\n                ||     ||\n~/.config/system-manager$\n</code></pre> <p>Remember, this is a declarative approach; System Manager did not reinstall <code>tldr</code>. It looked at the list (<code>tldr</code>, <code>cowsay</code>) and compared it to what is currently installed. It saw that <code>tldr</code> is already installed, so it skipped that one. It saw <code>cowsay</code> is not installed, so it installed it, so that the system matches the configuration file.</p> <p>Now let's remove <code>cowsay</code> from the list of installed software. To do so, simply remove the line (or comment it out):</p> <pre><code>{ pkgs, ... }:\n{\n  config = {\n    nixpkgs.hostPlatform = \"x86_64-linux\";\n\n    environment.systemPackages = with pkgs; [\n      tldr\n    ];\n  };\n}\n</code></pre> <p>Notice this file now looks exactly as it did before adding in <code>cowsay</code>, meaning the system will now look like it did before adding in <code>cowsay</code>. Re-run System Manager and you'll see that <code>cowsay</code> is no longer installed.</p>"},{"location":"tutorials/getting-started/#understanding-the-config-attribute-set","title":"Understanding the config attribute set","text":"<p>In the above example, we added attributes to the <code>systemPackages</code> set, which is a part of the <code>environment</code> attribute set, which in turn is part of the <code>config</code> attribute set.</p> <p>When System Manager runs, with the help of the Nix language, you can have multiple <code>config</code> attribute sets, and System Manager combines them into a single attribute set. This allows you to have different setups in separate files, and simply combine them side by side, only having to add on to this line:</p> <pre><code>        modules = [\n            ./system.nix\n            ./apps.nix\n        ];\n</code></pre> <p>However, you need to be careful. Suppose you have a different set of software you want to install, and you create a flake in another area in the filesystem with that software. It may not work the way you intend.</p> <p>With that second flake, System Manager will gather up any apps you have in the <code>systemPackages</code> attribute, and compare that to what it has already installed earlier. If the packages installed earlier aren't included, it will remove those packages. (That includes the apps you installed with the \"other\" flake.)</p> <p>In other words, you cannot have two separate flakes, one for one set of software, the other for a different set of software, and bounce between those flakes. System Manager will treat the second as requesting to uninstall what it had previously installed.</p> <p>To make the above work, your best bet is to create a single flake and add in individual files that contain the apps you want to install, and always run from that same location.</p>"},{"location":"tutorials/getting-started/#concepts-for-people-new-to-nix","title":"Concepts for people new to Nix","text":""},{"location":"tutorials/getting-started/#understanding-imperative-state-vs-declarative-state","title":"Understanding Imperative State vs Declarative State","text":"<p>Imperative state means you change the system by hand, step by step. You run commands like <code>apt install</code>, edit files under <code>/etc</code> with a text editor, toggle systemd services, and make changes as you think of them. You're telling the computer how to do something:</p> <p>\"Install this package, then edit this file, then restart this service.\"</p> <p>Each action mutates the system in place, and over time, the machine can drift into a state that's hard to reproduce.</p> <p>(To mutate something simply means to change it in place. When a system mutates, its files, settings, or state are altered directly, step by step, rather than being reconstructed from a clean, known description.)</p> <p>Declarative state, on the other hand, means you don't tell the system how to do the steps \u2014 you tell it what you want the final system to look like, and the tool (System Manager, NixOS, Home Manager, etc.) figures out the steps automatically.</p> <p>\"This machine should have these packages, these <code>/etc</code> files, and these services enabled.\" When you activate that configuration, the tool builds the desired end state and applies it in a predictable and repeatable manner.</p> <p>Here's A simple analogy:</p> <p>Imperative is like writing a recipe with every individual action:</p> <p>\"Chop onions. Heat the pan. Add oil...\"</p> <p>Declarative is like saying:</p> <p>\"I want a finished lasagna\"</p> <p>and the system knows how to assemble it reliably every time.</p> <p>Declarative state avoids drift, keeps everything versioned and reproducible, and makes rollbacks simple. Imperative state is flexible and quick, but much harder to track or repeat.</p> <p>Traditional programming languages are typically imperative in nature. </p> <p>If you're familiar with coding, a language like JavaScript is imperative in that you describe everything in a step-by-step fashion. A language like HTML is declarative, in that you simply state what the web page should look like, without specifying how to achieve it.</p>"},{"location":"tutorials/getting-started/#a-note-about-objects-in-your-nix-files","title":"A note about objects in your <code>.nix</code> files","text":"<p>Nix gives you significant flexibility in creating your own objects that you use inside a <code>*.nix</code> file.</p> <p>For example, you could have a <code>config</code> object that looks like this:</p> <pre><code>config = {\n  nixpkgs = {\n    hostPlatform = \"x86_64-linux\";\n  }\n}\n</code></pre> <p>This declares an object stored as <code>config</code> with a single member called <code>nixpkgs</code>; that <code>nixpkgs</code> member then has a single member called <code>hostPlatform</code>, holding the string literal <code>\"x86_64-linux\"</code>.</p> <p>But Nix allows great flexibility in how you declare such objects. Consider the following:</p> <p><pre><code>  config = {\n    nixpkgs.hostPlatform = \"x86_64-linux\";\n  }\n</code></pre> This creates the exact same object. Nix allows you to string together members with a dot between them, and it will construct the inner object accordingly.</p> <p>Note</p> <p>In the examples throughout this and other guides, we use a combination of the above syntax.</p>"},{"location":"tutorials/multi-file-config/","title":"Multi-File Configuration","text":"<p>This tutorial shows you how to organize your System Manager configuration across multiple files for better maintainability.</p>"},{"location":"tutorials/multi-file-config/#prerequisites","title":"Prerequisites","text":"<ul> <li>Completed Getting Started</li> <li>A working System Manager setup</li> </ul>"},{"location":"tutorials/multi-file-config/#what-youll-learn","title":"What You'll Learn","text":"<ul> <li>How to split the configuration into separate modules</li> <li>How Nix merges configuration from multiple files</li> <li>Best practices for organizing larger configurations</li> </ul>"},{"location":"tutorials/multi-file-config/#starting-point","title":"Starting Point","text":"<p>By default, System Manager creates two files:</p> <pre><code>~/.config/system-manager/\n  flake.nix\n  system.nix\n</code></pre> <p>This works for simple setups, but as your configuration grows, you'll want to organize it better.</p>"},{"location":"tutorials/multi-file-config/#step-1-create-a-modules-directory","title":"Step 1: Create a Modules Directory","text":"<p>Create a <code>modules/</code> folder in <code>~/.config/system-manager/</code> to hold your configuration files:</p> <pre><code>mkdir -p ~/.config/system-manager/modules\n</code></pre>"},{"location":"tutorials/multi-file-config/#step-2-create-separate-module-files","title":"Step 2: Create Separate Module Files","text":"<p>Let's create two separate modules, one for packages and one for services.</p> <p>modules/packages.nix</p> <pre><code>{ pkgs, ... }:\n{\n  config = {\n    environment.systemPackages = with pkgs; [\n      bat\n      tree\n      htop\n    ];\n  };\n}\n</code></pre> <p>modules/services.nix</p> <pre><code>{ lib, pkgs, ... }:\n{\n  config = {\n    systemd.services.my-app = {\n      description = \"My Application\";\n      enable = true;\n      wantedBy = [ \"system-manager.target\" ];\n      serviceConfig = {\n        Type = \"simple\";\n        ExecStart = \"${pkgs.hello}/bin/hello\";\n      };\n    };\n  };\n}\n</code></pre>"},{"location":"tutorials/multi-file-config/#step-3-update-your-flake","title":"Step 3: Update Your Flake","text":"<p>Modify your <code>flake.nix</code> to load all modules:</p> <pre><code>{\n  description = \"Standalone System Manager configuration\";\n\n  inputs = {\n    nixpkgs.url = \"github:nixos/nixpkgs/nixos-unstable\";\n    system-manager = {\n      url = \"github:numtide/system-manager\";\n      inputs.nixpkgs.follows = \"nixpkgs\";\n    };\n  };\n\n  outputs = { self, nixpkgs, system-manager, ... }:\n    {\n      systemConfigs.default = system-manager.lib.makeSystemConfig {\n        modules = [\n          { nixpkgs.hostPlatform = \"x86_64-linux\"; }\n          ./modules/packages.nix\n          ./modules/services.nix\n        ];\n      };\n    };\n}\n</code></pre>"},{"location":"tutorials/multi-file-config/#step-4-apply-the-configuration","title":"Step 4: Apply the Configuration","text":"<pre><code>nix run 'github:numtide/system-manager' -- switch --flake . --sudo\n</code></pre>"},{"location":"tutorials/multi-file-config/#how-nix-merges-configurations","title":"How Nix Merges Configurations","text":"<p>When you have multiple modules, Nix automatically merges their <code>config</code> attribute sets. For example, if two files both add to <code>environment.systemPackages</code>, the packages are combined into a single list.</p> <p>This means you can have:</p> <ul> <li><code>modules/dev-tools.nix</code> with development packages,</li> <li><code>modules/monitoring.nix</code> with monitoring tools, and</li> <li><code>modules/web-server.nix</code> with nginx configuration.</li> </ul> <p>They will all work together without conflicts.</p>"},{"location":"tutorials/multi-file-config/#recommended-structure","title":"Recommended Structure","text":"<p>For larger configurations:</p> <pre><code>~/.config/system-manager/\n  flake.nix\n  modules/\n    default.nix       # Common settings\n    packages.nix      # System packages\n    services/         # All user-defined services, one per module file.\n      nginx.nix\n      postgres.nix\n    etc-files.nix     # /etc file management\n</code></pre>"},{"location":"tutorials/multi-file-config/#next-steps","title":"Next Steps","text":"<ul> <li>Learn about folder organization patterns.</li> <li>See Working with Remote Flakes to host your config on GitHub.</li> <li>Read about configuration options in the reference.</li> </ul>"}]}